(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{1575:function(e,t,n){"use strict";var a=n(4),r=n.n(a),i=n(6),o=n.n(i),s=n(7),l=n.n(s),c=n(5),u=n.n(c),d=n(8),p=n.n(d),g=n(0),f=n.n(g),m=n(1),h=n.n(m),b=n(3),v=function(e){return e.color?"background: ".concat(e.color,";"):"background: ".concat(e.enabled?e.theme.success:e.theme.error,";")},y=function(e){return"\n  height: ".concat(e.size,"px;\n  width: ").concat(e.size,"px;\n")},E=Object(b.default)("div",{target:"eljqieg0"})("display:inline-block;position:relative;border-radius:50%;",y,";",v,";"),O=function(e){function t(e){return r()(this,t),l()(this,u()(t).call(this,e))}return p()(t,e),o()(t,[{key:"render",value:function(){return f.a.createElement(E,this.props)}}]),t}(f.a.Component);O.propTypes={enabled:h.a.bool.isRequired,size:h.a.number.isRequired,color:h.a.string},O.defaultProps={enabled:!0,size:14},t.a=O},1589:function(e,t,n){var a=n(384),r=n(812),i=Object.prototype.hasOwnProperty,o=r(function(e,t,n){i.call(e,n)?e[n].push(t):a(e,n,[t])});e.exports=o},1607:function(e,t,n){"use strict";n.d(t,"a",function(){return I});var a=n(12),r=n.n(a),i=n(4),o=n.n(i),s=n(6),l=n.n(s),c=n(7),u=n.n(c),d=n(5),p=n.n(d),g=n(8),f=n.n(g),m=n(1),h=n.n(m),b=n(0),v=n.n(b),y=n(84),E=n.n(y),O=n(2),j=n(30),I=function(e){function t(){var e,n;o()(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(n=u()(this,(e=p()(t)).call.apply(e,[this].concat(i)))).openDialog=function(e){var t=n.props.provider.setupDialog,a=t.url,i=t.width,o=t.height,s=n.computeCenteredWindow(i,o),l=s.left,c=s.top,u=r()({},e);n.props.reinstallId&&(u.reinstall_id=n.props.reinstallId);var d="".concat(a,"?").concat(E.a.stringify(u)),p="scrollbars=yes,width=".concat(i,",height=").concat(o,",top=").concat(c,",left=").concat(l);n.dialog=window.open(d,"sentryAddIntegration",p),n.dialog.focus()},n.didReceiveMessage=function(e){if(e.origin===document.location.origin&&e.source===n.dialog){var t=e.data,a=t.success,r=t.data;n.dialog=null,a?r&&(n.props.onInstall(r),j.default.addSuccess(Object(O.t)("".concat(n.props.provider.name," added")))):j.default.addError(r.error)}},n}return f()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.dialog=null,window.addEventListener("message",this.didReceiveMessage)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("message",this.didReceiveMessage),this.dialog&&this.dialog.close()}},{key:"computeCenteredWindow",value:function(e,t){var n=null!=window.screenLeft?window.screenLeft:screen.left,a=null!=window.screenTop?window.screenTop:screen.top;return{left:(window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-e/2+n,top:(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-t/2+a}}},{key:"render",value:function(){return this.props.children(this.openDialog)}}]),t}(v.a.Component);I.propTypes={children:h.a.func.isRequired,provider:h.a.object.isRequired,onInstall:h.a.func.isRequired,reinstallId:h.a.string}},1673:function(e,t){e.exports=function(e){for(var t=-1,n=null==e?0:e.length,a=0,r=[];++t<n;){var i=e[t];i&&(r[a++]=i)}return r}},1674:function(e,t,n){"use strict";n.d(t,"a",function(){return x});var a=n(11),r=n.n(a),i=n(13),o=n.n(i),s=n(4),l=n.n(s),c=n(6),u=n.n(c),d=n(7),p=n.n(d),g=n(5),f=n.n(g),m=n(8),h=n.n(m),b=n(1),v=n.n(b),y=n(0),E=n.n(y),O=n(2),j=n(1607),I=n(24),w=n(29),x=function(e){function t(){return l()(this,t),p()(this,f()(t).apply(this,arguments))}return h()(t,e),u()(t,[{key:"render",value:function(){var e=this.props,t=e.provider,n=e.buttonText,a=e.onAddIntegration,i=e.reinstall,s=o()(e,["provider","buttonText","onAddIntegration","reinstall"]),l=n||Object(O.t)(i?"Enable":"Add %s",t.metadata.noun);return E.a.createElement(w.default,{disabled:t.canAdd,title:"Integration cannot be added on Sentry. Enable this integration via the ".concat(t.name," instance.")},E.a.createElement(j.a,{provider:t,onInstall:a},function(e){return E.a.createElement(I.default,r()({disabled:!t.canAdd},s,{onClick:function(){return e()}}),l)}))}}]),t}(E.a.Component);x.propTypes={provider:v.a.object.isRequired,onAddIntegration:v.a.func.isRequired,buttonText:v.a.string,reinstall:v.a.bool}},1728:function(e,t,n){"use strict";var a=n(13),r=n.n(a),i=n(4),o=n.n(i),s=n(6),l=n.n(s),c=n(7),u=n.n(c),d=n(5),p=n.n(d),g=n(8),f=n.n(g),m=n(0),h=n.n(m),b=n(16),v=n(10),y=n(95),E=n(24),O=n(110),j=n(11),I=n.n(j),w=n(1),x=n.n(w),R=n(81),k=n(289),q=n(479),C=n(2),T=function(e){function t(){var e,n;o()(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=u()(this,(e=p()(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){var t=e.target.value;t===n.props.confirmInput?n.setState({disableConfirmButton:!1,confirmInput:t}):n.setState({disableConfirmButton:!0,confirmInput:t})},n.state={disableConfirmButton:!0,confirmInput:""},n}return f()(t,e),l()(t,[{key:"render",value:function(){var e=this.props,t=e.confirmInput,n=e.message,a=r()(e,["confirmInput","message"]),i=this.state.disableConfirmButton;return h.a.createElement(O.default,I()({},a,{bypass:!1,disableConfirmButton:i,message:h.a.createElement(h.a.Fragment,null,h.a.createElement(R.default,{type:"error"},n),h.a.createElement(q.default,{p:0,flexibleControlStateSize:!0,inline:!1,label:h.a.createElement("div",null,"Please enter ",h.a.createElement("code",null,t)," to confirm the deletion")},h.a.createElement(k.a,{type:"text",placeholder:t,onChange:this.handleChange,value:this.state.confirmInput})))}))}}]),t}(h.a.PureComponent);T.propTypes={onConfirm:x.a.func.isRequired,confirmText:x.a.string.isRequired,confirmInput:x.a.string.isRequired,cancelText:x.a.string.isRequired,priority:x.a.oneOf(["primary","danger"]).isRequired,message:x.a.node,renderMessage:x.a.func,disabled:x.a.bool,onConfirming:x.a.func,onCancel:x.a.func},T.defaultProps={priority:"primary",cancelText:Object(C.t)("Cancel"),confirmText:Object(C.t)("Confirm")};var A=T,z=n(12),P=n.n(z),B=n(183),D=n(9),S=function(e){function t(){return o()(this,t),u()(this,p()(t).apply(this,arguments))}return f()(t,e),l()(t,[{key:"render",value:function(){var e=this.props,t=e.sentryApp,n=r()(e,["sentryApp"]);return t?h.a.createElement(B.a,I()({},n,{type:"letter_avatar",uploadPath:"avatar",uploadId:"",letterId:t.uuid,tooltip:t.name,title:t.name})):null}}]),t}(h.a.Component);S.propTypes=P()({sentryApp:D.default.SentryApplication.isRequired},B.a.propTypes);var M=S,F=n(29),L=n(25),U=n(3),N=n(15),_=n(198),W=n(1575);n.d(t,"a",function(){return H});var H=function(e){function t(){return o()(this,t),u()(this,p()(t).apply(this,arguments))}return f()(t,e),l()(t,[{key:"renderRemoveApp",value:function(e){var t=this,n=Object(C.t)("Deleting ".concat(e.slug," will also delete any and all of its installations.        This is a permanent action. Do you wish to continue?"));return h.a.createElement(A,{message:n,confirmInput:e.slug,priority:"danger",onConfirm:function(){return t.props.onRemoveApp(e)}},h.a.createElement(E.default,{size:"small",icon:"icon-trash"}))}},{key:"renderUninstall",value:function(e){var t=this,n=Object(C.t)("Are you sure you want to remove the ".concat(e.app.slug," installation ?"));return h.a.createElement(O.default,{message:n,priority:"danger",onConfirm:function(){return t.props.onUninstall(e)}},h.a.createElement(Z,{borderless:!0,icon:"icon-trash","data-test-id":"sentry-app-uninstall"},Object(C.t)("Remove")))}},{key:"render",value:function(){var e=this,t=this.props,n=t.app,a=t.orgId,r=t.installs,i=t.showPublishStatus,o=r&&r.length>0;return h.a.createElement(J,null,h.a.createElement(V,null,h.a.createElement(M,{size:36,sentryApp:n}),h.a.createElement(Y,null,h.a.createElement(K,null,i?h.a.createElement(X,{to:"/settings/".concat(a,"/developer-settings/").concat(n.slug,"/")},n.name):n.name),h.a.createElement(G,null,i?h.a.createElement(ee,{published:"published"===n.status}):h.a.createElement(h.a.Fragment,null,h.a.createElement($,{enabled:o}),h.a.createElement(Q,{onClick:function(){}},Object(C.t)("Learn More"))))),i?h.a.createElement(b.Box,null,"unpublished"===n.status?h.a.createElement(y.a,{access:["org:admin"]},function(t){var a=t.hasAccess;return h.a.createElement(h.a.Fragment,null,!a&&h.a.createElement(F.default,{title:Object(C.t)("Owner permissions are required for this action.")},h.a.createElement(E.default,{disabled:!0,size:"small",icon:"icon-trash"})),a&&e.renderRemoveApp(n))}):h.a.createElement(F.default,{title:Object(C.t)("Published apps cannot be removed.")},h.a.createElement(E.default,{disabled:!0,size:"small",icon:"icon-trash"}))):h.a.createElement(b.Box,null,o?this.renderUninstall(r[0]):h.a.createElement(E.default,{onClick:function(){return e.props.onInstall(n)},size:"small",icon:"icon-circle-add",className:"btn btn-default"},Object(C.t)("Install")))))}}]),t}(h.a.PureComponent);H.propTypes={app:D.default.SentryApplication,orgId:x.a.string.isRequired,installs:x.a.array,onInstall:x.a.func,onUninstall:x.a.func,onRemoveApp:x.a.func,showPublishStatus:x.a.bool},H.defaultProps={showPublishStatus:!1};var J=Object(U.default)(L.f,{target:"eac2pqx0"})("flex-direction:column;padding:5px;"),V=Object(U.default)(b.Flex,{target:"eac2pqx1"})("justify-content:center;padding:10px;"),Y=Object(U.default)(b.Box,{target:"eac2pqx2"})("padding-left:15px;padding-right:15px;flex:1;"),G=Object(U.default)(b.Flex,{target:"eac2pqx3"})("align-items:center;margin-top:6px;font-size:0.8em;"),K=Object(U.default)("div",{target:"eac2pqx4"})("font-weight:bold;"),Q=Object(U.default)(v.Link,{target:"eac2pqx5"})("color:",function(e){return e.theme.gray2},";"),X=Object(U.default)(v.Link,{target:"eac2pqx6"})("color:",function(e){return e.theme.textColor},";"),Z=Object(U.default)(E.default,{target:"eac2pqx7"})("color:",function(e){return e.theme.gray2},";"),$=Object(U.default)(Object(_.withTheme)(function(e){var t=e.enabled,n=r()(e,["enabled"]);return h.a.createElement(b.Flex,{align:"center"},h.a.createElement(W.a,{size:6,color:t?n.theme.success:n.theme.gray2}),h.a.createElement("div",n,t?Object(C.t)("Installed"):Object(C.t)("Not Installed")))}),{target:"eac2pqx8"})("color:",function(e){return e.enabled?e.theme.success:e.theme.gray2},";margin-left:",Object(N.default)(.5),";font-weight:light;&:after{content:'|';color:",function(e){return e.theme.gray1},";margin-left:",Object(N.default)(.75),";font-weight:normal;}margin-right:",Object(N.default)(.75),";"),ee=Object(U.default)(function(e){var t=e.published,n=r()(e,["published"]);return h.a.createElement(b.Flex,{align:"center"},h.a.createElement("div",n,t?Object(C.t)("published"):Object(C.t)("unpublished")))},{target:"eac2pqx9"})("color:",function(e){return e.published?e.theme.success:e.theme.gray2},";font-weight:light;margin-right:",Object(N.default)(.75),";")},2351:function(e,t,n){"use strict";n.r(t);var a=n(26),r=n.n(a),i=n(50),o=n.n(i),s=n(38),l=n.n(s),c=n(12),u=n.n(c),d=n(4),p=n.n(d),g=n(6),f=n.n(g),m=n(7),h=n.n(m),b=n(5),v=n.n(b),y=n(8),E=n.n(y),O=n(440),j=n.n(O),I=n(1589),w=n.n(I),x=n(1673),R=n.n(x),k=n(16),q=n(0),C=n.n(q),T=n(3),A=n(25),z=n(39),P=n(36),B=n(14),D=n(2),S=n(114),M=n(33),F=n(1),L=n.n(F),U=n(1607),N=n(592),_=function(e){function t(){return p()(this,t),h()(this,v()(t).apply(this,arguments))}return E()(t,e),f()(t,[{key:"getEndpoints",value:function(){var e=this.props.orgId;return[["unmigratableRepos","/organizations/".concat(e,"/repos/?status=unmigratable")]]}},{key:"render",value:function(){var e=this;return Object.entries(this.unmigratableReposByOrg).map(function(t){var n=r()(t,2),a=n[0],i=n[1],o="visualstudio"==i[0].provider.id?"vsts":i[0].provider.id,s=e.props.providers.find(function(e){return e.key===o});return s?C.a.createElement(U.a,{key:s.key,provider:s,onInstall:e.props.onInstall},function(e){return C.a.createElement(N.a,{onClick:function(){return e()},href:"#"},Object(D.tct)("Your [orgName] repositories can't send commit data to Sentry. Add a [orgName] [providerName] instance here.",{orgName:a,providerName:s.name}))}):""})}},{key:"unmigratableReposByOrg",get:function(){return w()(this.state.unmigratableRepos,function(e){return e.name.split("/")[0]})}}]),t}(S.default);_.propTypes={orgId:L.a.string.isRequired,providers:L.a.array.isRequired,onInstall:L.a.func.isRequired};var W=n(616),H=n(13),J=n.n(H),V=n(11),Y=n.n(V),G=n(198),K=n(71),Q=n(24),X=n(1575),Z=n(95),$=n(1674),ee=n(81),te=n(110),ne=n(619),ae=n(29),re=["commits","alert-rule"],ie=function(e){function t(){var e,n;p()(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=h()(this,(e=v()(t)).call.apply(e,[this].concat(r)))).reinstallIntegration=function(e){var t=Object.assign({},n.props.integration,{status:"active"});n.props.onReinstallIntegration(t)},n}return E()(t,e),f()(t,[{key:"hasConfiguration",value:function(){var e=this.props,t=e.integration,n=e.provider;return t.configOrganization.length>0||n.features.filter(function(e){return re.includes(e)}).length>0}},{key:"getRemovalBodyAndText",value:function(e){return e&&e.removal_dialog?{body:e.removal_dialog.body,actionText:e.removal_dialog.actionText}:{body:Object(D.t)("Deleting this integration will remove any project associated data. This action cannot be undone. Are you sure you want to delete this integration?"),actionText:Object(D.t)("Delete")}}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,a=t.integration,r=t.provider,i=t.orgId,o="active"===a.status&&a.provider.canDisable?this.disableConfirmProps:this.removeConfirmProps;return C.a.createElement(Z.a,{access:["org:integrations"]},function(t){var s=t.hasAccess;return C.a.createElement(k.Flex,{align:"center",key:a.id,className:n},C.a.createElement(k.Box,{flex:1},C.a.createElement(ne.a,{compact:!0,integration:a})),C.a.createElement(k.Box,null,"disabled"===a.status&&C.a.createElement($.a,{size:"xsmall",priority:"success",provider:r,integration:a,onAddIntegration:e.reinstallIntegration,reinstall:!0}),"active"===a.status&&C.a.createElement(ae.default,{disabled:e.hasConfiguration(),tooltipOptions:{placement:"left"},title:"Integration not configurable"},C.a.createElement(oe,{borderless:!0,icon:"icon-settings",disabled:!e.hasConfiguration()||!s,to:"/settings/".concat(i,"/integrations/").concat(r.key,"/").concat(a.id,"/")},"Configure"))),C.a.createElement(k.Box,null,C.a.createElement(te.default,Y()({priority:"danger",disabled:!s},o),C.a.createElement(oe,{disabled:!s,borderless:!0,icon:"icon-trash"},"Remove"))))})}},{key:"removeConfirmProps",get:function(){var e=this,t=this.props.integration,n=this.getRemovalBodyAndText(t.provider.aspects),a=n.body,r=n.actionText;return{message:C.a.createElement(C.a.Fragment,null,C.a.createElement(ee.default,{type:"error",icon:"icon-circle-exclamation"},"Deleting this integration has consequences!"),a),confirmText:r,onConfirm:function(){return e.props.onRemove(t)}}}},{key:"disableConfirmProps",get:function(){var e=this,t=this.props.integration,n=t.provider.aspects.disable_dialog,a=n.body,r=n.actionText;return{message:C.a.createElement(C.a.Fragment,null,C.a.createElement(ee.default,{type:"error",icon:"icon-circle-exclamation"},"This integration cannot be removed on Sentry"),a),confirmText:r,onConfirm:function(){return e.props.onDisable(t)}}}}]),t}(C.a.Component);ie.propTypes={orgId:L.a.string.isRequired,provider:L.a.object.isRequired,integration:L.a.object.isRequired,onRemove:L.a.func.isRequired,onDisable:L.a.func.isRequired,onReinstallIntegration:L.a.func.isRequired};var oe=Object(T.default)(Q.default,{target:"ejqw4f70"})("color:",function(e){return e.theme.gray2},";"),se=n(61),le=n(199),ce=n(9),ue=n(15),de=n(163),pe=function(e){function t(){var e,n;p()(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=h()(this,(e=v()(t)).call.apply(e,[this].concat(r)))).openModal=function(){var e=n.context.organization,t=n.props.provider,a=n.props.onInstall;Object(K.g)({provider:t,organization:e,onAddIntegration:a})},n}return E()(t,e),f()(t,[{key:"renderIntegrations",value:function(){var e=this;return this.integrations.map(function(t){return C.a.createElement(be,{key:t.id,orgId:e.props.orgId,provider:e.props.provider,integration:t,onRemove:e.props.onRemove,onDisable:e.props.onDisable,onReinstallIntegration:e.props.onReinstall})})}},{key:"render",value:function(){return C.a.createElement(A.f,{p:0,direction:"column"},C.a.createElement(k.Flex,{align:"center",p:2},C.a.createElement(le.a,{size:36,pluginId:this.props.provider.key}),C.a.createElement(k.Box,{px:2,flex:1},C.a.createElement(ge,null,this.props.provider.name),C.a.createElement(fe,null,C.a.createElement(me,{enabled:this.isEnabled}),C.a.createElement(ve,{onClick:this.openModal},"Learn More"))),C.a.createElement(k.Box,null,C.a.createElement(Q.default,Y()({size:"small",onClick:this.openModal},this.buttonProps)))),this.renderIntegrations())}},{key:"integrations",get:function(){return this.props.provider.integrations}},{key:"isEnabled",get:function(){return this.integrations.length>0}},{key:"isEnabledPlugin",get:function(){return this.props.enabledPlugins.includes(this.props.provider.key)}},{key:"isUpgradable",get:function(){return t.upgradableIntegrations.includes(this.props.provider.key)}},{key:"buttonProps",get:function(){var e=!this.isEnabled&&this.isEnabledPlugin&&this.isUpgradable;return{icon:e?"icon-upgrade":"icon-circle-add",children:this.isEnabled?Object(D.t)("Add Another"):e?Object(D.t)("Update"):Object(D.t)("Install")}}}]),t}(C.a.Component);pe.contextTypes={organization:ce.default.Organization},pe.propTypes={provider:L.a.object.isRequired,orgId:L.a.string.isRequired,onInstall:L.a.func.isRequired,onRemove:L.a.func.isRequired,onDisable:L.a.func.isRequired,onReinstall:L.a.func.isRequired,enabledPlugins:L.a.array},pe.defaultProps={enabledPlugins:[]},pe.upgradableIntegrations=["vsts","bitbucket","github","github_enterprise"];var ge=Object(T.default)("div",{target:"e1egfpwi0"})("font-weight:bold;"),fe=Object(T.default)(k.Flex,{target:"e1egfpwi1"})("align-items:center;margin-top:6px;font-size:0.8em;"),me=Object(T.default)(Object(G.withTheme)(function(e){var t=e.enabled,n=J()(e,["enabled"]);return C.a.createElement(k.Flex,{align:"center"},C.a.createElement(X.a,{size:6,color:t?n.theme.success:n.theme.gray2}),C.a.createElement("div",n,t?Object(D.t)("Installed"):Object(D.t)("Not Installed")))}),{target:"e1egfpwi2"})("color:",function(e){return e.enabled?e.theme.success:e.theme.gray2},";margin-left:",Object(ue.default)(.5),";&:after{content:'|';color:",function(e){return e.theme.gray1},";margin-left:",Object(ue.default)(.75),";font-weight:normal;}margin-right:",Object(ue.default)(.75),";"),he=Object(T.default)("div",{target:"e1egfpwi3"})("overflow:hidden;transform-origin:0 auto;animation:",Object(de.e)("59px")," 160ms 500ms ease-in-out forwards,",function(e){return Object(de.g)(e.theme.yellowLightest)}," 1000ms 500ms ease-in-out forwards;"),be=Object(T.default)(function(e){return e.integration.newlyAdded?C.a.createElement(he,null,C.a.createElement(ie,e)):C.a.createElement(ie,e)},{target:"e1egfpwi4"})("padding:",Object(ue.default)(2),";padding-left:0;margin-left:68px;border-top:1px dashed ",function(e){return e.theme.borderLight},";"),ve=Object(T.default)(se.a,{target:"e1egfpwi5"})("color:",function(e){return e.theme.gray2},";"),ye=n(99),Ee=n(1728);var Oe=n(217),je=n(63),Ie=function(e){function t(e){var n;return p()(this,t),(n=h()(this,v()(t).call(this,e))).redirectUser=function(e){var t=e.install,a=e.app,r=n.state.installs,i=n.props.orgId;if(a.redirectUrl){var s={installationId:t.uuid,code:t.code,orgSlug:i},l=Object(Oe.a)(a.redirectUrl,s);window.location.assign(l)}else Object(z.addSuccessMessage)(Object(D.t)("".concat(a.slug," successfully installed."))),n.setState({installs:[t].concat(o()(r))})},n.install=function(e){var t=n.props,a=t.orgId;(function(e,t,n){Object(z.addLoadingMessage)();var a=e.requestPromise("/organizations/".concat(t,"/sentry-app-installations/"),{method:"POST",data:{slug:n.slug}});return a.then(function(){return Object(z.clearIndicators)()},function(){return Object(z.addErrorMessage)(Object(D.t)("Unable to install ".concat(n.name)))}),a})(t.api,a,e).then(function(t){n.redirectUser({install:u()({},t),app:u()({},e)})},function(){})},n.uninstall=function(e){var t=n.props.api,a=o()(n.state.installs),r=n.state.installs.filter(function(t){return e.uuid!=t.uuid});(function(e,t){Object(z.addLoadingMessage)();var n=e.requestPromise("/sentry-app-installations/".concat(t.uuid,"/"),{method:"DELETE"});return n.then(function(){Object(z.addSuccessMessage)(Object(D.t)("".concat(t.app.slug," successfully uninstalled.")))},function(){return Object(z.clearIndicators)()}),n})(t,e).then(function(){return n.setState({installs:r})},function(){n.setState({origInstalls:a}),Object(z.addErrorMessage)(Object(D.t)("Unable to uninstall ".concat(e.app.name)))})},n.openModal=function(e){var t=n.props.orgId;Object(K.j)({app:e,orgId:t,onInstall:function(){return n.install(e)}})},n.state={installs:n.props.installs,applications:n.props.applications},n}return E()(t,e),f()(t,[{key:"render",value:function(){var e=this,t=this.props.orgId,n=0===this.state.applications.length;return C.a.createElement(C.a.Fragment,null,!n&&this.state.applications.map(function(n){return C.a.createElement(Ee.a,{key:n.uuid,app:n,orgId:t,onInstall:function(){return e.openModal(n)},onUninstall:e.uninstall,installs:e.installsByApp[n.slug]})}))}},{key:"installsByApp",get:function(){return w()(this.state.installs,function(e){return e.app.slug})}}]),t}(C.a.Component);Ie.propTypes={api:L.a.object,orgId:L.a.string.isRequired,installs:L.a.array.isRequired,applications:L.a.array.isRequired};var we=Object(je.default)(Ie),xe=n(56);n.d(t,"OrganizationIntegrations",function(){return Re});var Re=function(e){function t(){var e,n;p()(this,t);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(n=h()(this,(e=v()(t)).call.apply(e,[this].concat(i)))).shouldReload=!0,n.reloadOnVisible=!0,n.shouldReloadOnVisible=!0,n.onInstall=function(e){var t=j()(n.state.integrations,function(e){return e.id});t.hasOwnProperty(e.id)||(e.newlyAdded=!0);var a=Object(B.sortArray)(Object.values(u()({},t,l()({},e.id,e))),function(e){return e.name});n.setState({integrations:a})},n.onRemove=function(e){var t=n.props.params.orgId,a=o()(n.state.integrations),r=n.state.integrations.filter(function(t){return t.id!==e.id});n.setState({integrations:r});var i={method:"DELETE",error:function(){n.setState({integrations:a}),Object(z.addErrorMessage)(Object(D.t)("Failed to remove Integration"))}};n.api.request("/organizations/".concat(t,"/integrations/").concat(e.id,"/"),i)},n.onDisable=function(e){var t,n=e.domainName.split("/"),a=r()(n,2),i=a[0],o=a[1];t="User"===e.accountType?"https://".concat(i,"/settings/installations/"):"https://".concat(i,"/organizations/").concat(o,"/settings/installations/"),window.open(t,"_blank")},n}return E()(t,e),f()(t,[{key:"componentDidMount",value:function(){Object(P.b)("integrations.index_viewed",{org_id:parseInt(this.props.organization.id,10)})}},{key:"getEndpoints",value:function(){var e=this.props.params.orgId,t=[["config","/organizations/".concat(e,"/config/integrations/")],["integrations","/organizations/".concat(e,"/integrations/")],["plugins","/organizations/".concat(e,"/plugins/"),{query:{plugins:["vsts","github","bitbucket"]}}]];return this.props.organization.features.includes("sentry-apps")?[].concat(t,[["applications","/organizations/".concat(e,"/sentry-apps/")],["appInstalls","/organizations/".concat(e,"/sentry-app-installations/")]]):t}},{key:"renderBody",value:function(){var e=this,t=this.state,n=t.reloading,a=t.applications,r=t.appInstalls,i=this.providers.sort(function(e,t){return t.isInstalled-e.isInstalled}).map(function(t){return C.a.createElement(pe,{key:t.key,provider:t,orgId:e.props.params.orgId,integrations:t.integrations,onInstall:e.onInstall,onRemove:e.onRemove,onDisable:e.onDisable,onReinstall:e.onInstall,enabledPlugins:e.enabledPlugins})});return C.a.createElement(C.a.Fragment,null,!this.props.hideHeader&&C.a.createElement(ye.default,{title:Object(D.t)("Integrations")}),C.a.createElement(W.a,{access:["org:integrations"]}),C.a.createElement(_,{orgId:this.props.params.orgId,providers:this.providers,onInstall:this.onInstall}),C.a.createElement(A.a,null,C.a.createElement(A.e,{disablePadding:!0},C.a.createElement(k.Box,{px:2,flex:"1"},Object(D.t)("Integrations")),n&&C.a.createElement(ke,{mini:!0})),C.a.createElement(A.c,null,i,a&&C.a.createElement(we,{orgId:this.props.params.orgId,installs:r,applications:a}))))}},{key:"enabledPlugins",get:function(){return R()(this.state.plugins.map(function(e){return e.enabled&&e.slug}))}},{key:"unmigratableReposByOrg",get:function(){return w()(this.state.unmigratableRepos,function(e){return e.name.split("/")[0]})}},{key:"providers",get:function(){var e=this;return this.state.config.providers.map(function(t){var n=e.state.integrations.filter(function(e){return e.provider.key==t.key}),a=n.length>0;return u()({},t,{integrations:n,isInstalled:a})})}}]),t}(S.default),ke=Object(T.default)(M.default,{target:"ey354780"})("position:absolute;right:7px;top:50%;transform:translateY(-16px);");t.default=Object(xe.a)(Re)}}]);
//# sourceMappingURL=OrganizationIntegrations.js.map