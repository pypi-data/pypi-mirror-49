(window.webpackJsonp=window.webpackJsonp||[]).push([[120],{1671:function(e,t,a){"use strict";var n=a(3),r=a(0),c=a.n(r),o=a(17),s=a.n(o),i=a(37),l=a(424),d=a(61),u=a(613),m=a(9),h=a(15),p=s()({displayName:"ProjectItem",propTypes:{project:m.default.Project,organization:m.default.Organization},mixins:[i.default],getInitialState:function(){return{isBookmarked:this.props.project.isBookmarked}},handleToggleBookmark:function(e){this.setState({isBookmarked:e})},render:function(){var e=this.props,t=e.project,a=e.organization,n=new Set(a.features).has("sentry10");return c.a.createElement(f,{key:t.id},c.a.createElement(g,{organization:a,project:t,isBookmarked:this.state.isBookmarked,onToggle:this.handleToggleBookmark}),c.a.createElement(d.a,{to:n?"/settings/".concat(a.slug,"/projects/").concat(t.slug,"/"):"/".concat(a.slug,"/").concat(t.slug,"/")},c.a.createElement(u.a,{project:t})))}}),f=Object(n.default)("div",{target:"enngb6z0"})("display:flex;align-items:center;"),g=Object(n.default)(l.a,{target:"enngb6z1"})("margin-right:",Object(h.default)(1),";margin-top:-",Object(h.default)(.25),";");t.a=p},2308:function(e,t,a){"use strict";a.r(t);var n=a(11),r=a.n(n),c=a(26),o=a.n(c),s=a(0),i=a.n(s),l=a(17),d=a.n(l),u=a(3),m=a(29),h=a(37),p=a(39),f=a(15),g=a(24),j=a(161),b=a(312),k=a(106),P=a(33),v=a(53),O=a(66),E=a(1671),y=a(25),S=a(23),z=a(107),I=a(14),T=a(2),q=d()({displayName:"TeamProjects",mixins:[h.default,O.a],getInitialState:function(){return{error:!1,loading:!0,pageLinks:null,unlinkedProjects:[],linkedProjects:[]}},componentDidMount:function(){this.fetchAll()},componentDidUpdate:function(e){e.params.orgId===this.props.params.orgId&&e.params.teamId===this.props.params.teamId||this.fetchAll(),e.location!==this.props.location&&this.fetchTeamProjects()},fetchAll:function(){this.fetchTeamProjects(),this.fetchUnlinkedProjects()},fetchTeamProjects:function(){var e=this,t=this.props,a=t.location,n=t.params,r=n.orgId,c=n.teamId;this.setState({loading:!0}),this.api.requestPromise("/organizations/".concat(r,"/projects/"),{query:{query:"team:".concat(c),cursor:a.query.cursor||""},includeAllArgs:!0}).then(function(t){var a=o()(t,3),n=a[0],r=(a[1],a[2]);e.setState({loading:!1,error:!1,linkedProjects:n,pageLinks:r.getResponseHeader("Link")})}).catch(function(){e.setState({loading:!1,error:!0})})},fetchUnlinkedProjects:function(e){var t=this,a=this.props.params,n=a.orgId,r=a.teamId;this.api.requestPromise("/organizations/".concat(n,"/projects/"),{query:{query:e?"!team:".concat(r," ").concat(e):"!team:".concat(r)}}).then(function(e){t.setState({unlinkedProjects:e})})},handleLinkProject:function(e,t){var a=this,n=this.props.params,r=n.orgId,c=n.teamId;this.api.request("/projects/".concat(r,"/").concat(e.slug,"/teams/").concat(c,"/"),{method:"add"===t?"POST":"DELETE",success:function(){a.fetchAll(),Object(p.addSuccessMessage)("add"===t?Object(T.t)("Successfully added project to team."):Object(T.t)("Successfully removed project from team"))},error:function(e){Object(p.addErrorMessage)(Object(T.t)("Wasn't able to change project association."))}})},handleProjectSelected:function(e){var t=this.state.unlinkedProjects.find(function(t){return t.id===e.value});this.handleLinkProject(t,"add")},handleQueryUpdate:function(e){this.fetchUnlinkedProjects(e.target.value)},projectPanelContents:function(e){var t=this,a=this.getAccess().has("org:write");return e.length?Object(I.sortProjects)(e).map(function(e,n){return i.a.createElement(A,{key:e.id},i.a.createElement(E.a,{project:e,organization:t.context.organization}),i.a.createElement(m.default,{disabled:a,title:Object(T.t)("You do not have enough permission to change project association.")},i.a.createElement(g.default,{size:"small",disabled:!a,onClick:function(){t.handleLinkProject(e,"remove")}},i.a.createElement(w,null)," ",Object(T.t)("Remove"))))}):i.a.createElement(k.default,{size:"large",icon:"icon-circle-exclamation"},Object(T.t)("This team doesn't have access to any projects."))},render:function(){var e=this,t=this.state,a=t.linkedProjects,n=t.unlinkedProjects,c=t.error,o=t.loading;if(c)return i.a.createElement(v.default,{onRetry:function(){return e.fetchAll()}});if(o)return i.a.createElement(P.default,null);var s=this.getAccess(),l=n.map(function(e){return{value:e.id,searchKey:e.slug,label:i.a.createElement(x,null,e.slug)}});return i.a.createElement(i.a.Fragment,null,i.a.createElement(y.a,null,i.a.createElement(y.e,{hasButtons:!0},i.a.createElement("div",null,Object(T.t)("Projects")),i.a.createElement("div",{style:{textTransform:"none"}},s.has("org:write")?i.a.createElement(j.a,{items:l,onChange:this.handleQueryUpdate,onSelect:this.handleProjectSelected,emptyMessage:Object(T.t)("No projects")},function(e){var t=e.isOpen;e.selectedItem;return i.a.createElement(b.a,{isOpen:t,size:"xsmall"},Object(T.t)("Add Project"))}):i.a.createElement(b.a,{disabled:!0,title:Object(T.t)("You do not have enough permission to associate a project."),size:"xsmall"},Object(T.t)("Add Project")))),i.a.createElement(y.c,null,this.projectPanelContents(a))),i.a.createElement(z.default,r()({pageLinks:this.state.pageLinks},this.props)))}}),w=Object(u.default)(function(e){return i.a.createElement(S.default,r()({},e,{src:"icon-circle-subtract"}),Object(T.t)("Remove"))},{target:"eqsa6vb0"})("min-height:1.25em;min-width:1.25em;margin-right:",Object(f.default)(1),";"),A=Object(u.default)(y.f,{target:"eqsa6vb1"})("display:flex;align-items:center;justify-content:space-between;padding:",Object(f.default)(2),";"),x=Object(u.default)("div",{target:"eqsa6vb2"})("padding:",Object(f.default)(.25)," 0;");t.default=q}}]);
//# sourceMappingURL=TeamProjects.js.map