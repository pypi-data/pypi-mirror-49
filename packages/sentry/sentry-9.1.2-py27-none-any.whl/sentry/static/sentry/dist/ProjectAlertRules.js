(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{2290:function(e,t,a){"use strict";a.r(t);var n,r,l=a(12),i=a.n(l),s=a(4),c=a.n(s),o=a(6),u=a.n(o),d=a(7),m=a.n(d),p=a(5),f=a.n(p),b=a(8),h=a.n(b),E=a(16),g=a(10),j=a(1),y=a.n(j),O=a(0),v=a.n(O),w=a(3),R=a(25),x=a(39),k=a(85),I=a(2),L=a(153),q=a(24),D=a(110),z=a(215),A=a(145),N=a(129),T=a(79),S=a(146),B=a(226),M=a(9),Y=a(99),C=a(29),F=a(187),G=a(63),J=Object(w.default)(g.Link,{target:"e1abl5wd0"})("color:",function(e){return e.theme.gray3},";"),_=Object(w.default)("div",{target:"e1abl5wd1"})("display:flex;"),P=Object(w.default)("div",{target:"e1abl5wd2"})("flex:1;padding:",function(e){return 2*e.theme.grid},"px;height:100%;"),U=Object(w.default)("div",{target:"e1abl5wd3"})("display:flex;flex-direction:column;justify-content:space-between;height:100%;"),W=Object(G.default)((r=n=function(e){function t(e){var a;return c()(this,t),(a=m()(this,f()(t).call(this,e))).onDelete=function(){if(!a.state.loading){var e=Object(x.addLoadingMessage)(),t=a.props,n=t.api,r=t.orgId,l=t.projectId,i=t.data;n.request("/projects/".concat(r,"/").concat(l,"/rules/").concat(i.id,"/"),{method:"DELETE",success:function(){a.props.onDelete(),Object(x.removeIndicator)(e),Object(x.addSuccessMessage)(Object(I.tct)('Successfully deleted "[alert]"',{alert:i.name}))},error:function(){a.setState({error:!0,loading:!1}),Object(x.removeIndicator)(e),Object(x.addErrorMessage)(Object(I.t)("Unable to save changes. Please try again."))}})}},a.state={loading:!1,error:!1},a}return h()(t,e),u()(t,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.canEdit,n=Object(F.a)("".concat(t.id,"/"),this.props),r=N.a.getByName(t.environment),l=r?r.displayName:Object(I.t)("All Environments");return v.a.createElement(R.a,null,v.a.createElement(R.e,{align:"center",justify:"space-between",hasButtons:!0},v.a.createElement(J,{to:n},t.name," - ",l),v.a.createElement(E.Flex,null,v.a.createElement(C.default,{disabled:a,title:Object(I.t)("You do not have permission to edit alert rules.")},v.a.createElement(q.default,{"data-test-id":"edit-rule",style:{marginRight:5},disabled:!a,size:"xsmall",to:n},Object(I.t)("Edit Rule"))),v.a.createElement(C.default,{disabled:a,title:Object(I.t)("You do not have permission to edit alert rules.")},v.a.createElement(D.default,{message:Object(I.t)("Are you sure you want to remove this rule?"),onConfirm:this.onDelete,disabled:!a},v.a.createElement(q.default,{size:"xsmall",icon:"icon-trash"}))))),v.a.createElement(R.c,null,v.a.createElement(_,null,v.a.createElement(P,null,0!==t.conditions.length&&v.a.createElement(U,null,v.a.createElement("h6",null,"When ",v.a.createElement("strong",null,t.actionMatch)," of these conditions are met:"),Object(k.conditionalGuideAnchor)(this.props.firstRule,"alert_conditions","text",v.a.createElement("table",{className:"conditions-list table"},v.a.createElement("tbody",null,t.conditions.map(function(e,t){return v.a.createElement("tr",{key:t},v.a.createElement("td",null,e.name))})))))),v.a.createElement(P,null,0!==t.actions.length&&v.a.createElement(U,null,v.a.createElement("h6",null,"Take these actions at most"," ",v.a.createElement("strong",null,"once every ",v.a.createElement(z.a,{seconds:60*t.frequency}))," ","for an issue:"),Object(k.conditionalGuideAnchor)(this.props.firstRule,"alert_actions","text",v.a.createElement("table",{className:"actions-list table"},v.a.createElement("tbody",null,t.actions.map(function(e,t){return v.a.createElement("tr",{key:t},v.a.createElement("td",null,e.name))})))))))))}}]),t}(v.a.Component),n.propTypes={api:y.a.object.isRequired,orgId:y.a.string.isRequired,projectId:y.a.string.isRequired,data:y.a.object.isRequired,onDelete:y.a.func.isRequired,firstRule:y.a.bool,canEdit:y.a.bool},r)),H=function(e){function t(){var e,a;c()(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=m()(this,(e=f()(t)).call.apply(e,[this].concat(r)))).handleDeleteRule=function(e){a.setState({ruleList:a.state.ruleList.filter(function(t){return t.id!==e.id})})},a}return h()(t,e),u()(t,[{key:"getEndpoints",value:function(){var e=this.props.params,t=e.orgId,a=e.projectId;return[["ruleList","/projects/".concat(t,"/").concat(a,"/rules/")]]}},{key:"renderEmpty",value:function(){return v.a.createElement(R.a,null,v.a.createElement(A.a,null,v.a.createElement("p",null,Object(I.t)("There are no alerts configured for this project."))))}},{key:"renderResults",value:function(){var e=this,t=this.props.params,a=t.orgId,n=t.projectId,r=this.context.organization.access.includes("project:write");return v.a.createElement("div",{className:"rules-list"},this.state.ruleList.map(function(t){return v.a.createElement(W,{key:t.id,data:t,orgId:a,projectId:n,params:e.props.params,routes:e.props.routes,onDelete:e.handleDeleteRule.bind(e,t),firstRule:0===e.state.ruleList.indexOf(t),canEdit:r})}))}},{key:"renderBody",value:function(){var e=this.state.ruleList,t=this.context.organization.access.includes("project:write");return v.a.createElement(v.a.Fragment,null,v.a.createElement(Y.default,{title:Object(I.t)("Alerts"),action:v.a.createElement(C.default,{disabled:t,title:Object(I.t)("You do not have permission to edit alert rules.")},v.a.createElement(q.default,{disabled:!t,to:Object(F.a)("new/",this.props),priority:"primary",size:"small",icon:"icon-circle-add"},Object(I.t)("New Alert Rule"))),tabs:v.a.createElement(S.default,{underlined:!0},v.a.createElement(T.default,{to:Object(F.a)("alerts",i()({},this.props,{stepBack:-4}))},Object(I.t)("Settings")),v.a.createElement(T.default,{to:Object(F.a)("",this.props)},Object(I.t)("Rules")))}),v.a.createElement(B.a,null),!!e.length&&this.renderResults(),!e.length&&this.renderEmpty())}}]),t}(L.default);H.propTypes={routes:y.a.array.isRequired},H.contextTypes={organization:M.default.Organization},t.default=H}}]);
//# sourceMappingURL=ProjectAlertRules.js.map