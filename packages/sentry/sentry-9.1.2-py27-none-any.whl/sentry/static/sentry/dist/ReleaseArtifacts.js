(window.webpackJsonp=window.webpackJsonp||[]).push([[110],{2336:function(e,t,a){"use strict";a.r(t),a.d(t,"ReleaseArtifacts",function(){return T});var n=a(4),r=a.n(n),i=a(6),l=a.n(i),s=a(7),c=a.n(s),o=a(5),u=a.n(o),d=a(8),f=a.n(d),m=a(177),p=a.n(m),E=a(16),b=a(1),h=a.n(b),g=a(0),v=a.n(g),j=a(25),y=a(93),k=a(2),w=a(145),O=a(244),x=a(30),L=a(227),F=a(53),N=a(33),D=a(107),R=a(9),z=a(29),S=a(63),q=a(56),T=function(e){function t(){var e;return r()(this,t),(e=c()(this,u()(t).call(this))).fetchData=function(){e.setState({loading:!0,error:!1}),e.props.api.request(e.getFilesEndpoint(),{method:"GET",data:p()(e.props.location.query,Object.values(y.d)),success:function(t,a,n){e.setState({error:!1,loading:!1,fileList:t,pageLinks:n.getResponseHeader("Link")})},error:function(){e.setState({error:!0,loading:!1})}})},e.state={loading:!0,error:!1,fileList:[],pageLinks:null},e}return f()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"getFilesEndpoint",value:function(){var e=this.props.params,t=e.orgId,a=e.projectId,n=e.version,r=encodeURIComponent(n);return a?"/projects/".concat(t,"/").concat(a,"/releases/").concat(r,"/files/"):"/organizations/".concat(t,"/releases/").concat(r,"/files/")}},{key:"handleRemove",value:function(e){var t=this,a=x.default.add(Object(k.t)("Removing artifact.."));this.props.api.request(this.getFilesEndpoint()+"".concat(e,"/"),{method:"DELETE",success:function(){var a=t.state.fileList.filter(function(t){return t.id!==e});t.setState({fileList:a}),x.default.add(Object(k.t)("Artifact removed."),"success",{duration:4e3})},error:function(){x.default.add(Object(k.t)("Unable to remove artifact. Please try again."),"error",{duration:4e3})},complete:function(){x.default.remove(a)}})}},{key:"render",value:function(){var e=this;if(this.state.loading)return v.a.createElement(N.default,null);if(this.state.error)return v.a.createElement(F.default,{onRetry:this.fetchData});if(0===this.state.fileList.length)return v.a.createElement(j.a,null,v.a.createElement(w.a,null,v.a.createElement("p",null,Object(k.t)("There are no artifacts uploaded for this release."))));var t=new Set(this.props.organization.access);return v.a.createElement("div",null,v.a.createElement(j.a,null,v.a.createElement(j.e,null,v.a.createElement(E.Flex,{flex:"7",pr:2},Object(k.t)("Name")),v.a.createElement(E.Flex,{flex:"2"},Object(k.t)("Distribution")),v.a.createElement(E.Flex,{flex:"3"},Object(k.t)("Size"))),v.a.createElement(j.c,null,this.state.fileList.map(function(a){return v.a.createElement(j.f,{key:a.id},v.a.createElement(E.Flex,{flex:"7",pr:2,style:{wordWrap:"break-word",wordBreak:"break-all"}},v.a.createElement("strong",null,a.name||"(empty)")),v.a.createElement(E.Flex,{flex:"2"},a.dist||v.a.createElement("span",{className:"text-light"},Object(k.t)("None"))),v.a.createElement(E.Flex,{flex:"3",justify:"space-between"},v.a.createElement(O.a,{bytes:a.size}),v.a.createElement(E.Flex,{align:"center"},t.has("project:write")?v.a.createElement("a",{href:e.props.api.baseUrl+e.getFilesEndpoint()+"".concat(a.id,"/?download=1"),className:"btn btn-sm btn-default"},v.a.createElement("span",{className:"icon icon-open"})):v.a.createElement(z.default,{title:Object(k.t)("You do not have the required permission to download this artifact.")},v.a.createElement("div",{className:"btn btn-sm btn-default disabled"},v.a.createElement("span",{className:"icon icon-open"}))),v.a.createElement("div",{style:{marginLeft:5}},v.a.createElement(L.a,{className:"btn btn-sm btn-default",title:Object(k.t)("Delete artifact"),message:Object(k.t)("Are you sure you want to remove this artifact?"),onConfirm:e.handleRemove.bind(e,a.id)},v.a.createElement("span",{className:"icon icon-trash"}))))))}))),v.a.createElement(D.default,{pageLinks:this.state.pageLinks}))}}]),t}(v.a.Component);T.propTypes={organization:R.default.Organization,api:h.a.object},t.default=Object(q.a)(Object(S.default)(T))}}]);
//# sourceMappingURL=ReleaseArtifacts.js.map