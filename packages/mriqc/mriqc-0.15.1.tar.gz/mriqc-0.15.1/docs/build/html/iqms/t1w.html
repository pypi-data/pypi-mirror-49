

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>IQMs for structural images &mdash; mriqc 0.9 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="author" title="About these documents"
              href="../about.html"/>
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="mriqc 0.9 documentation" href="../index.html"/>
        <link rel="up" title="Image Quality Metrics (IQMs)" href="../measures.html"/>
        <link rel="next" title="IQMs for functional images" href="bold.html"/>
        <link rel="prev" title="Image Quality Metrics (IQMs)" href="../measures.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> mriqc
          

          
          </a>

          
            
            
              <div class="version">
                0.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running.html">Running mriqc</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../measures.html">Image Quality Metrics (IQMs)</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">IQMs for structural images</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#measures-based-on-noise-measurements">Measures based on noise measurements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#measures-based-on-information-theory">Measures based on information theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#measures-targeting-specific-artifacts">Measures targeting specific artifacts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-measures">Other measures</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mriqc-qc-anatomical-module">mriqc.qc.anatomical module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="bold.html">IQMs for functional images</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../docker.html">Run mriqc with docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reports.html">Visual reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflows.html">The MRIQC workflows</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">mriqc</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../measures.html">Image Quality Metrics (IQMs)</a> &raquo;</li>
        
      <li>IQMs for structural images</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/iqms/t1w.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-mriqc.qc.anatomical">
<span id="iqms-for-structural-images"></span><span id="iqms-t1w"></span><h1>IQMs for structural images<a class="headerlink" href="#module-mriqc.qc.anatomical" title="Permalink to this headline">¶</a></h1>
<div class="section" id="measures-based-on-noise-measurements">
<h2>Measures based on noise measurements<a class="headerlink" href="#measures-based-on-noise-measurements" title="Permalink to this headline">¶</a></h2>
<ul class="simple" id="iqms-struc-cjv">
<li><a class="reference internal" href="#mriqc.qc.anatomical.cjv" title="mriqc.qc.anatomical.cjv"><code class="xref py py-func docutils literal"><span class="pre">cjv()</span></code></a> &#8211; <strong>coefficient of joint variation</strong>
(<abbr title="coefficient of joint variation">CJV</abbr>):
The <code class="docutils literal"><span class="pre">cjv</span></code> of GM and WM was proposed as objective function by <a class="reference internal" href="#ganzetti2016" id="id1">[Ganzetti2016]</a> for
the optimization of <abbr title="intensity non-uniformity">INU</abbr> correction algorithms.
Higher values are related to the presence of heavy head motion and large
<abbr title="intensity non-uniformity">INU</abbr> artifacts. Lower values are better.</li>
</ul>
<ul class="simple" id="iqms-struc-cnr">
<li><a class="reference internal" href="#mriqc.qc.anatomical.cnr" title="mriqc.qc.anatomical.cnr"><code class="xref py py-func docutils literal"><span class="pre">cnr()</span></code></a> &#8211; <strong>contrast-to-noise ratio</strong>
(<abbr title="contrast-to-noise Ratio">CNR</abbr>): The <code class="docutils literal"><span class="pre">cnr</span></code> <a class="reference internal" href="#magnota2006" id="id2">[Magnota2006]</a>,
is an extension of the <abbr title="signal-to-noise Ratio">SNR</abbr> calculation
to evaluate how separated the tissue distributions of GM and WM are.
Higher values indicate better quality.</li>
</ul>
<ul class="simple" id="iqms-struc-snr">
<li><a class="reference internal" href="#mriqc.qc.anatomical.snr" title="mriqc.qc.anatomical.snr"><code class="xref py py-func docutils literal"><span class="pre">snr()</span></code></a> &#8211; <strong>signal-to-noise ratio</strong>
(<abbr title="signal-to-noise Ratio">SNR</abbr>): calculated within the
tissue mask.</li>
</ul>
<ul class="simple" id="iqms-struc-snr-dietrich">
<li><a class="reference internal" href="#mriqc.qc.anatomical.snr_dietrich" title="mriqc.qc.anatomical.snr_dietrich"><code class="xref py py-func docutils literal"><span class="pre">snr_dietrich()</span></code></a>: <strong>Dietrich&#8217;s SNR</strong>
(<abbr title="signal-to-noise Ratio, Dietrich 2007">SNRd</abbr>) as proposed
by <a class="reference internal" href="#dietrich2007" id="id3">[Dietrich2007]</a>, using the air background as reference.</li>
</ul>
<ul class="simple" id="iqms-struc-qi2">
<li><a class="reference internal" href="#mriqc.qc.anatomical.art_qi2" title="mriqc.qc.anatomical.art_qi2"><code class="xref py py-func docutils literal"><span class="pre">art_qi2()</span></code></a>: <strong>Mortamet&#8217;s quality index 2</strong>
(<abbr title="quality index 2">QI2</abbr>) is a calculation of the goodness-of-fit
of a <span class="math">\(\chi^2\)</span> distribution on the air mask,
once the artifactual intensities detected for computing
the <abbr title="quality index 1">QI1</abbr> index have been removed <a class="reference internal" href="#mortamet2009" id="id4">[Mortamet2009]</a>.</li>
</ul>
</div>
<div class="section" id="measures-based-on-information-theory">
<h2>Measures based on information theory<a class="headerlink" href="#measures-based-on-information-theory" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first"><a class="reference internal" href="#mriqc.qc.anatomical.efc" title="mriqc.qc.anatomical.efc"><code class="xref py py-func docutils literal"><span class="pre">efc()</span></code></a>:
The <abbr title="Entropy Focus Criterion">EFC</abbr>
<a class="reference internal" href="bold.html#atkinson1997" id="id5">[Atkinson1997]</a> uses the Shannon entropy of voxel intensities as
an indication of ghosting and blurring induced by head motion.
Lower values are better.</p>
<p>The original equation is normalized by the maximum entropy, so that the
<abbr title="Entropy Focus Criterion">EFC</abbr> can be compared across images with
different dimensions.</p>
</li>
<li><p class="first"><a class="reference internal" href="#mriqc.qc.anatomical.fber" title="mriqc.qc.anatomical.fber"><code class="xref py py-func docutils literal"><span class="pre">fber()</span></code></a>:
The <abbr title="Foreground-Background Energy Ratio">FBER</abbr> <a class="reference internal" href="#shehzad2015" id="id6">[Shehzad2015]</a>,
defined as the mean energy of image values within the head relative to outside the head <a class="reference internal" href="../measures.html#qap-measures" id="id7">[QAP-measures]</a>.
Higher values are better.</p>
</li>
</ul>
</div>
<div class="section" id="measures-targeting-specific-artifacts">
<h2>Measures targeting specific artifacts<a class="headerlink" href="#measures-targeting-specific-artifacts" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first"><strong>inu_*</strong> (<em>nipype interface to N4ITK</em>): summary statistics (max, min and median)
of the <abbr title="intensity non-uniformity">INU</abbr> field as extracted by the N4ITK algorithm
<a class="reference internal" href="#tustison2010" id="id8">[Tustison2010]</a>. Values closer to 1.0 are better.</p>
</li>
<li><p class="first"><a class="reference internal" href="#mriqc.qc.anatomical.art_qi1" title="mriqc.qc.anatomical.art_qi1"><code class="xref py py-func docutils literal"><span class="pre">art_qi1()</span></code></a>:
Detect artifacts in the image using the method described in <a class="reference internal" href="#mortamet2009" id="id9">[Mortamet2009]</a>.
The <abbr title="quality index 1">QI1</abbr> is the proportion of voxels with intensity corrupted by artifacts
normalized by the number of voxels in the background. Lower values are better.</p>
<div class="figure" id="id18">
<img alt="../_images/mortamet-mrm2009.png" src="../_images/mortamet-mrm2009.png" />
<p class="caption"><span class="caption-text">The workflow to compute the artifact detection from <a class="reference internal" href="#mortamet2009" id="id10">[Mortamet2009]</a>.</span></p>
</div>
</li>
<li><p class="first"><a class="reference internal" href="#mriqc.qc.anatomical.wm2max" title="mriqc.qc.anatomical.wm2max"><code class="xref py py-func docutils literal"><span class="pre">wm2max()</span></code></a>:
The white-matter to maximum intensity ratio is the median intensity
within the WM mask over the 95% percentile of the full intensity
distribution, that captures the existence of long tails due to
hyper-intensity of the carotid vessels and fat. Values
should be around the interval [0.6, 0.8]</p>
</li>
</ul>
</div>
<div class="section" id="other-measures">
<h2>Other measures<a class="headerlink" href="#other-measures" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first"><strong>fwhm</strong> (<em>nipype interface to AFNI</em>): The <abbr title="full-width half maximum">FWHM</abbr> of
the spatial distribution of the image intensity values in units of voxels <a class="reference internal" href="#forman1995" id="id11">[Forman1995]</a>.
Lower values are better. Uses the gaussian width estimator filter implemented in
AFNI&#8217;s <code class="docutils literal"><span class="pre">3dFWHMx</span></code>:</p>
<div class="math">
\[\text{FWHM} = \sqrt{-{\left[4 \ln{(1-\frac{\sigma^2_{X^m_{i+1,j}-X^m_{i,j}}}{2\sigma^2_{X^m_{i,j}}}})\right]}^{-1}}\]</div>
</li>
<li><p class="first"><code class="xref py py-func docutils literal"><span class="pre">volume_fractions()</span></code> (<strong>icvs_*</strong>):
the
<abbr title="intracranial volume">ICV</abbr> fractions of <abbr title="cerebrospinal fluid">CSF</abbr>,
<abbr title="gray-matter">GM</abbr> and <abbr title="white-matter">WM</abbr>. They should move within
a normative range.</p>
</li>
<li><p class="first"><a class="reference internal" href="#mriqc.qc.anatomical.rpve" title="mriqc.qc.anatomical.rpve"><code class="xref py py-func docutils literal"><span class="pre">rpve()</span></code></a> (<strong>rpve_*</strong>): the
<abbr title="residual partial voluming error">rPVe</abbr> of <abbr title="cerebrospinal fluid">CSF</abbr>,
<abbr title="gray-matter">GM</abbr> and <abbr title="white-matter">WM</abbr>. Lower values are better.</p>
</li>
<li><p class="first"><a class="reference internal" href="#mriqc.qc.anatomical.summary_stats" title="mriqc.qc.anatomical.summary_stats"><code class="xref py py-func docutils literal"><span class="pre">summary_stats()</span></code></a> (<strong>summary_*_*</strong>):
Mean, standard deviation, 5% percentile and 95% percentile of the distribution
of background, <abbr title="cerebrospinal fluid">CSF</abbr>, <abbr title="gray-matter">GM</abbr> and
<abbr title="white-matter">WM</abbr>.</p>
</li>
<li><p class="first"><strong>overlap_*_*</strong>:
The overlap of the <abbr title="tissue probability maps">TPMs</abbr> estimated from the image and
the corresponding maps from the ICBM nonlinear-asymmetric 2009c template.</p>
<div class="math">
\[\text{JI}^k = \frac{\sum_i \min{(\text{TPM}^k_i, \text{MNI}^k_i)}}{\sum_i \max{(\text{TPM}^k_i, \text{MNI}^k_i)}}\]</div>
</li>
</ul>
<div class="topic">
<p class="topic-title first">References</p>
<table class="docutils citation" frame="void" id="dietrich2007" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Dietrich2007]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id17">2</a>)</em> Dietrich et al., <em>Measurement of SNRs in MR images: influence
of multichannel coils, parallel imaging and reconstruction filters</em>, JMRI 26(2):375&#8211;385.
2007. doi:<a class="reference external" href="http://dx.doi.org/10.1002/jmri.20969">10.1002/jmri.20969</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="ganzetti2016" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Ganzetti2016]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id13">2</a>)</em> Ganzetti et al., <em>Intensity inhomogeneity correction of structural MR images:
a data-driven approach to define input algorithm parameters</em>. Front Neuroinform 10:10. 2016.
doi:<a class="reference external" href="http://dx.doi.org/10.3389/finf.201600010">10.3389/finf.201600010</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="magnota2006" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Magnota2006]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id14">2</a>)</em> Magnotta, VA., &amp; Friedman, L., <em>Measurement of signal-to-noise
and contrast-to-noise in the fBIRN multicenter imaging study</em>.
J Dig Imag 19(2):140-147, 2006. doi:<a class="reference external" href="http://dx.doi.org/10.1007/s10278-006-0264-x">10.1007/s10278-006-0264-x</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="mortamet2009" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Mortamet2009]</td><td><em>(<a class="fn-backref" href="#id4">1</a>, <a class="fn-backref" href="#id9">2</a>, <a class="fn-backref" href="#id10">3</a>, <a class="fn-backref" href="#id12">4</a>)</em> Mortamet B et al., <em>Automatic quality assessment in
structural brain magnetic resonance imaging</em>, Mag Res Med 62(2):365-372,
2009. doi:<a class="reference external" href="http://dx.doi.org/10.1002/mrm.21992">10.1002/mrm.21992</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="tustison2010" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[Tustison2010]</a></td><td>Tustison NJ et al., <em>N4ITK: improved N3 bias correction</em>, IEEE Trans Med Imag, 29(6):1310-20,
2010. doi:<a class="reference external" href="http://dx.doi.org/10.1109/TMI.2010.2046908">10.1109/TMI.2010.2046908</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="shehzad2015" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Shehzad2015]</td><td><em>(<a class="fn-backref" href="#id6">1</a>, <a class="fn-backref" href="#id16">2</a>)</em> Shehzad Z et al., <em>The Preprocessed Connectomes Project
Quality Assessment Protocol - a resource for measuring the quality of MRI data</em>,
Front. Neurosci. Conference Abstract: Neuroinformatics 2015.
doi: <a class="reference external" href="https://doi.org/10.3389/conf.fnins.2015.91.00047">10.3389/conf.fnins.2015.91.00047</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="forman1995" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id11">[Forman1995]</a></td><td>Forman SD et a., <em>Improved assessment of significant activation in functional
magnetic resonance imaging (fMRI): use of a cluster-size threshold</em>,
Magn. Reson. Med. 33 (5), 636–647, 1995.
doi:<a class="reference external" href="http://dx.doi.org/10.1016/j.neuroimage.2006.03.062">10.1016/j.neuroimage.2006.03.062</a>.</td></tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="mriqc-qc-anatomical-module">
<h2>mriqc.qc.anatomical module<a class="headerlink" href="#mriqc-qc-anatomical-module" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="mriqc.qc.anatomical.art_qi1">
<code class="descclassname">mriqc.qc.anatomical.</code><code class="descname">art_qi1</code><span class="sig-paren">(</span><em>airmask</em>, <em>artmask</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mriqc/qc/anatomical.html#art_qi1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mriqc.qc.anatomical.art_qi1" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect artifacts in the image using the method described in <a class="reference internal" href="#mortamet2009" id="id12">[Mortamet2009]</a>.
Caculates <span class="math">\(\text{QI}_1\)</span>, as the proportion of voxels with intensity corrupted by artifacts
normalized by the number of voxels in the background:</p>
<div class="math">
\[\text{QI}_1 = \frac{1}{N} \sum\limits_{x\in X_\text{art}} 1\]</div>
<p>Lower values are better.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>airmask</strong> (<em>numpy.ndarray</em>) &#8211; input air mask, without artifacts</li>
<li><strong>artmask</strong> (<em>numpy.ndarray</em>) &#8211; input artifacts mask</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mriqc.qc.anatomical.art_qi2">
<code class="descclassname">mriqc.qc.anatomical.</code><code class="descname">art_qi2</code><span class="sig-paren">(</span><em>img</em>, <em>airmask</em>, <em>ncoils=12</em>, <em>erodemask=True</em>, <em>out_file=u'qi2_fitting.txt'</em>, <em>min_voxels=1000.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mriqc/qc/anatomical.html#art_qi2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mriqc.qc.anatomical.art_qi2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates <span class="math">\(\text{QI}_2\)</span>, based on the goodness-of-fit of a centered
<span class="math">\(\chi^2\)</span> distribution onto the intensity distribution of
non-artifactual background (within the &#8220;hat&#8221; mask):</p>
<div class="math">
\[\chi^2_n = \frac{2}{(\sigma \sqrt{2})^{2n} \, (n - 1)!}x^{2n - 1}\, e^{-\frac{x}{2}}\]</div>
<p>where <span class="math">\(n\)</span> is the number of coil elements.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>numpy.ndarray</em>) &#8211; input data</li>
<li><strong>airmask</strong> (<em>numpy.ndarray</em>) &#8211; input air mask without artifacts</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mriqc.qc.anatomical.cjv">
<code class="descclassname">mriqc.qc.anatomical.</code><code class="descname">cjv</code><span class="sig-paren">(</span><em>mu_wm</em>, <em>mu_gm</em>, <em>sigma_wm</em>, <em>sigma_gm</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mriqc/qc/anatomical.html#cjv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mriqc.qc.anatomical.cjv" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the <abbr title="coefficient of joint variation">CJV</abbr>, a measure
related to <abbr title="Signal-to-Noise Ratio">SNR</abbr> and
<abbr title="Contrast-to-Noise Ratio">CNR</abbr> that is presented as a proxy for
the <abbr title="intensity non-uniformity">INU</abbr> artifact <a class="reference internal" href="#ganzetti2016" id="id13">[Ganzetti2016]</a>.
Lower is better.</p>
<div class="math">
\[\text{CJV} = \frac{\sigma_\text{WM} + \sigma_\text{GM}}{|\mu_\text{WM} - \mu_\text{GM}|}.\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>numpy.ndarray</em>) &#8211; the input data</li>
<li><strong>wmmask</strong> (<em>numpy.ndarray</em>) &#8211; the white matter mask</li>
<li><strong>gmmask</strong> (<em>numpy.ndarray</em>) &#8211; the gray matter mask</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">the computed CJV</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mriqc.qc.anatomical.cnr">
<code class="descclassname">mriqc.qc.anatomical.</code><code class="descname">cnr</code><span class="sig-paren">(</span><em>mu_wm</em>, <em>mu_gm</em>, <em>sigma_air</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mriqc/qc/anatomical.html#cnr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mriqc.qc.anatomical.cnr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the <abbr title="Contrast-to-Noise Ratio">CNR</abbr> <a class="reference internal" href="#magnota2006" id="id14">[Magnota2006]</a>.
Higher values are better.</p>
<div class="math">
\[\text{CNR} = \frac{|\mu_\text{GM} - \mu_\text{WM} |}{\sqrt{\sigma_B^2 +
\sigma_\text{WM}^2 + \sigma_\text{GM}^2}},\]</div>
<p>where <span class="math">\(\sigma_B\)</span> is the standard deviation of the noise distribution within
the air (background) mask.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>numpy.ndarray</em>) &#8211; input data</li>
<li><strong>seg</strong> (<em>numpy.ndarray</em>) &#8211; input segmentation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">the computed CNR</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mriqc.qc.anatomical.efc">
<code class="descclassname">mriqc.qc.anatomical.</code><code class="descname">efc</code><span class="sig-paren">(</span><em>img</em>, <em>framemask=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mriqc/qc/anatomical.html#efc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mriqc.qc.anatomical.efc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the <abbr title="Entropy Focus Criterion">EFC</abbr> <a class="reference internal" href="bold.html#atkinson1997" id="id15">[Atkinson1997]</a>.
Uses the Shannon entropy of voxel intensities as an indication of ghosting
and blurring induced by head motion. A range of low values is better,
with EFC = 0 for all the energy concentrated in one pixel.</p>
<div class="math">
\[\text{E} = - \sum_{j=1}^N \frac{x_j}{x_\text{max}} \ln \left[\frac{x_j}{x_\text{max}}\right]\]</div>
<p>with <span class="math">\(x_\text{max} = \sqrt{\sum_{j=1}^N x^2_j}\)</span>.</p>
<p>The original equation is normalized by the maximum entropy, so that the
<abbr title="Entropy Focus Criterion">EFC</abbr> can be compared across images with
different dimensions:</p>
<div class="math">
\[\text{EFC} = \left( \frac{N}{\sqrt{N}} \, \log{\sqrt{N}^{-1}} \right) \text{E}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>img</strong> (<em>numpy.ndarray</em>) &#8211; input data</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mriqc.qc.anatomical.fber">
<code class="descclassname">mriqc.qc.anatomical.</code><code class="descname">fber</code><span class="sig-paren">(</span><em>img</em>, <em>headmask</em>, <em>rotmask=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mriqc/qc/anatomical.html#fber"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mriqc.qc.anatomical.fber" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the <abbr title="Foreground-Background Energy Ratio">FBER</abbr> <a class="reference internal" href="#shehzad2015" id="id16">[Shehzad2015]</a>,
defined as the mean energy of image values within the head relative
to outside the head. Higher values are better.</p>
<div class="math">
\[\text{FBER} = \frac{E[|F|^2]}{E[|B|^2]}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>img</strong> (<em>numpy.ndarray</em>) &#8211; input data</li>
<li><strong>seg</strong> (<em>numpy.ndarray</em>) &#8211; input segmentation</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mriqc.qc.anatomical.rpve">
<code class="descclassname">mriqc.qc.anatomical.</code><code class="descname">rpve</code><span class="sig-paren">(</span><em>pvms</em>, <em>seg</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mriqc/qc/anatomical.html#rpve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mriqc.qc.anatomical.rpve" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the <abbr title="residual partial voluming error">rPVe</abbr>
of each tissue class.</p>
<div class="math">
\[\text{rPVE}^k = \frac{1}{N} \left[ \sum\limits_{p^k_i \in [0.5, P_{98}]} p^k_i + \sum\limits_{p^k_i \in [P_{2}, 0.5)} 1 - p^k_i \right]\]</div>
</dd></dl>

<dl class="function">
<dt id="mriqc.qc.anatomical.snr">
<code class="descclassname">mriqc.qc.anatomical.</code><code class="descname">snr</code><span class="sig-paren">(</span><em>mu_fg</em>, <em>sigma_fg</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mriqc/qc/anatomical.html#snr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mriqc.qc.anatomical.snr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the <abbr title="Signal-to-Noise Ratio">SNR</abbr>.
The estimation may be provided with only one foreground region in
which the noise is computed as follows:</p>
<div class="math">
\[\text{SNR} = \frac{\mu_F}{\sigma_F\sqrt{n/(n-1)}},\]</div>
<p>where <span class="math">\(\mu_F\)</span> is the mean intensity of the foreground and
<span class="math">\(\sigma_F\)</span> is the standard deviation of the same region.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>numpy.ndarray</em>) &#8211; input data</li>
<li><strong>fgmask</strong> (<em>numpy.ndarray</em>) &#8211; input foreground mask or segmentation</li>
<li><strong>erode</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; erode masks before computations.</li>
<li><strong>fglabel</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; foreground label in the segmentation data.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">the computed SNR for the foreground segmentation</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mriqc.qc.anatomical.snr_dietrich">
<code class="descclassname">mriqc.qc.anatomical.</code><code class="descname">snr_dietrich</code><span class="sig-paren">(</span><em>mu_fg</em>, <em>sigma_air</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mriqc/qc/anatomical.html#snr_dietrich"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mriqc.qc.anatomical.snr_dietrich" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the <abbr title="Signal-to-Noise Ratio">SNR</abbr>.</p>
<p>This must be an air mask around the head, and it should not contain artifacts.
The computation is done following the eq. A.12 of <a class="reference internal" href="#dietrich2007" id="id17">[Dietrich2007]</a>, which
includes a correction factor in the estimation of the standard deviation of
air and its Rayleigh distribution:</p>
<div class="math">
\[\text{SNR} = \frac{\mu_F}{\sqrt{\frac{2}{4-\pi}}\,\sigma_\text{air}}.\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>img</strong> (<em>numpy.ndarray</em>) &#8211; input data</li>
<li><strong>smask</strong> (<em>numpy.ndarray</em>) &#8211; input foreground mask or segmentation</li>
<li><strong>airmask</strong> (<em>numpy.ndarray</em>) &#8211; input background mask or segmentation</li>
<li><strong>erode</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; erode masks before computations.</li>
<li><strong>fglabel</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) &#8211; foreground label in the segmentation data.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">the computed SNR for the foreground segmentation</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mriqc.qc.anatomical.summary_stats">
<code class="descclassname">mriqc.qc.anatomical.</code><code class="descname">summary_stats</code><span class="sig-paren">(</span><em>img</em>, <em>pvms</em>, <em>airmask=None</em>, <em>erode=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mriqc/qc/anatomical.html#summary_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mriqc.qc.anatomical.summary_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates the mean, the standard deviation, the 95%
and the 5% percentiles of each tissue distribution.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Sometimes (with datasets that have been partially processed), the air
mask will be empty. In those cases, the background stats will be zero
for the mean, median, percentiles and kurtosis, the sum of voxels in
the other remaining labels for <code class="docutils literal"><span class="pre">n</span></code>, and finally the MAD and the
<span class="math">\(\sigma\)</span> will be calculated as:</p>
<div class="last math">
\[\sigma_\text{BG} = \sqrt{\sum \sigma_\text{i}^2}\]</div>
</div>
</dd></dl>

<dl class="function">
<dt id="mriqc.qc.anatomical.volume_fraction">
<code class="descclassname">mriqc.qc.anatomical.</code><code class="descname">volume_fraction</code><span class="sig-paren">(</span><em>pvms</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mriqc/qc/anatomical.html#volume_fraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mriqc.qc.anatomical.volume_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the <abbr title="intracranial volume">ICV</abbr> fractions
corresponding to the (partial volume maps).</p>
<div class="math">
\[\text{ICV}^k = \frac{\sum_i p^k_i}{\sum\limits_{x \in X_\text{brain}} 1}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pvms</strong> (<em>list</em>) &#8211; list of <code class="code docutils literal"><span class="pre">numpy.ndarray</span></code> of partial volume maps.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mriqc.qc.anatomical.wm2max">
<code class="descclassname">mriqc.qc.anatomical.</code><code class="descname">wm2max</code><span class="sig-paren">(</span><em>img</em>, <em>mu_wm</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mriqc/qc/anatomical.html#wm2max"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mriqc.qc.anatomical.wm2max" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the <abbr title="white-matter-to-max ratio">WM2MAX</abbr>,
defined as the maximum intensity found in the volume w.r.t. the
mean value of the white matter tissue. Values close to 1.0 are
better:</p>
<div class="math">
\[\text{WM2MAX} = \frac{\mu_\text{WM}}{P_{99.95}(X)}\]</div>
</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="bold.html" class="btn btn-neutral float-right" title="IQMs for functional images" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../measures.html" class="btn btn-neutral" title="Image Quality Metrics (IQMs)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Oscar Esteban.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>