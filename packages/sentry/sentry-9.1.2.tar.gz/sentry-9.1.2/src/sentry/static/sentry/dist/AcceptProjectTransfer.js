(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{1607:function(e,t,n){"use strict";n.d(t,"a",function(){return O});var r=n(12),a=n.n(r),i=n(4),o=n.n(i),s=n(6),c=n.n(s),l=n(7),u=n.n(l),d=n(5),g=n.n(d),p=n(8),f=n.n(p),h=n(1),m=n.n(h),v=n(0),b=n.n(v),w=n(84),y=n.n(w),E=n(2),j=n(30),O=function(e){function t(){var e,n;o()(this,t);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(n=u()(this,(e=g()(t)).call.apply(e,[this].concat(i)))).openDialog=function(e){var t=n.props.provider.setupDialog,r=t.url,i=t.width,o=t.height,s=n.computeCenteredWindow(i,o),c=s.left,l=s.top,u=a()({},e);n.props.reinstallId&&(u.reinstall_id=n.props.reinstallId);var d="".concat(r,"?").concat(y.a.stringify(u)),g="scrollbars=yes,width=".concat(i,",height=").concat(o,",top=").concat(l,",left=").concat(c);n.dialog=window.open(d,"sentryAddIntegration",g),n.dialog.focus()},n.didReceiveMessage=function(e){if(e.origin===document.location.origin&&e.source===n.dialog){var t=e.data,r=t.success,a=t.data;n.dialog=null,r?a&&(n.props.onInstall(a),j.default.addSuccess(Object(E.t)("".concat(n.props.provider.name," added")))):j.default.addError(a.error)}},n}return f()(t,e),c()(t,[{key:"componentDidMount",value:function(){this.dialog=null,window.addEventListener("message",this.didReceiveMessage)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("message",this.didReceiveMessage),this.dialog&&this.dialog.close()}},{key:"computeCenteredWindow",value:function(e,t){var n=null!=window.screenLeft?window.screenLeft:screen.left,r=null!=window.screenTop?window.screenTop:screen.top;return{left:(window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-e/2+n,top:(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-t/2+r}}},{key:"render",value:function(){return this.props.children(this.openDialog)}}]),t}(b.a.Component);O.propTypes={children:m.a.func.isRequired,provider:m.a.object.isRequired,onInstall:m.a.func.isRequired,reinstallId:m.a.string}},2309:function(e,t,n){"use strict";n.r(t);var r=n(4),a=n.n(r),i=n(6),o=n.n(i),s=n(7),c=n.n(s),l=n(5),u=n.n(l),d=n(96),g=n.n(d),p=n(8),f=n.n(p),h=n(0),m=n.n(h),v=n(39),b=n(153),w=n(257),y=n(239),E=n(481),j=n(99),O=n(2),z=function(e){function t(){var e,n;a()(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=c()(this,(e=u()(t)).call.apply(e,[this].concat(i)))).handleSubmit=function(e){n.api.request("/accept-transfer/",{method:"POST",data:{data:n.props.location.query.data,organization:e.organization},success:function(){var t=e.organization;n.props.router.push("/".concat(t)),Object(v.addSuccessMessage)(Object(O.t)("Project successfully transferred"))},error:function(e){var t=e&&e.responseJSON&&"string"==typeof e.responseJSON.detail?e.responseJSON.detail:"";Object(v.addErrorMessage)(Object(O.t)("Unable to transfer project")+t?": ".concat(t):"")}})},n}return f()(t,e),o()(t,[{key:"getEndpoints",value:function(){return[["transferDetails","/accept-transfer/",{query:this.props.location.query}]]}},{key:"getTitle",value:function(){return Object(O.t)("Accept Project Transfer")}},{key:"renderError",value:function(e){var n=!1;e&&e.responseJSON&&"string"==typeof e.responseJSON.detail&&(Object(v.addErrorMessage)(e.responseJSON.detail),n=!0),g()(u()(t.prototype),"renderError",this).call(this,e,n)}},{key:"renderBody",value:function(){var e=this.state.transferDetails,t=[];return e.organizations.forEach(function(e){t.push([e.slug,e.slug])}),m.a.createElement(y.default,null,m.a.createElement(j.default,{title:Object(O.t)("Approve Transfer Project Request")}),m.a.createElement("p",null,Object(O.tct)("Projects must be transferred to a specific [organization]. You can grant specific teams access to the project later under the [projectSettings]. (Note that granting access to at least one team is necessary for the project to appear in all parts of the UI.)",{organization:m.a.createElement("strong",null,Object(O.t)("Organization")),projectSettings:m.a.createElement("strong",null,Object(O.t)("Project Settings"))})),m.a.createElement("p",null,Object(O.tct)("Please select which [organization] you want for the project [project].",{organization:m.a.createElement("strong",null,Object(O.t)("Organization")),project:e.project.slug})),m.a.createElement(w.default,{onSubmit:this.handleSubmit,submitLabel:Object(O.t)("Transfer Project"),submitPriority:"danger",initialData:{organization:t[0]&&t[0][0]}},m.a.createElement(E.default,{choices:t,label:Object(O.t)("Organization"),name:"organization",style:{borderBottom:"none"}})))}}]),t}(b.default);t.default=z},2310:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return T});var r=n(26),a=n.n(r),i=n(11),o=n.n(i),s=n(4),c=n.n(s),l=n(6),u=n.n(l),d=n(7),g=n.n(d),p=n(5),f=n.n(p),h=n(8),m=n.n(h),v=n(0),b=n.n(v),w=n(3),y=n(600),E=n(2),j=n(1607),O=n(81),z=n(153),k=n(24),S=n(479),I=n(78),A=n(30),q=n(239),P=n(102),T=function(e){function t(){var e,n;c()(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=g()(this,(e=f()(t)).call.apply(e,[this].concat(a)))).state={selectedOrg:null,organization:null,providers:[],reloading:!1},n.onInstall=function(e){var t=n.state.organization.slug;n.props.router.push("/settings/".concat(t,"/integrations/").concat(e.provider.key,"/").concat(e.id))},n.onSelectOrg=function(e){var t=e.value;n.setState({selectedOrg:t,reloading:!0});n.api.request("/organizations/".concat(t,"/"),{success:function(e){return n.setState({organization:e,reloading:!1})},error:function(){n.setState({reloading:!1}),A.default.addError(Object(E.t)("Failed to retrieve organization details"))}}),n.api.request("/organizations/".concat(t,"/config/integrations/"),{success:function(e){return n.setState({providers:e.providers,reloading:!1})},error:function(){n.setState({reloading:!1}),A.default.addError(Object(E.t)("Failed to retrieve integration provider details"))}})},n.hasAccess=function(e){return e.access.includes("org:integrations")},n}return m()(t,e),u()(t,[{key:"getEndpoints",value:function(){return[["organizations","/organizations/"]]}},{key:"getTitle",value:function(){return Object(E.t)("Choose Installation Organization")}},{key:"renderAddButton",value:function(){var e=this,t=this.state,n=t.organization,r=t.reloading,a=this.props.params.installationId,i=function(e){return b.a.createElement(k.default,o()({priority:"primary",busy:r},e),"Install Integration")};return this.provider?b.a.createElement(j.a,{provider:this.provider,onInstall:this.onInstall},function(t){return b.a.createElement(i,{disabled:n&&!e.hasAccess(n),onClick:function(){return t({installation_id:a})}})}):b.a.createElement(i,{disabled:!0})}},{key:"renderBody",value:function(){var e=this,t=this.state,n=t.organization,r=t.selectedOrg,i=this.state.organizations.map(function(e){return[e.slug,e.slug]}),o=I.default.get("integrations:feature-gates");o.push(function(){return{FeatureList:null}});var s=o[0]().FeatureList;return b.a.createElement(q.default,null,b.a.createElement("h3",null,Object(E.t)("Finish integration installation")),b.a.createElement("p",null,Object(E.tct)("Please pick a specific [organization:organization] to link with\n            your integration installation.",{organization:b.a.createElement("strong",null)})),r&&n&&!this.hasAccess(n)&&b.a.createElement(O.default,{type:"error",icon:"icon-circle-exclamation"},b.a.createElement("p",null,Object(E.tct)("You do not have permission to install integrations in\n                  [organization]. Ask your organization owner or manager to\n                  visit this page to finish installing this integration.",{organization:b.a.createElement("strong",null,n.slug)})),b.a.createElement(J,null,window.location.href)),this.provider&&n&&this.hasAccess(n)&&s&&b.a.createElement(b.a.Fragment,null,b.a.createElement("p",null,Object(E.tct)("The following features will be availble for [organization] when installed.",{organization:b.a.createElement("strong",null,n.slug)})),b.a.createElement(s,{organization:n,features:this.provider.metadata.features,formatter:y.b,provider:this.provider})),b.a.createElement(S.default,{label:Object(E.t)("Organization"),inline:!1,stacked:!0,required:!0},function(){return b.a.createElement(P.a,{onChange:e.onSelectOrg,value:r,placeholder:Object(E.t)("Select an organization"),options:i.map(function(e){var t=a()(e,2);return{value:t[0],label:t[1]}})})}),b.a.createElement("div",{className:"form-actions"},this.renderAddButton()))}},{key:"provider",get:function(){var e=this;return this.state.providers.find(function(t){return t.key===e.props.params.providerId})}}]),t}(z.default),J=Object(w.default)("pre",{target:"eljc3f20"})("margin-bottom:0;background:#fbe3e1;")}}]);
//# sourceMappingURL=AcceptProjectTransfer.js.map