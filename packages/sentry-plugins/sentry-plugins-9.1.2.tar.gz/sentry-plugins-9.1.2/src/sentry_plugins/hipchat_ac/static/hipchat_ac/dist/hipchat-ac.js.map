{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"React\"","webpack:///external \"SentryApp\"","webpack:///./components/settings.jsx","webpack:///./hipchat_ac.jsx"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","React","SentryApp","Settings","props","_this","_classCallCheck","this","_getPrototypeOf","onTest","_assertThisInitialized","fetchData","assign","state","tenants","tenantsLoading","tenantsError","plugins","BasePlugin","DefaultSettings","_this2","_get","api","request","concat","getPluginEndpoint","success","data","setState","error","_this3","loadingIndicator","IndicatorStore","add","i18n","method","testResults","message","complete","remove","url","metadata","length","onPremise","external_React_default","a","createElement","href","className","target","descriptor","_this4","external_SentryApp_","onRetry","isTestable","plugin","style","fontSize","map","tenant","id","room","owner","authUser","username","onClick","organization","slug","project","renderLink","renderTenants","Hipchat","settings","_extends","displayName"],"mappings":"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","file":"hipchat-ac.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","module.exports = React;","module.exports = SentryApp;","import React from 'react';\nimport {i18n, IndicatorStore, LoadingError, LoadingIndicator, plugins} from 'sentry';\n\nclass Settings extends plugins.BasePlugin.DefaultSettings {\n  constructor(props) {\n    super(props);\n\n    this.onTest = this.onTest.bind(this);\n    this.fetchData = this.fetchData.bind(this);\n\n    Object.assign(this.state, {\n      tenants: null,\n      tenantsLoading: true,\n      tenantsError: false,\n    });\n  }\n\n  fetchData() {\n    super.fetchData();\n\n    this.api.request(`${this.getPluginEndpoint()}tenants/`, {\n      success: (data) => {\n        this.setState({\n          tenants: data,\n          tenantsLoading: false,\n          tenantsError: false,\n        });\n      },\n      error: (error) => {\n        this.setState({\n          tenantsLoading: false,\n          tenantsError: true,\n        });\n      }\n    });\n  }\n\n  // TODO(dcramer): move this to Sentry core\n  onTest() {\n    let loadingIndicator = IndicatorStore.add(i18n.t('Saving changes..'));\n    this.api.request(`${this.getPluginEndpoint()}test-config/`, {\n      method: 'POST',\n      success: (data) => {\n        this.setState({\n          testResults: data,\n        });\n      },\n      error: (error) => {\n        this.setState({\n          testResults: {\n            error: true,\n            message: 'An unknown error occurred while testing this integration.',\n          },\n        });\n      },\n      complete: () => {\n        IndicatorStore.remove(loadingIndicator);\n      }\n    });\n  }\n  renderLink(url, metadata) {\n    let tenants = this.state.tenants;\n    if (!tenants || !tenants.length) {\n      if (metadata.onPremise) {\n        return (\n          <div>\n            <p>\n              Installing this integration will allow you to receive notifications\n              for and assign team members to new Sentry errors within HipChat rooms.\n              To install the integration, click the button below.\n            </p>\n            <p>\n              <a href={url}\n                 className=\"btn btn-primary\"\n                 target=\"_blank\">Enable Integration</a>\n            </p>\n          </div>\n        );\n      } else {\n        return (\n          <div>\n            <p>\n              To add the Sentry integration to\n              HipChat click on \"Install an integration from a descriptor URL\"\n              on your room in HipChat and add the following descriptor URL:\n            </p>\n            <pre>{metadata.descriptor}</pre>\n          </div>\n        );\n      }\n    }\n  }\n\n  renderTenants(url) {\n    let tenants = this.state.tenants;\n    if (this.state.tenantsLoading)\n      return <LoadingIndicator />;\n    else if (this.state.tenantsError)\n      return <LoadingError onRetry={this.fetchData} />;\n    if (!tenants.length)\n      return null;\n\n    let isTestable = this.props.plugin.isTestable;\n    return (\n      <div>\n      <h4>Active Rooms</h4>\n        <table className=\"table\" style={{fontSize: 14}}>\n          <thead>\n            <tr>\n              <th>Room</th>\n              <th>By</th>\n              {isTestable &&\n                <th>Test</th>\n              }\n            </tr>\n          </thead>\n          <tbody>\n            {tenants.map((tenant) => {\n              return (\n                <tr key={tenant.id}>\n                  <td>\n                    <strong>{tenant.room.name}</strong><br />\n                    <small>(id: {tenant.room.id}; owner: {tenant.room.owner.name})</small>\n                  </td>\n                  <td>{tenant.authUser && tenant.authUser.username || '(unknown)'}</td>\n                  {isTestable &&\n                    <td>\n                      <a className=\"btn btn-default btn-sm\"\n                         onClick={this.onTest}>Test</a>\n                    </td>\n                  }\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n        <p>\n          To manage HipChat notifications or the rooms in which Sentry errors appear, visit the\n          <a href={url} target=\"_blank\"> integration configuration page</a>.\n        </p>\n        <p>\n          <b>Disabling the plugin here will delete all associations\n            and will disable notifications to all HipChat Rooms</b>\n        </p>\n      </div>\n    );\n  }\n\n  render() {\n    let metadata = this.props.plugin.metadata;\n\n    let url = ('/plugins/hipchat-ac/start/' + this.props.organization.slug +\n               '/' + this.props.project.slug)\n    return (\n      <div className=\"ref-hipchat-settings\">\n        {this.state.testResults &&\n          <div className=\"ref-hipchat-test-results\">\n            <h4>Test Results</h4>\n            {this.state.testResults.error ?\n              <div className=\"alert alert-block alert-error\">{this.state.testResults.message}</div>\n            :\n              <div className=\"alert alert-block alert-success\">{this.state.testResults.message}</div>\n            }\n          </div>\n        }\n        {this.renderLink(url, metadata)}\n        {this.renderTenants(url)}\n      </div>\n    );\n  }\n}\n\nexport default Settings;\n","import React from 'react';\nimport {plugins} from 'sentry';\n\nimport Settings from './components/settings';\n\nclass Hipchat extends plugins.BasePlugin {\n    renderSettings(props) {\n        return <Settings plugin={this} {...props} />;\n    }\n}\n\nHipchat.displayName = 'Hipchat';\n\nplugins.add('hipchat-ac', Hipchat);\n\nexport default Hipchat;\n"],"sourceRoot":""}