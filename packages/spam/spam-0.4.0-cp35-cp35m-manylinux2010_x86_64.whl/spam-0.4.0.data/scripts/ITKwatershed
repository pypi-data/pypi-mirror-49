#!/usr/bin/env python
from __future__ import print_function
import sys
import tifffile
import spam.label

if len(sys.argv) != 2:
    print("ITKwatershed: please run me with one tiff file as input")
    exit()

fileName = sys.argv[1]
markerVol = None

print("-> Loading binary image...", end='')
binVol = tifffile.imread(fileName)
if len(sys.argv) == 3:
    # load markers
    markerVol = tifffile.imread(sys.argv[2])
print("done.")

lab = spam.label.watershed(binVol, markerVol)

print("-> Saving labelled image...", end='')
tifffile.imsave(fileName[0:-4]+'-watershed.tif', lab)
print("done.")
