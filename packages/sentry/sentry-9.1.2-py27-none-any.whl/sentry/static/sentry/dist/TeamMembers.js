(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{2307:function(e,t,r){"use strict";r.r(t);var a=r(90),n=r.n(a),s=r(0),i=r.n(s),o=r(17),m=r.n(o),d=r(3),c=r(37),u=r(154),l=r(62),b=r(24),f=r(61),h=r(161),p=r(312),g=r(30),j=r(590),v=r(53),M=r(33),O=r(66),y=r(25),w=r(23),I=r(106),E=r(2),x=r(15),S=r(123),L=m()({displayName:"TeamMembers",mixins:[c.default,O.a],getInitialState:function(){return{loading:!0,error:!1,dropdownBusy:!1,teamMemberList:null,orgMemberList:null}},componentWillMount:function(){this.fetchData()},componentWillReceiveProps:function(e){var t=this.props.params;e.params.teamId===t.teamId&&e.params.orgId===t.orgId||this.setState({loading:!0,error:!1},this.fetchData)},debouncedFetchMembersRequest:n()(function(e){var t=this;this.setState({dropdownBusy:!0},function(){return t.fetchMembersRequest(e)})},200),removeMember:function(e){var t=this,r=this.props.params;Object(j.d)(this.api,{orgId:r.orgId,teamId:r.teamId,memberId:e.id},{success:function(){t.setState({teamMemberList:t.state.teamMemberList.filter(function(t){return t.id!==e.id})}),g.default.add(Object(E.t)("Successfully removed member from team."),"success",{duration:2e3})},error:function(){g.default.add(Object(E.t)("There was an error while trying to remove a member from the team."),"error",{duration:2e3})}})},fetchMembersRequest:function(e){var t=this,r=this.props.params.orgId;return this.api.request("/organizations/".concat(r,"/members/"),{query:{query:e},success:function(e){t.setState({orgMemberList:e,dropdownBusy:!1})},error:function(){g.default.add(Object(E.t)("Unable to load organization members."),"error",{duration:2e3}),t.setState({dropdownBusy:!1})}})},fetchData:function(){var e=this,t=this.props.params;this.api.request("/teams/".concat(t.orgId,"/").concat(t.teamId,"/members/"),{success:function(t){e.setState({teamMemberList:t,loading:!1,error:!1})},error:function(){e.setState({loading:!1,error:!0})}}),this.fetchMembersRequest("")},addTeamMember:function(e){var t=this,r=this.props.params;this.setState({loading:!0}),this.debouncedFetchMembersRequest(""),Object(j.c)(this.api,{orgId:r.orgId,teamId:r.teamId,memberId:e.value},{success:function(){var r=t.state.orgMemberList.find(function(t){return t.id===e.value});t.setState({loading:!1,error:!1,teamMemberList:t.state.teamMemberList.concat([r])}),g.default.add(Object(E.t)("Successfully added member to team."),"success",{duration:2e3})},error:function(){t.setState({loading:!1}),g.default.add(Object(E.t)("Unable to add team member."),"error",{duration:2e3})}})},handleMemberFilterChange:function(e){this.setState({dropdownBusy:!0}),this.debouncedFetchMembersRequest(e.target.value)},renderDropdown:function(e){var t=this,r=this.props.params;if(!e.has("org:write"))return i.a.createElement(p.a,{disabled:!0,title:Object(E.t)("You do not have enough permission to add new members"),isOpen:!1,size:"xsmall"},Object(E.t)("Add Member"));var a=new Set(this.state.teamMemberList.map(function(e){return e.id})),n=(this.state.orgMemberList||[]).filter(function(e){return!a.has(e.id)}).map(function(e){return{searchKey:"".concat(e.name," ").concat(e.email),value:e.id,label:i.a.createElement(z,null,i.a.createElement(B,{user:e,size:24,className:"avatar"}),i.a.createElement(R,null,e.name||e.email))}}),s=i.a.createElement(k,null,Object(E.t)("Members"),i.a.createElement(D,{to:"/settings/".concat(r.orgId,"/members/new/")},Object(E.t)("Add Member")));return i.a.createElement(h.a,{items:n,onSelect:this.addTeamMember,menuHeader:s,emptyMessage:Object(E.t)("No members"),onChange:this.handleMemberFilterChange,busy:this.state.dropdownBusy,onClose:function(){return t.debouncedFetchMembersRequest("")}},function(e){var t=e.isOpen;e.selectedItem;return i.a.createElement(p.a,{isOpen:t,size:"xsmall"},Object(E.t)("Add Member"))})},removeButton:function(e){return i.a.createElement(b.default,{size:"small",onClick:this.removeMember.bind(this,e)},i.a.createElement(w.default,{src:"icon-circle-subtract",size:"1.25em",style:{marginRight:Object(x.default)(1)}}),Object(E.t)("Remove"))},render:function(){var e=this;if(this.state.loading)return i.a.createElement(M.default,null);if(this.state.error)return i.a.createElement(v.default,{onRetry:this.fetchData});var t=this.props.params,r=this.getAccess();return i.a.createElement(y.a,null,i.a.createElement(y.e,{hasButtons:!0},i.a.createElement("div",null,Object(E.t)("Members")),i.a.createElement("div",{style:{textTransform:"none"}},this.renderDropdown(r))),this.state.teamMemberList.length?this.state.teamMemberList.map(function(a){return i.a.createElement(q,{key:a.id},i.a.createElement(u.a,{avatarSize:36,member:a,useLink:!0,orgId:t.orgId}),r.has("org:write")&&e.removeButton(a))}):i.a.createElement(I.default,{icon:"icon-user",size:"large"},Object(E.t)("Your Team is Empty")))}}),q=Object(d.default)("div",{target:"e1jyxppj0"})("display:flex;justify-content:space-between;padding:",Object(x.default)(2),";border-bottom:1px solid ",function(e){return e.theme.borderLight},";"),z=Object(d.default)("div",{target:"e1jyxppj1"})("font-size:0.875em;display:flex;align-items:center;padding:",Object(x.default)(.5),";"),R=Object(d.default)("div",{target:"e1jyxppj2"})("flex-shrink:1;min-width:0;",S.a,";"),B=Object(d.default)(function(e){return i.a.createElement(l.default,e)},{target:"e1jyxppj3"})("min-width:1.75em;min-height:1.75em;width:1.5em;height:1.5em;margin-right:",Object(x.default)(.5),";"),k=Object(d.default)("div",{target:"e1jyxppj4"})("width:250px;font-size:0.875em;padding:",Object(x.default)(1)," 0;text-transform:uppercase;"),D=Object(d.default)(f.a,{target:"e1jyxppj5"})("float:right;text-transform:none;");t.default=L}}]);
//# sourceMappingURL=TeamMembers.js.map