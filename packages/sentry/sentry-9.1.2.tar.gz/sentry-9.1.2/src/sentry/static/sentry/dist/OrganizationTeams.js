(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{2356:function(e,t,a){"use strict";a.r(t);var n=a(11),r=a.n(n),s=a(1),i=a.n(s),o=a(0),c=a.n(o),l=a(17),u=a.n(l),m=a(18),d=a.n(m),p=a(134),b=a(14),f=a(37),g=a(66),h=a(135),j=a(124),O=a(4),v=a.n(O),T=a(6),E=a.n(T),y=a(7),C=a.n(y),z=a(5),M=a.n(z),L=a(8),S=a.n(L),k=a(71),w=a(2),x=a(24),A=a(25),P=a(9),N=a(99),q=a(187),I=a(10),R=a(106),Y=a(113),B=a(16),D=a(39),J=a(590),U=a(154),F=u()({displayName:"AllTeamsRow",propTypes:{urlPrefix:i.a.string.isRequired,access:i.a.object.isRequired,organization:i.a.object.isRequired,team:i.a.object.isRequired,openMembership:i.a.bool.isRequired},mixins:[f.default],getInitialState:function(){return{loading:!1,error:!1}},joinTeam:function(){var e=this,t=this.props,a=t.organization,n=t.team;this.setState({loading:!0}),Object(J.c)(this.api,{orgId:a.slug,teamId:n.slug},{success:function(){e.setState({loading:!1,error:!1}),Object(D.addSuccessMessage)(Object(w.tct)("You have joined [team]",{team:"#".concat(n.slug)}))},error:function(){e.setState({loading:!1,error:!0}),Object(D.addErrorMessage)(Object(w.tct)("Unable to join [team]",{team:"#".concat(n.slug)}))}})},leaveTeam:function(){var e=this,t=this.props,a=t.organization,n=t.team;this.setState({loading:!0}),Object(J.d)(this.api,{orgId:a.slug,teamId:n.slug},{success:function(){e.setState({loading:!1,error:!1}),Object(D.addSuccessMessage)(Object(w.tct)("You have left [team]",{team:"#".concat(n.slug)}))},error:function(){e.setState({loading:!1,error:!0}),Object(D.addErrorMessage)(Object(w.tct)("Unable to leave [team]",{team:"#".concat(n.slug)}))}})},render:function(){var e=this.props,t=e.access,a=e.team,n=e.urlPrefix,r=e.openMembership,s=c.a.createElement(U.a,{team:a,avatarSize:36,description:Object(w.tn)("%s Member","%s Members",a.memberCount)});return c.a.createElement(A.f,{p:0,align:"center"},c.a.createElement(B.Box,{flex:"1",p:2},t.has("team:read")?c.a.createElement(I.Link,{to:"".concat(n,"teams/").concat(a.slug,"/")},s):s),c.a.createElement(B.Box,{p:2},this.state.loading?c.a.createElement("a",{className:"btn btn-default btn-sm btn-loading btn-disabled"},"..."):a.isMember?c.a.createElement("a",{className:"leave-team btn btn-default btn-sm",onClick:this.leaveTeam},Object(w.t)("Leave Team")):a.isPending?c.a.createElement("a",{className:"btn btn-default btn-sm btn-disabled"},Object(w.t)("Request Pending")):r?c.a.createElement("a",{className:"btn btn-default btn-sm",onClick:this.joinTeam},Object(w.t)("Join Team")):c.a.createElement("a",{className:"btn btn-default btn-sm",onClick:this.joinTeam},Object(w.t)("Request Access"))))}}),G=function(e){function t(){var e,a;v()(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=C()(this,(e=M()(t)).call.apply(e,[this].concat(r)))).handleCreateTeam=function(e){var t=a.props,n=t.useCreateModal,r=t.organization;n&&(e.preventDefault(),Object(k.d)({organization:r,onClose:function(){}}))},a}return S()(t,e),E()(t,[{key:"render",value:function(){var e=this.props,t=e.access,a=e.organization,n=e.urlPrefix,r=e.openMembership,s=e.useCreateModal,i=this.props.teamList.map(function(e,s){return c.a.createElement(F,{urlPrefix:n,access:t,team:e,organization:a,openMembership:r,key:e.slug})});if(0!==i.length)return i;var o=s?"#":"/organizations/".concat(a.slug,"/teams/new/");return c.a.createElement(R.default,null,Object(w.tct)("No teams here. [teamCreate]",{root:c.a.createElement(Y.default,{noMargin:!0}),teamCreate:t.has("project:admin")?Object(w.tct)("You can always [link:create one].",{link:c.a.createElement(I.Link,{to:o,onClick:this.handleCreateTeam})}):null}))}}]),t}(c.a.Component);G.propTypes={urlPrefix:i.a.string,access:i.a.object,organization:P.default.Organization,teamList:i.a.arrayOf(P.default.Team),openMembership:i.a.bool,useCreateModal:i.a.bool};var H=G,K=function(e){function t(){return v()(this,t),C()(this,M()(t).apply(this,arguments))}return S()(t,e),E()(t,[{key:"render",value:function(){var e=this.props,t=e.allTeams,a=e.activeTeams,n=e.organization,r=e.access,s=e.features,i=e.routes,o=e.params,l=n;if(!n)return null;var u=Object(g.b)(n).getAccess().has("project:admin"),m=c.a.createElement(x.default,{priority:"primary",size:"small",disabled:!u,title:u?void 0:Object(w.t)("You do not have permission to create teams"),onClick:function(){return Object(k.d)({organization:n})},icon:"icon-circle-add"},Object(w.t)("Create Team")),d=i.find(function(e){return"teams/"===e.path}),p=Object(q.a)(d,{routes:i,params:o,stepBack:-2}),b=new Set(a.map(function(e){return e.id})),f=t.filter(function(e){return!b.has(e.id)});return c.a.createElement("div",{"data-test-id":"team-list",className:"team-list"},c.a.createElement(N.default,{title:Object(w.t)("Teams"),action:m}),c.a.createElement(A.a,null,c.a.createElement(A.e,null,Object(w.t)("Your Teams")),c.a.createElement(A.c,null,c.a.createElement(H,{useCreateModal:!0,urlPrefix:p,organization:l,teamList:a,access:r,openMembership:!1}))),c.a.createElement(A.a,null,c.a.createElement(A.e,null,Object(w.t)("Other Teams")),c.a.createElement(A.c,null,c.a.createElement(H,{useCreateModal:!0,urlPrefix:p,organization:l,teamList:f,access:r,openMembership:!(!s.has("open-membership")&&!r.has("org:write"))}))))}}]),t}(c.a.Component);K.propTypes={allTeams:i.a.arrayOf(P.default.Team),activeTeams:i.a.arrayOf(P.default.Team),organization:P.default.Organization,access:i.a.object,features:i.a.object,routes:i.a.array,params:i.a.object};var Q=K,V=u()({displayName:"OrganizationTeamsContainer",propTypes:{routes:i.a.arrayOf(i.a.object)},mixins:[f.default,g.a,d.a.listenTo(j.a,"onTeamListChange"),d.a.listenTo(h.a,"onProjectListChange")],getInitialState:function(){return{teamList:Object(b.sortArray)(j.a.getAll(),function(e){return e&&e.name}),projectList:Object(b.sortArray)(h.a.getAll(),function(e){return e&&e.name}),projectStats:{}}},componentDidMount:function(){this.fetchStats()},fetchStats:function(){Object(p.c)(this.api,{orgId:this.props.params.orgId,query:{since:(new Date).getTime()/1e3-86400,stat:"generated",group:"project"}})},onTeamListChange:function(){var e=j.a.getAll();this.setState({teamList:Object(b.sortArray)(e,function(e){return e.name})})},onProjectListChange:function(){var e=h.a.getAll();this.setState({projectList:Object(b.sortArray)(e,function(e){return e.name})})},render:function(){if(!this.context.organization)return null;var e=this.getAccess(),t=this.getFeatures(),a=this.getOrganization(),n=this.state.teamList,s=this.state.teamList.filter(function(e){return e.isMember});return c.a.createElement(Q,r()({},this.props,{access:e,features:t,organization:a,projectList:this.state.projectList,allTeams:n,activeTeams:s}))}});t.default=V}}]);
//# sourceMappingURL=OrganizationTeams.js.map