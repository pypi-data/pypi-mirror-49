{"version":3,"sources":["webpack:///./app/views/settings/project/projectOwnership/modal.jsx","webpack:///./app/components/modals/createOwnershipRuleModal.jsx"],"names":["ProjectOwnershipModal","_this$props","this","props","organization","project","issueId","concat","slug","allowError","error","status","_eventData$entries$fi","_eventData$entries$fi2","_eventData$entries$fi3","_eventData$entries$fi4","_eventData$entries$fi5","_eventData$entries$fi6","_this$state","state","ownership","urlTagData","eventData","urls","topValues","sort","a","b","count","map","i","value","slice","frames","entries","find","_ref","type","data","values","stacktrace","_ref2","inAppFrames","filter","frame","inApp","length","paths","uniq_default","filename","absPath","react_default","createElement","Fragment","t","ownerInput","extends_default","initialText","raw","onSave","AsyncComponent","propTypes","SentryTypes","Organization","Project","PropTypes","string","func","CreateOwnershipRuleModal","handleSubmit","_this","handleSuccess","onClose","window","setTimeout","closeModal","Body","Header","objectWithoutProperties_default","closeButton","onHide","modal","React","Component","oneOfType","node","isRequired"],"mappings":"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","file":"CreateOwnershipRuleModal.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport {uniq} from 'lodash';\n\nimport {t} from 'app/locale';\nimport AsyncComponent from 'app/components/asyncComponent';\n\nimport SentryTypes from 'app/sentryTypes';\nimport OwnerInput from 'app/views/settings/project/projectOwnership/ownerInput';\n\nclass ProjectOwnershipModal extends AsyncComponent {\n  static propTypes = {\n    organization: SentryTypes.Organization,\n    project: SentryTypes.Project,\n    issueId: PropTypes.string,\n    onSave: PropTypes.func,\n  };\n\n  getEndpoints() {\n    const {organization, project, issueId} = this.props;\n    return [\n      ['ownership', `/projects/${organization.slug}/${project.slug}/ownership/`],\n      [\n        'urlTagData',\n        `/issues/${issueId}/tags/url/`,\n        {},\n        {\n          allowError: error => {\n            // Allow for 404s\n            return error.status === 404;\n          },\n        },\n      ],\n      ['eventData', `/issues/${issueId}/events/latest/`],\n    ];\n  }\n\n  renderBody() {\n    const {ownership, urlTagData, eventData} = this.state;\n    const urls = urlTagData\n      ? urlTagData.topValues\n          .sort((a, b) => a.count - b.count)\n          .map(i => i.value)\n          .slice(0, 5)\n      : [];\n\n    // pull frame data out of exception or the stacktrace\n    let frames =\n      eventData.entries.find(({type}) => type == 'exception')?.data?.values[0]?.stacktrace\n        ?.frames ||\n      eventData.entries.find(({type}) => type == 'stacktrace')?.data?.frames ||\n      [];\n\n    //filter frames by inApp unless there would be 0\n    const inAppFrames = frames.filter(frame => frame.inApp);\n    if (inAppFrames.length > 0) {\n      frames = inAppFrames;\n    }\n\n    const paths = uniq(\n      frames.map(frame => frame.filename || frame.absPath).filter(i => i)\n    ).slice(0, 30);\n\n    return (\n      <React.Fragment>\n        <p>{t('Match against Issue Data: (globbing syntax *, ? supported)')}</p>\n        <OwnerInput\n          {...this.props}\n          initialText={ownership.raw || ''}\n          urls={urls}\n          paths={paths}\n          onSave={this.props.onSave}\n        />\n      </React.Fragment>\n    );\n  }\n}\n\nexport default ProjectOwnershipModal;\n","import PropTypes from 'prop-types';\nimport React from 'react';\n\nimport {t} from 'app/locale';\nimport ProjectOwnershipModal from 'app/views/settings/project/projectOwnership/modal';\nimport SentryTypes from 'app/sentryTypes';\n\nclass CreateOwnershipRuleModal extends React.Component {\n  static propTypes = {\n    closeModal: PropTypes.func,\n    onClose: PropTypes.func,\n    Body: PropTypes.oneOfType([PropTypes.func, PropTypes.node]).isRequired,\n    Header: PropTypes.oneOfType([PropTypes.func, PropTypes.node]).isRequired,\n    organization: SentryTypes.Organization.isRequired,\n    project: SentryTypes.Project,\n  };\n\n  handleSubmit = data => {\n    this.handleSuccess();\n  };\n\n  handleSuccess = data => {\n    if (this.props.onClose) {\n      this.props.onClose(data);\n    }\n    window.setTimeout(this.props.closeModal, 2000);\n  };\n\n  render() {\n    const {Body, Header, closeModal, ...props} = this.props;\n\n    return (\n      <React.Fragment>\n        <Header closeButton onHide={closeModal}>\n          {t('Create Ownership Rule')}\n        </Header>\n        <Body>\n          <ProjectOwnershipModal {...props} onSave={this.handleSuccess} />\n        </Body>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default CreateOwnershipRuleModal;\n"],"sourceRoot":""}