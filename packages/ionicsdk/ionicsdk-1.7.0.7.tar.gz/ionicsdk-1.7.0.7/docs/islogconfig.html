<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Agent SDK: ISLog Configuration from JSON</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
<link href="ISAgentSDK.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Agent SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ISLog Configuration from JSON </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#logconfig-overview">Overview</a></li>
<li class="level1"><a href="#logconfig-usage">Example Usage</a></li>
<li class="level1"><a href="#logconfig-schema">JSON Configuration Schema</a></li>
<li class="level1"><a href="#sdk-logconfig-example">JSON Configuration Example (Simple)</a></li>
<li class="level1"><a href="#sdk-logconfig-example-adv">JSON Configuration Example (Advanced)</a></li>
</ul>
</div>
<div class="textblock"><p><br />
</p>
<h1><a class="anchor" id="logconfig-overview"></a>
Overview</h1>
<p>Loggers can be created and configured from a JSON configuration file or from a string in memory using a factory singleton provided in the ISLog module. The factory singleton is ISLogFactory.</p>
<p><br />
</p>
<h1><a class="anchor" id="logconfig-usage"></a>
Example Usage</h1>
<p>To create a logger, all you need to do is call a single function on the ISLogFactory singleton. Once the logger is created, you would normally want to set it as the global logger via ISLog::setSingleton().</p>
<p><b>Typical configuration example:</b> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;ISLog.h&quot;</span></div><div class="line"></div><div class="line"><span class="comment">// create a logger from specified JSON configuration file</span></div><div class="line">ISLogBase * pLogger = ISLogFactory::getInstance().createFromConfigFile(<span class="stringliteral">&quot;MyConfigurationFile.json&quot;</span>);</div><div class="line"><span class="keywordflow">if</span> (pLogger != NULL)</div><div class="line">{</div><div class="line">  <span class="comment">// set the logger to be the global logger</span></div><div class="line">  ISLog::setSingleton(pLogger);</div><div class="line">  </div><div class="line">  <span class="comment">// write a sample log (optional!)</span></div><div class="line">  ISLOG_INFO(<span class="stringliteral">&quot;MyApplicationChannel&quot;</span>, <span class="stringliteral">&quot;We configured the logger successfully!&quot;</span>);</div><div class="line">}</div><div class="line"><span class="keywordflow">else</span></div><div class="line">{</div><div class="line">  <span class="comment">// there was an error in the JSON configuration file.  the error can be queried</span></div><div class="line">  <span class="comment">// from the log factory</span></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Error creating logger from JSON configuration file: &quot;</span></div><div class="line">            &lt;&lt; ISLogFactory::getInstance().getError() &lt;&lt; std::endl;</div><div class="line">}</div></div><!-- fragment --><p><b>Vanilla 'C' example:</b> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;ISLog.h&quot;</span></div><div class="line"></div><div class="line"><span class="comment">// create a logger from specified JSON configuration file</span></div><div class="line"><span class="keywordtype">int</span> rc = ionic_log_setup_from_config_file(<span class="stringliteral">&quot;MyConfigurationFile.json&quot;</span>, <span class="stringliteral">&quot;MyRootLoggerPath&quot;</span>);</div><div class="line"><span class="keywordflow">if</span>(rc == ISC_OK)</div><div class="line">{</div><div class="line">  <span class="comment">// write a sample log (optional!)</span></div><div class="line">  ISLOG_INFO(<span class="stringliteral">&quot;MyApplicationChannel&quot;</span>, <span class="stringliteral">&quot;We configured the logger successfully!&quot;</span>);</div><div class="line">}</div><div class="line"><span class="keywordflow">else</span></div><div class="line">{</div><div class="line">  <span class="comment">// there was an error in the JSON configuration file.  the error can be queried</span></div><div class="line">  <span class="comment">// from the log factory</span></div><div class="line">  printf(<span class="stringliteral">&quot;Error creating logger from JSON configuration file: %d\r\n&quot;</span>, rc);</div><div class="line">}</div></div><!-- fragment --><p><b>Python example:</b> </p><div class="fragment"><div class="line"><span class="keyword">import</span> ionicsdk</div><div class="line"><span class="keyword">from</span> inspect <span class="keyword">import</span> currentframe, getframeinfo</div><div class="line"></div><div class="line"><span class="comment"># create a logger from specified JSON configuration file</span></div><div class="line"><a class="code" href="namespaceionicsdk_1_1log.html#ae06c5fcc3ae0568ddb21bf263da97243">ionicsdk.log.setup_from_config_file</a>(<span class="stringliteral">&quot;MyConfigurationFile.json&quot;</span>)</div><div class="line"><span class="keywordflow">if</span> <a class="code" href="namespaceionicsdk_1_1log.html#aece505d1b21759fc0cdd8020dada5023">ionicsdk.log.is_setup</a>():</div><div class="line">  <span class="comment"># write a sample log (optional!)</span></div><div class="line">  frameinfo = getframeinfo(currentframe().f_back)</div><div class="line">  <a class="code" href="namespaceionicsdk_1_1log.html#a14d02e989fa9ee1028d0cc914142dc01">ionicsdk.log.log</a>(ionicsdk.log.SEV_ERROR, <span class="stringliteral">&quot;MyApplicationChannel&quot;</span>, frameinfo.lineno, frameinfo.filename, <span class="stringliteral">&quot;We configured the logger successfully!&quot;</span>)</div><div class="line"><span class="keywordflow">else</span>:</div><div class="line">  <span class="comment"># there was an error in the JSON configuration file.</span></div><div class="line">  print(<span class="stringliteral">&quot;Error creating logger from JSON configuration file&quot;</span>)</div></div><!-- fragment --><p><b>ObjectiveC example:</b> </p><div class="fragment"><div class="line"><span class="preprocessor">#import &lt;IonicAgentSDK/IonicAgentSDK.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// create a logger from specified JSON configuration file</span></div><div class="line">IonicLogBase * pLogger = [[IonicLogFactory getSingleton] createFromConfigFile:@&quot;MyConfigurationFile.json&quot; withBaseFileWriterPath:nil];</div><div class="line"><span class="keywordflow">if</span> (pLogger != NULL)</div><div class="line">{</div><div class="line">  <span class="comment">// set the logger to be the global logger</span></div><div class="line">  [IonicLog setSingleton:pLogger];</div><div class="line"></div><div class="line">  <span class="comment">// write a sample log (optional!)</span></div><div class="line">  IonicLog_Info(<span class="stringliteral">@&quot;MyApplicationChannel&quot;</span>, <span class="stringliteral">@&quot;We configured the logger successfully!&quot;</span>);</div><div class="line">}</div><div class="line"><span class="keywordflow">else</span></div><div class="line">{</div><div class="line">  <span class="comment">// there was an error in the JSON configuration file.  the error can be queried</span></div><div class="line">  <span class="comment">// from the log factory</span></div><div class="line">  NSLog(<span class="stringliteral">@&quot;Error creating logger from JSON configuration file: %@&quot;</span>, [IonicLogFactory getSingleton].lastError);</div><div class="line">}</div></div><!-- fragment --><p><b>C# example:</b> </p><div class="fragment"><div class="line"><span class="keyword">using</span> IonicSecurity.SDK;</div><div class="line"></div><div class="line"><span class="comment">// create a logger from specified JSON configuration file</span></div><div class="line">LogBase logger = LogFactory.GetInstance.CreateFromConfigFile(<span class="stringliteral">&quot;MyConfigurationFile.json&quot;</span>)</div><div class="line"><span class="keywordflow">if</span>(logger != null)</div><div class="line">{</div><div class="line">  Log.SetSingleton(logger);</div><div class="line">  <span class="comment">// write a sample log (optional!)</span></div><div class="line">  Log.LogInfo(<span class="stringliteral">&quot;MyApplicationChannel&quot;</span>, <span class="stringliteral">&quot;We configured the logger successfully!&quot;</span>)</div><div class="line">}</div><div class="line"><span class="keywordflow">else</span></div><div class="line">{</div><div class="line">  <span class="comment">// there was an error in the JSON configuration file.  the error can be queried</span></div><div class="line">  <span class="comment">// from the log factory</span></div><div class="line">  Console.WriteLine(<span class="stringliteral">&quot;Error creating logger from JSON configuration file: &quot;</span> + LogFactory.GetInstance.Error);</div><div class="line">}</div></div><!-- fragment --><p><br />
</p>
<h1><a class="anchor" id="logconfig-schema"></a>
JSON Configuration Schema</h1>
<p>The JSON schema that is expected by the logger factory is defined below. </p><h3>Root Schema</h3>
<table class="ionic">
<tr>
<th>Property </th><th>Required </th><th>Value Type </th><th colspan="1">Default Value </th><th colspan="1">Comment  </th></tr>
<tr>
<td>sinks </td><td>yes </td><td>Array of Sinks (see Sink Schema) </td><td colspan="1">  </td><td colspan="1">Array of sink objects  </td></tr>
</table>
<h3>Sink Schema</h3>
<table class="ionic">
<tr>
<th>Property </th><th>Required </th><th>Value Type </th><th colspan="1">Default Value </th><th colspan="1">Comment  </th></tr>
<tr>
<td>channels </td><td>yes </td><td>Array </td><td colspan="1">  </td><td colspan="1">Array of channel names (strings) that the sink should capture. To capture all channels, you can use "*". <br />
 Typically, each module in Ionic code has its own channel name. At the time of writing, the channel names are ("ISAgent", "ISAgentSDK", "ISAgentTool", "ISChunkCrypto", "ISCrypto", "ISFileCrypto", "ISFingerprint", "ISHTTP", "ISIpc", "ISKeyVault", "ISXml"). Also, the following platforms add their own channel ("C" -&gt; "ISAgentSDKC", Python -&gt; "ISPython", Java-JNI -&gt; "ISJniUtils")   </td></tr>
<tr>
<td colspan="1">filter </td><td colspan="1">no </td><td colspan="1">Filter (see Filter Schema) </td><td colspan="1">  </td><td colspan="1">Specifies a filter for the sink. If none is set, no filter will be applied (ALL log messages allowed through)  </td></tr>
<tr>
<td colspan="1">writers </td><td colspan="1">yes </td><td colspan="1">Array of Writers (see Writer Schema) </td><td colspan="1">  </td><td colspan="1">Array of writer objects  </td></tr>
</table>
<h3>Filter Schema</h3>
<table class="ionic">
<tr>
<th>Property </th><th>Required </th><th>Value Type </th><th colspan="1">Default Value </th><th colspan="1">Comment  </th></tr>
<tr>
<td colspan="1">type </td><td colspan="1">yes </td><td colspan="1">String </td><td colspan="1">  </td><td colspan="1">Possible values are ("Severity")  </td></tr>
<tr>
<td colspan="1">level </td><td colspan="1">yes  </td><td colspan="1">String  </td><td colspan="1">  </td><td colspan="1"><p class="starttd"><b>Only applicable for filters of type "Severity"</b> </p>
<p>Possible values are ("TRACE", "DEBUG", "INFO", "WARN", "ERROR", "FATAL") </p>
<p></p>
<p>This represents the lowest level of log severity that the filter will accept. </p>
<p class="endtd"></p>
</td></tr>
</table>
<h3>Writer Schema</h3>
<table class="ionic">
<tr>
<th>Property </th><th>Required </th><th>Value Type </th><th colspan="1">Default Value </th><th colspan="1">Comment  </th></tr>
<tr>
<td colspan="1">type  </td><td colspan="1">yes  </td><td colspan="1">String  </td><td colspan="1">  </td><td colspan="1">Possible values are ("Console", "File", "RotatingFile"). On Windows <b>only</b>, "VisualStudioConsole" is also supported.  </td></tr>
<tr>
<td colspan="1">filter </td><td colspan="1">no  </td><td colspan="1"><span>Filter (see Filter Schema)</span>  </td><td colspan="1">  </td><td colspan="1"><span>Specifies a filter for the writer. If none is set, no filter will be applied (ALL log messages allowed through)</span>   </td></tr>
<tr>
<td colspan="1">filePattern </td><td colspan="1">yes </td><td colspan="1">String </td><td colspan="1">  </td><td colspan="1"><p class="starttd"><b>Only applicable for writers of type "File" and "RotatingFile"</b> </p>
<p>The filename, optionally including time pattern symbols as defined by strftime(). Most notable and useful are these symbols:</p>
<p></p>
<p> </p>
<p></p>
<p>Y - Four digit year (e.g. 2014)</p>
<p></p>
<p>m - Two digit month with range 01 - 12 (e.g. 05)</p>
<p></p>
<p>d - Two digit day with range 01 - 31 (e.g. 05)</p>
<p></p>
<p>H - Two digit hour with range 00 - 11 (e.g. 05)</p>
<p></p>
<p>M - Two digit minute with range 00 - 59 (e.g. 05)</p>
<p></p>
<p>S - Two digit second 00 - 59 (e.g. 05)</p>
<p></p>
<p> </p>
<p></p>
<p><b>Examples:</b> </p>
<p></p>
<p>"ionic_global.log"</p>
<p></p>
<p>"ionic_global_%Y-%m-%d.log" </p>
<p></p>
<p>"ionic_debug_%Y-%m-%d_%H-%M-%S.log" </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td colspan="1">rotationSchedule </td><td colspan="1">no </td><td colspan="1">String </td><td colspan="1">"DAILY" </td><td colspan="1"><p class="starttd"><b>Only applicable for writers of type "RotatingFile"</b> </p>
<p>The time-based rotation schedule for the file, if any. Possible values are ("NONE", "DAILY", "HOURLY", "MINUTELY")</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td colspan="1">rotationSize </td><td colspan="1">no </td><td colspan="1">String </td><td colspan="1">"50mb" </td><td colspan="1"><p class="starttd"><b>Only applicable for writers of type "RotatingFile"</b> </p>
<p></p>
<p>The size-based rotation threshold for the file. This value can be expressed in bytes, kilobytes, megabytes, gigabytes, or terabytes. The special value of "-1" will disable size-based rotation.</p>
<p></p>
<p>Bytes - Byte count only (e.g. "1024", "51200", "8000")</p>
<p></p>
<p>Kilobytes - Use "kb" postfix (e.g. "20kb", "100kb")</p>
<p></p>
<p>Megabytes - Use "mb" postfix (e.g. "50mb", "100mb")</p>
<p></p>
<p>Gigabytes - Use "gb" postfix (e.g. "5gb", "10gb")</p>
<p></p>
<p>Terabytes - Use "tb" postfix (e.g. "1tb", "5tb")</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td colspan="1">maxTotalSize </td><td colspan="1">no </td><td colspan="1">String </td><td colspan="1">"50tb" </td><td colspan="1"><p class="starttd"><b>Only applicable for writers of type "RotatingFile"</b> </p>
<p></p>
<p>The size-based rotation threshold for the set of files defined by filePattern. This value can be expressed in bytes, kilobytes, megabytes, gigabytes, or terabytes. Whenever a new rotation file is created and the threshold is reached, the oldest files in the set are deleted until the set is under the threshold.</p>
<p></p>
<p>Bytes - Byte count only (e.g. "1024", "51200", "8000")</p>
<p></p>
<p>Kilobytes - Use "kb" postfix (e.g. "20kb", "100kb")</p>
<p></p>
<p>Megabytes - Use "mb" postfix (e.g. "50mb", "100mb")</p>
<p></p>
<p>Gigabytes - Use "gb" postfix (e.g. "5gb", "10gb")</p>
<p></p>
<p>Terabytes - Use "tb" postfix (e.g. "1tb", "5tb")</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td colspan="1">maxAgeSeconds </td><td colspan="1">no </td><td colspan="1">String </td><td colspan="1">"yearly" </td><td colspan="1"><p class="starttd"><b>Only applicable for writers of type "RotatingFile"</b> </p>
<p>The time-based rotation schedule for the set of files defined by filePattern. The value can be expressed minutes, hours, days, weeks, or using a ISO 8601 string. Whenever a new rotation file is created, any other files in the set exceeding this age are deleted.</p>
<p></p>
<p>Seconds - use no postfix (e.g. 59 seconds as "59")</p>
<p></p>
<p>Minutes - use "m" postfix (e.g. 300 minutes as "300m")</p>
<p></p>
<p>Hours - use "h" postfix (e.g. 24 hours as "24h")</p>
<p></p>
<p>Days - use "d" postfix (e.g. 5 days as "5d")</p>
<p></p>
<p>Weeks - use "w" postfix (e.g. 1 week as "1w")</p>
<p></p>
<p>ISO 8601 - Use the duration syntax (e.g. 10 days, 2:30 hours as "P10DT2H30M")</p>
<p class="endtd"></p>
</td></tr>
</table>
<h1><a class="anchor" id="sdk-logconfig-example"></a>
JSON Configuration Example (Simple)</h1>
<p>This example will configure the SDK logger to write logs to a single file. It will log messages that are INFO level or above (this means INFO, WARN, ERROR, FATAL). The filename uses symbols supported by strftime() (e.g. Y, m) in order to put a timestamp into the filename when it is created. <br />
<br />
</p><div class="fragment"><div class="line">{ &quot;sinks&quot;:  [ {</div><div class="line">            &quot;channels&quot;: [ &quot;*&quot; ],</div><div class="line">           </div><div class="line">            &quot;filter&quot;: { &quot;type&quot;: &quot;Severity&quot;,</div><div class="line">                        &quot;level&quot;: &quot;INFO&quot; },</div><div class="line">                       </div><div class="line">            &quot;writers&quot;: [</div><div class="line">                         { &quot;type&quot;: &quot;File&quot;,</div><div class="line">                           &quot;filePattern&quot;: &quot;my_app_%Y-%m-%d_%H-%M-%S.log&quot; }</div><div class="line">                       ]</div><div class="line">          } ] }</div></div><!-- fragment --><h1><a class="anchor" id="sdk-logconfig-example-adv"></a>
JSON Configuration Example (Advanced)</h1>
<p>This example will configure the SDK logger to have two sinks. <br />
<br />
 The first sink accepts all channels ("*") but only writes messages at INFO level and above. This sink has two writers (Console and RotatingFile) in order to push its logs to standard output streams (stdout/stderr) as well as to a file on disk. Additionally, the file on disk will be rotated after reaching 100mb and/or after a day change has been detected. <br />
<br />
 The second sink accepts only a specific channel defined by the application developer ("SampleModuleName") and writes absolutely all log messages because the severity filter is set to TRACE. This sink is useful for troubleshooting or otherwise getting deep logging for a specific module. This sink has one log writer which writes to a file. The application developer can examine this file in order to very easily see exactly what is going on in the "SampleModuleName" module. <br />
<br />
</p><div class="fragment"><div class="line">{ &quot;sinks&quot;:  [ {</div><div class="line">          &quot;channels&quot;: [ &quot;*&quot; ],</div><div class="line">         </div><div class="line">          &quot;filter&quot;: { &quot;type&quot;: &quot;Severity&quot;,</div><div class="line">                      &quot;level&quot;: &quot;INFO&quot; },</div><div class="line">                     </div><div class="line">          &quot;writers&quot;: [</div><div class="line">                       { &quot;type&quot;: &quot;Console&quot; },</div><div class="line">         </div><div class="line">                       { &quot;type&quot;: &quot;RotatingFile&quot;,</div><div class="line">                         &quot;filePattern&quot;: &quot;my_app_%Y-%m-%d_%H-%M-%S.log&quot;,</div><div class="line">                         &quot;rotationSchedule&quot;: &quot;DAILY&quot;,</div><div class="line">                         &quot;rotationSize&quot;: &quot;50mb&quot;,</div><div class="line">                         &quot;maxTotalSize&quot;: &quot;4gb&quot;,</div><div class="line">                         &quot;maxAgeSeconds&quot;: &quot;30d&quot; }</div><div class="line">                     ]</div><div class="line">        },</div><div class="line">      </div><div class="line">        {</div><div class="line">          &quot;channels&quot;: [ &quot;SampleModuleName&quot; ],</div><div class="line">         </div><div class="line">          &quot;filter&quot;: { &quot;type&quot;: &quot;Severity&quot;,</div><div class="line">                      &quot;level&quot;: &quot;TRACE&quot; },</div><div class="line">                   </div><div class="line">          &quot;writers&quot;: [</div><div class="line">                      { &quot;type&quot;: &quot;File&quot;,</div><div class="line">                        &quot;filePattern&quot;: &quot;my_app_trace_%Y-%m-%d_%H-%M-%S.log&quot; }</div><div class="line">                   ]</div><div class="line">        } ] }</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
<p>You acknowledge your access, review and use of the documentation on this page is subject to the Ionic Security Inc. <a href="https://dev.ionic.com/use.html">Documentation Use Rights</a>.</p>
<p>&copy; 2016-2018 Ionic Security Inc. All rights reserved.&nbsp;&nbsp;&nbsp;&nbsp;
Generated on Mon Jun 24 2019 10:20:14 for Agent SDK by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12</p>
</small></address>
</body>
</html>
