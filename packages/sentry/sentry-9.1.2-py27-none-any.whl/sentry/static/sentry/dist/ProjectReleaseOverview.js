(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{1604:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return s});var a=n(45);function r(e,t){return(new a.Client).requestPromise("/organizations/".concat(e,"/releases/").concat(encodeURIComponent(t),"/"),{method:"DELETE"})}function s(e){return e.reduce(function(e,t){var n=t.filename,a=t.repoName,r=t.author,s=t.type;return e.hasOwnProperty(a)||(e[a]={}),e[a].hasOwnProperty(n)||(e[a][n]={authors:{},types:new Set,repos:new Set}),e[a][n].authors[r.email]=r,e[a][n].types.add(s),e},{})}},1722:function(e,t,n){"use strict";var a=n(4),r=n.n(a),s=n(6),o=n.n(s),i=n(7),c=n.n(i),l=n(5),u=n.n(l),m=n(8),p=n.n(m),d=n(1),h=n.n(d),f=n(0),v=n.n(f),g=n(16),y=n(33),E=n(53),j=n(62),b=n(29),I=n(63),C=n(2),k=n(25),w=function(e){function t(){return r()(this,t),c()(this,u()(t).apply(this,arguments))}return p()(t,e),o()(t,[{key:"render",value:function(){var e={};return e.width=this.props.authorCommits/this.props.totalCommits*100+"%",v.a.createElement("div",{className:"commit-bar",style:e})}}]),t}(v.a.Component);w.propTypes={totalCommits:h.a.number.isRequired,authorCommits:h.a.number.isRequired};var N=function(e){function t(e){var n;return r()(this,t),(n=c()(this,u()(t).call(this,e))).state={loading:!0,error:!1},n}return p()(t,e),o()(t,[{key:"componentDidMount",value:function(){var e=this;this.props.api.request(this.getPath(),{method:"GET",success:function(t,n,a){e.setState({error:!1,loading:!1,commitList:t,pageLinks:a.getResponseHeader("Link")})},error:function(){e.setState({error:!0,loading:!1})}})}},{key:"getPath",value:function(){var e=this.props,t=e.orgId,n=e.projectId,a=e.version,r=encodeURIComponent(a);return this.props.projectId?"/projects/".concat(t,"/").concat(n,"/releases/").concat(r,"/commits/"):"/organizations/".concat(t,"/releases/").concat(r,"/commits/")}},{key:"renderEmpty",value:function(){return v.a.createElement("div",{className:"box empty"},Object(C.t)("No authors in this release"))}},{key:"render",value:function(){if(this.state.loading)return v.a.createElement(y.default,null);if(this.state.error)return v.a.createElement(E.default,null);var e=this.state.commitList,t=e.reduce(function(e,t){var n=t.author;return e.hasOwnProperty(n.email)?e[n.email].commitCount+=1:e[n.email]={commitCount:1,author:n},e},{}),n=Object.values(t);return n.sort(function(e,t){return t.commitCount-e.commitCount}),v.a.createElement("div",{style:{marginTop:5}},v.a.createElement("h6",{className:"nav-header m-b-1"},Object(C.t)("Commits by Author")),!n.length&&this.renderEmpty(),v.a.createElement(k.a,null,v.a.createElement(k.c,null,n.map(function(t,n){var a=t.author,r=t.commitCount;return v.a.createElement(k.f,{key:n,p:1,align:"center"},v.a.createElement(g.Flex,null,v.a.createElement(b.default,{title:"".concat(a.name," ").concat(a.email)},v.a.createElement(j.default,{user:a,size:20}))),v.a.createElement(g.Flex,{flex:"1",px:1},v.a.createElement(w,{style:{marginLeft:5},totalCommits:e.length,authorCommits:r})),v.a.createElement("div",null,r))}))))}}]),t}(v.a.Component);N.propTypes={api:h.a.object,orgId:h.a.string.isRequired,projectId:h.a.string,version:h.a.string.isRequired},t.a=Object(I.default)(N)},1723:function(e,t,n){"use strict";var a=n(26),r=n.n(a),s=n(4),o=n.n(s),i=n(6),c=n.n(i),l=n(7),u=n.n(l),m=n(5),p=n.n(m),d=n(8),h=n.n(d),f=n(1),v=n.n(f),g=n(0),y=n.n(g),E=n(10),j=n(9),b=n(33),I=n(53),C=n(2),k=n(56),w=n(63),N=function(e){function t(){var e,n;o()(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=u()(this,(e=p()(t)).call.apply(e,[this].concat(r)))).state={loading:!0,error:!1,stats:[],newIssueCount:null},n}return h()(t,e),c()(t,[{key:"componentDidMount",value:function(){var e=this;Promise.all([this.getStatReceived(),this.getNewIssuesCount(),n.e(106).then(n.t.bind(null,1861,7))]).then(function(t){var n=r()(t,3),a=n[0],s=n[1],o=n[2];e.setState({loading:!1,stats:a,newIssueCount:s&&s.newGroups,Sparklines:o.Sparklines,SparklinesLine:o.SparklinesLine,error:!1})},function(){e.setState({error:!0})})}},{key:"getStatReceived",value:function(){var e=this,t=this.props,n=t.api,a=t.orgId,r=this.props.project.slug,s="/projects/".concat(a,"/").concat(r,"/stats/");return n.requestPromise(s,{method:"GET",data:"stat=received",success:function(t,n,a){e.setState({stats:t}),e.getNewIssuesCount()},error:function(){e.setState({error:!0})}})}},{key:"getNewIssuesCount",value:function(){var e=this,t=this.props,n=t.api,a=t.orgId,r=t.version,s=this.props.project.slug,o="/projects/".concat(a,"/").concat(s,"/releases/").concat(encodeURIComponent(r),"/");return n.requestPromise(o,{method:"GET",success:function(t,n,a){e.setState({newIssueCount:t.newGroups,loading:!1})},error:function(){e.setState({error:!0})}})}},{key:"renderProjectSummary",value:function(){var e=this.props.project,t=this.state.newIssueCount;return y.a.createElement(y.a.Fragment,null,y.a.createElement("h6",{className:"m-b-0"},e.slug),y.a.createElement("p",{className:"m-b-0 text-muted"},y.a.createElement("small",null,t>0?Object(C.tn)("%s new issue","%s new issues",t):Object(C.t)("No new issues"))))}},{key:"render",value:function(){var e=this.props,t=e.organization,n=e.orgId,a=e.project,r=e.version;if(this.state.loading)return y.a.createElement(b.default,null);if(this.state.error)return y.a.createElement(I.default,null);var s=this.state,o=s.Sparklines,i=s.SparklinesLine,c=s.stats.map(function(e){return e[1]}),l=new Set(t.features).has("sentry10");return y.a.createElement("li",null,y.a.createElement("div",{className:"sparkline pull-right",style:{width:96}},y.a.createElement(o,{data:c,width:100,height:32},y.a.createElement(i,{style:{stroke:"#8f85d4",fill:"none",strokeWidth:3}}))),l?y.a.createElement("div",null,this.renderProjectSummary()):y.a.createElement(E.Link,{to:"/".concat(n,"/").concat(a.slug,"/releases/").concat(encodeURIComponent(r),"/")},this.renderProjectSummary()))}}]),t}(y.a.Component);N.propTypes={api:v.a.object.isRequired,organization:j.default.Organization,orgId:v.a.string,project:v.a.object,version:v.a.string},t.a=Object(k.a)(Object(w.default)(N))},1724:function(e,t,n){"use strict";n.d(t,"a",function(){return b});var a=n(4),r=n.n(a),s=n(6),o=n.n(s),i=n(7),c=n.n(i),l=n(5),u=n.n(l),m=n(8),p=n.n(m),d=n(0),h=n.n(d),f=n(1),v=n.n(f),g=n(23),y=n(68),E=n(61),j=n(2),b=function(e){function t(){return r()(this,t),c()(this,u()(t).apply(this,arguments))}return p()(t,e),o()(t,[{key:"getBasePath",value:function(){var e=this.props,t=e.orgId,n=e.projectId;return n?"/".concat(t,"/").concat(n,"/"):"/organizations/".concat(t,"/issues/")}},{key:"renderEmpty",value:function(){return h.a.createElement("div",{className:"box empty"},Object(j.t)("None"))}},{key:"render",value:function(){var e=this,t=this.props,n=t.deploys,a=t.version;return h.a.createElement(h.a.Fragment,null,h.a.createElement("h6",{className:"nav-header m-b-1"},Object(j.t)("Deploys")),h.a.createElement("ul",{className:"nav nav-stacked"},n.length?n.map(function(t){var n="".concat(e.getBasePath(),"?query=release:").concat(a,"&environment=").concat(encodeURIComponent(t.environment));return h.a.createElement("li",{key:t.id},h.a.createElement(E.a,{to:n,title:Object(j.t)("View in stream")},h.a.createElement("div",{className:"row row-flex row-center-vertically"},h.a.createElement("div",{className:"col-xs-6"},h.a.createElement("span",{className:"repo-label",style:{verticalAlign:"bottom"}},t.environment,h.a.createElement(g.default,{src:"icon-open",style:{marginLeft:6}}))),h.a.createElement("div",{className:"col-xs-6 align-right"},h.a.createElement("small",null,h.a.createElement(y.default,{date:t.dateFinished}))))))}):this.renderEmpty()))}}]),t}(h.a.Component);b.propTypes={deploys:v.a.array.isRequired,version:v.a.string.isRequired,orgId:v.a.string.isRequired,projectId:v.a.string}},1725:function(e,t,n){"use strict";var a=n(4),r=n.n(a),s=n(6),o=n.n(s),i=n(7),c=n.n(i),l=n(5),u=n.n(l),m=n(8),p=n.n(m),d=n(0),h=n.n(d),f=n(3),v=n(15),g=n(24),y=n(488),E=n(811),j=n(9),b=n(2),I=n(56),C=function(e){function t(){return r()(this,t),c()(this,u()(t).apply(this,arguments))}return p()(t,e),o()(t,[{key:"render",value:function(){return h.a.createElement(k,{centered:!0},h.a.createElement(y.a,{src:"icon-commit"}),h.a.createElement("h5",null,Object(b.t)("Releases are better with commit data!")),h.a.createElement("p",null,Object(b.t)("Connect a repository to see commit info, files changed, and authors\n                  involved in future releases"),"."),h.a.createElement(g.default,{priority:"primary",href:"/organizations/".concat(this.props.organization.slug,"/repos/")},Object(b.t)("Connect a repository")))}}]),t}(h.a.Component);C.propTypes={organization:j.default.Organization};var k=Object(f.default)(E.default,{target:"ecm6yd60"})("margin-top:",Object(v.default)(4),";padding-top:",Object(v.default)(2),";padding-bottom:",Object(v.default)(4),";");t.a=Object(I.a)(C)},1726:function(e,t,n){"use strict";n.d(t,"a",function(){return k});var a=n(12),r=n.n(a),s=n(4),o=n.n(s),i=n(6),c=n.n(i),l=n(7),u=n.n(l),m=n(5),p=n.n(m),d=n(8),h=n.n(d),f=n(0),v=n.n(f),g=n(1),y=n.n(g),E=n(3),j=n(597),b=n(25),I=n(15),C=n(2),k=function(e){function t(){return o()(this,t),u()(this,p()(t).apply(this,arguments))}return h()(t,e),c()(t,[{key:"getResolvedPath",value:function(){var e=this.props,t=e.version,n=e.orgId,a=e.projectId;return a?"/projects/".concat(n,"/").concat(a,"/releases/").concat(encodeURIComponent(t),"/resolved/"):"/organizations/".concat(n,"/releases/").concat(encodeURIComponent(t),"/resolved/")}},{key:"getIssuesPath",value:function(){var e=this.props,t=e.orgId,n=e.projectId;return n?"/projects/".concat(t,"/").concat(n,"/issues/"):"/organizations/".concat(t,"/issues/")}},{key:"render",value:function(){var e=this.props,t=e.version,n=e.orgId,a=e.query;return v.a.createElement(v.a.Fragment,null,v.a.createElement("h5",null,Object(C.t)("Issues Resolved in this Release")),v.a.createElement(w,{endpoint:this.getResolvedPath(),query:a,pagination:!1,renderEmpty:function(){return v.a.createElement(b.a,null,v.a.createElement(b.c,null,v.a.createElement(b.f,{justify:"center"},Object(C.t)("No issues resolved"))))},showActions:!1,params:{orgId:n}}),v.a.createElement("h5",null,Object(C.t)("New Issues in this Release")),v.a.createElement(w,{endpoint:this.getIssuesPath(),query:r()({},a,{query:'first-release:"'+t+'"',limit:5}),statsPeriod:"0",pagination:!1,renderEmpty:function(){return v.a.createElement(b.a,null,v.a.createElement(b.c,null,v.a.createElement(b.f,{justify:"center"},Object(C.t)("No new issues"))))},showActions:!1,params:{orgId:n}}))}}]),t}(v.a.Component);k.propTypes={query:y.a.object.isRequired,version:y.a.string.isRequired,orgId:y.a.string.isRequired,projectId:y.a.string};var w=Object(E.default)(j.a,{target:"e1xme6vx0"})("margin-bottom:",Object(I.default)(2),";")},1729:function(e,t,n){"use strict";var a=n(4),r=n.n(a),s=n(6),o=n.n(s),i=n(7),c=n.n(i),l=n(5),u=n.n(l),m=n(8),p=n.n(m),d=n(1),h=n.n(d),f=n(0),v=n.n(f),g=n(62),y=n(29),E=n(23),j=function(e){function t(e){var n;return r()(this,t),(n=c()(this,u()(t).call(this,e))).state={loading:!0},n}return p()(t,e),o()(t,[{key:"render",value:function(){var e=this.props,t=e.filename,n=e.authors;return v.a.createElement("li",{className:"list-group-item list-group-item-sm release-file-change"},v.a.createElement("div",{className:"row row-flex row-center-vertically"},v.a.createElement("div",{className:"col-sm-10 truncate file-name"},v.a.createElement(E.default,{src:"icon-file",className:"icon-file-generic",size:"15"}),t),v.a.createElement("div",{className:"col-sm-2 avatar-grid align-right"},n.map(function(e,t){return v.a.createElement(y.default,{key:t,title:"".concat(e.name," ").concat(e.email)},v.a.createElement("span",{className:"avatar-grid-item m-b-0"},v.a.createElement(g.default,{user:e})))}))))}}]),t}(v.a.PureComponent);j.propTypes={filename:h.a.string.isRequired,authors:h.a.array.isRequired};var b=j,I=n(2);function C(e){return v.a.createElement("li",{className:"list-group-item list-group-item-sm align-center"},v.a.createElement("span",{className:"icon-container"}),v.a.createElement("a",{onClick:e.onClick},Object(I.tn)("Show %s collapsed file","Show %s collapsed files",e.count)))}C.propTypes={onClick:h.a.func.isRequired,count:h.a.number.isRequired};var k=function(e){function t(){var e,n;r()(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(n=c()(this,(e=u()(t)).call.apply(e,[this].concat(s)))).onCollapseToggle=function(){n.setState({collapsed:!n.state.collapsed})},n.state={loading:!0,collapsed:!0},n}return p()(t,e),o()(t,[{key:"render",value:function(){var e=this.props,n=e.repository,a=e.fileChangeSummary,r=t.MAX_WHEN_COLLAPSED,s=Object.keys(a),o=s.length;s.sort(),this.state.collapsed&&o>r&&(s=s.slice(0,r));var i=o-s.length,c=o>r;return v.a.createElement("div",null,v.a.createElement("h5",null,Object(I.tn)("%s file changed in "+n,"%s files changed in "+n,o)),v.a.createElement("ul",{className:"list-group list-group-striped m-b-2"},s.map(function(e){var t=a[e],n=t.authors,r=t.types;return v.a.createElement(b,{key:e,filename:e,authors:Object.values(n),types:r})}),i>0&&v.a.createElement(C,{onClick:this.onCollapseToggle,count:i}),0===i&&c&&v.a.createElement("li",{className:"list-group-item list-group-item-sm align-center"},v.a.createElement("span",{className:"icon-container"}),v.a.createElement("a",{onClick:this.onCollapseToggle},Object(I.t)("Collapse")))))}}]),t}(v.a.Component);k.propTypes={fileChangeSummary:h.a.object,repository:h.a.string},k.MAX_WHEN_COLLAPSED=5;t.a=k},2340:function(e,t,n){"use strict";n.r(t);var a=n(12),r=n.n(a),s=n(1),o=n.n(s),i=n(0),c=n.n(i),l=n(17),u=n.n(l),m=n(189),p=n(33),d=n(53),h=n(612),f=n(1722),v=n(1723),g=n(1729),y=n(37),E=n(2),j=n(9),b=n(66),I=n(1604),C=n(1724),k=n(1725),w=n(1726),N=u()({displayName:"ReleaseOverview",propTypes:{environment:j.default.Environment},contextTypes:{release:o.a.object},mixins:[y.default,b.a],getInitialState:function(){return{loading:!0,error:!1,projects:[],fileList:[],deploys:[],hasRepos:!1}},componentDidMount:function(){this.fetchAll()},componentDidUpdate:function(e){e.environment!==this.props.environment&&this.fetchAll()},fetchAll:function(){var e=this,t=this.props.params,n=t.orgId,a=t.version,s=r()({},this.props.location.query);this.props.environment?s.environment=this.props.environment.name:delete s.environment;var o="/organizations/".concat(n,"/releases/").concat(encodeURIComponent(a),"/commitfiles/");this.api.request(o,{method:"GET",data:s,success:function(t,n,a){e.setState({fileList:t})},error:function(){e.setState({error:!0})}}),this.getReleaseProjects(),this.getDeploys(),this.getRepos()},getReleaseProjects:function(){var e=this,t=this.props.params,n=t.orgId,a=t.version,r=this.props.environment?{environment:this.props.environment.name}:{},s="/organizations/".concat(n,"/releases/").concat(encodeURIComponent(a),"/");this.api.request(s,{query:r,method:"GET",success:function(t,n,a){e.setState({projects:t.projects})},error:function(){e.setState({error:!0})}})},getDeploys:function(){var e=this,t=this.props.params,n=t.orgId,a=t.version,r="/organizations/".concat(n,"/releases/").concat(encodeURIComponent(a),"/deploys/");this.api.request(r,{method:"GET",success:function(t,n,a){e.setState({deploys:t,loading:!1})},error:function(){e.setState({error:!0})}})},getRepos:function(){var e=this,t=this.props.params.orgId,n=this.props.environment?{environment:this.props.environment.name}:{},a="/organizations/".concat(t,"/repos/");this.api.request(a,{method:"GET",query:n,success:function(t,n,a){e.setState({hasRepos:t.length>0})},error:function(){e.setState({error:!0})}})},renderEmpty:function(){return c.a.createElement("div",{className:"box empty"},Object(E.t)("None"))},render:function(){var e=this.props.params,t=e.orgId,n=e.projectId,a=e.version,r=this.context.release.lastCommit;if(this.state.loading)return c.a.createElement(p.default,null);if(this.state.error)return c.a.createElement(d.default,null);var s=this.state,o=s.fileList,i=s.projects,l=s.hasRepos,u=Object(I.b)(o),m=this.props.environment?{environment:this.props.environment.name}:{};return c.a.createElement("div",null,c.a.createElement("div",{className:"row",style:{paddingTop:10}},c.a.createElement("div",{className:"col-sm-8"},c.a.createElement(w.a,{version:a,query:m,orgId:t,projectId:n}),l&&c.a.createElement("div",null,Object.keys(u).map(function(e,t){return c.a.createElement(g.a,{key:t,repository:e,fileChangeSummary:u[e]})}))),c.a.createElement("div",{className:"col-sm-4"},l?c.a.createElement("div",null,r&&c.a.createElement(h.a,{commit:r,headerClass:"nav-header"}),c.a.createElement(f.a,{orgId:t,projectId:n,version:a}),c.a.createElement("h6",{className:"nav-header m-b-1"},Object(E.t)("Other Projects Affected")),c.a.createElement("ul",{className:"nav nav-stacked"},1===i.length?this.renderEmpty():i.map(function(e){return e.slug===n?null:c.a.createElement(v.a,{key:e.id,orgId:t,project:e,version:a})}))):c.a.createElement(k.a,null),c.a.createElement(C.a,{deploys:this.state.deploys,version:a,orgId:t,projectId:n}))))}});t.default=Object(m.a)(N)}}]);
//# sourceMappingURL=ProjectReleaseOverview.js.map