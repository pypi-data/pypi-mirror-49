(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{2358:function(e,t,a){"use strict";a.r(t);var n=a(12),r=a.n(n),s=a(1),i=a.n(s),o=a(0),c=a.n(o),l=a(17),u=a.n(l),m=a(10),d=a(97),p=a.n(d),h=a(9),v=a(225),g=a(188),f=a(2),E=a(189),S=a(84),y=a.n(S),b=a(25),N=a(37),P=a(53),w=a(33),j=a(133),q=a(444),x=a(317),O=u()({displayName:"EventNode",propTypes:{group:h.default.Group.isRequired},mixins:[v.a],render:function(){var e=this.props.group,t=e.userCount;return c.a.createElement("li",{className:"group row"},c.a.createElement("div",{className:"col-xs-8 event-details"},c.a.createElement(x.a,{data:e,hideIcons:!0,hideLevel:!0}),c.a.createElement(q.a,e)),c.a.createElement("div",{className:"col-xs-2 event-count align-right"},c.a.createElement(j.default,{value:e.count})),c.a.createElement("div",{className:"col-xs-2 event-users align-right"},c.a.createElement(j.default,{value:t})))}}),D=u()({displayName:"EventList",propTypes:{type:i.a.oneOf(["new","priority"]).isRequired,environment:h.default.Environment,dateSince:i.a.number},mixins:[N.default],getInitialState:function(){return{groupList:[],loading:!0,error:!1,statsPeriod:"24h"}},componentWillMount:function(){this.fetchData()},componentWillReceiveProps:function(e){e.environment!==this.props.environment&&this.setState({loading:!0,error:!1},this.fetchData)},getEndpoint:function(){var e=this.props,t=e.params,a=e.type,n=e.environment,r={sort:a,query:"is:unresolved",since:this.props.dateSince};return n&&(r.environment=n.name,r.query="".concat(r.query," environment:").concat(n.name)),"/projects/".concat(t.orgId,"/").concat(t.projectId,"/issues/?").concat(y.a.stringify(r))},getMinutes:function(){switch(this.state.statsPeriod){case"15m":return"15";case"60m":return"60";case"24h":default:return"1440"}},fetchData:function(){var e=this,t=this.getEndpoint(),a=this.getMinutes();this.api.request(t,{query:{limit:5,minutes:a},success:function(t){e.setState({groupList:t,loading:!1,error:!1})},error:function(){e.setState({loading:!1,error:!0})}})},onSelectStatsPeriod:function(e){this.setState({statsPeriod:e})},render:function(){var e=this.state.groupList.map(function(e){return c.a.createElement(O,{group:e,key:e.id})}),t=this.props.environment,a=t?Object(f.tct)("No data available in the [env] environment.",{env:t.displayName}):Object(f.t)("No data available.");return c.a.createElement(b.a,null,c.a.createElement(b.e,null,c.a.createElement("div",{className:"row",style:{flex:1}},c.a.createElement("div",{className:"col-xs-8"},"new"===this.props.type?Object(f.t)("New issues"):Object(f.t)("Trending issues")),c.a.createElement("div",{className:"col-xs-2 align-right"},Object(f.t)("Events")),c.a.createElement("div",{className:"col-xs-2 align-right"},Object(f.t)("Users")))),c.a.createElement(b.c,null,c.a.createElement("div",{className:"tab-pane active"},this.state.loading?c.a.createElement(w.default,null):this.state.error?c.a.createElement(P.default,{onRetry:this.fetchData}):e.length?c.a.createElement("ul",{className:"group-list group-list-small"},e):c.a.createElement("div",{className:"group-list-empty"},a))))}}),L=a(3),R=a(46),T=a.n(R),k=a(347),I=a(275),C=u()({displayName:"ProjectChart",propTypes:{dateSince:i.a.number.isRequired,resolution:i.a.string.isRequired,environment:h.default.Environment},mixins:[N.default,v.a],getInitialState:function(){return{loading:!0,error:!1,stats:[],releaseList:[],environment:this.props.environment}},componentWillMount:function(){this.fetchData()},componentWillReceiveProps:function(e){e.environment===this.props.environment&&e.resolution===this.props.resolution&&e.dateSince===this.props.dateSince||this.setState({environment:e.environment,loading:!0,error:!1},this.fetchData)},getStatsEndpoint:function(){var e=this.getOrganization(),t=this.getProject();return"/projects/"+e.slug+"/"+t.slug+"/stats/"},getProjectReleasesEndpoint:function(){var e=this.getOrganization(),t=this.getProject();return"/projects/"+e.slug+"/"+t.slug+"/releases/"},fetchData:function(){var e=this,t={since:this.props.dateSince,resolution:this.props.resolution,stat:"generated"},a={};this.state.environment&&(t.environment=this.state.environment.name,a.environment=this.state.environment.name),this.api.request(this.getStatsEndpoint(),{query:t,success:function(t){e.setState({stats:t,error:!1,loading:!1})},error:function(){e.setState({error:!0,loading:!1})}}),this.api.request(this.getProjectReleasesEndpoint(),{query:a,success:function(t,a,n){e.setState({releaseList:t})}})},renderChart:function(){var e=this.state.stats.map(function(e){return{x:e[0],y:e[1]}}),t=this.props.dateSince,a=this.state.releaseList.filter(function(e){return new Date(e.dateCreated).getTime()/1e3>=t}).map(function(e){return{label:"Version "+e.shortVersion,x:new Date(e.dateCreated).getTime()/1e3}});return c.a.createElement("div",{className:"chart-wrapper"},c.a.createElement(M,{points:e,markers:a,label:"events",height:150,gap:.2,className:"standard-barchart"}),c.a.createElement("small",{className:"date-legend"},c.a.createElement(I.default,{fixed:"Test Date 1, 2000",value:T()(1e3*this.props.dateSince).format("LL")})))},render:function(){return this.state.loading?c.a.createElement(w.default,null):this.state.error?c.a.createElement(P.default,{onRetry:this.fetchData}):this.renderChart()}}),M=Object(L.default)(k.default,{target:"ekchx3s0"})("background:#fff;"),W=C,z=new Set(["1h","1d","1w"]),B=u()({displayName:"ProjectDashboard",propTypes:{defaultStatsPeriod:i.a.string,setProjectNavSection:i.a.func,environment:h.default.Environment},mixins:[v.a],getDefaultProps:function(){return{defaultStatsPeriod:"1d"}},getInitialState:function(){return r()({statsPeriod:this.props.defaultStatsPeriod},this.getQueryStringState())},componentWillMount:function(){this.props.setProjectNavSection("dashboard")},componentWillReceiveProps:function(e){this.setState(this.getQueryStringState(e))},getQueryStringState:function(e){var t=(e=e||this.props).location.query.statsPeriod;return z.has(t)||(t=e.defaultStatsPeriod),{statsPeriod:t}},getStatsPeriodBeginTimestamp:function(e){var t=(new Date).getTime()/1e3;switch(e){case"1w":return t-604800;case"1h":return t-3600;case"1d":default:return t-86400}},getStatsPeriodResolution:function(e){switch(e){case"1w":return"1h";case"1h":return"10s";case"1d":default:return"1h"}},render:function(){var e=this.state.statsPeriod,t=this.getStatsPeriodBeginTimestamp(e),a=this.getStatsPeriodResolution(e),n=this.props.params,s=n.orgId,i=n.projectId,o=this.getOrganization().name,l=this.getProject().slug,u="/".concat(s,"/").concat(i,"/dashboard/"),d=this.props.location.query;return c.a.createElement(p.a,{title:"Overview - ".concat(l," - ").concat(o," - Sentry")},c.a.createElement("div",null,c.a.createElement("div",{className:"row",style:{marginBottom:"5px"}},c.a.createElement("div",{className:"col-sm-9"},c.a.createElement(g.a,{withMargins:!0},Object(f.t)("Overview"))),c.a.createElement("div",{className:"col-sm-3",style:{textAlign:"right",marginTop:"4px"}},c.a.createElement("div",{className:"btn-group"},c.a.createElement(m.Link,{to:{pathname:u,query:r()({},d,{statsPeriod:"1h"})},className:"btn btn-sm btn-default"+("1h"===e?" active":"")},Object(f.t)("1 hour")),c.a.createElement(m.Link,{to:{pathname:u,query:r()({},d,{statsPeriod:"1d"})},className:"btn btn-sm btn-default"+("1d"===e?" active":"")},Object(f.t)("1 day")),c.a.createElement(m.Link,{to:{pathname:u,query:r()({},d,{statsPeriod:"1w"})},className:"btn btn-sm btn-default"+("1w"===e?" active":"")},Object(f.t)("1 week"))))),c.a.createElement(W,{dateSince:t,resolution:a,environment:this.props.environment}),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-md-6"},c.a.createElement(D,{type:"priority",environment:this.props.environment,dateSince:t,params:this.props.params})),c.a.createElement("div",{className:"col-md-6"},c.a.createElement(D,{type:"new",environment:this.props.environment,dateSince:t,params:this.props.params})))))}});t.default=Object(E.a)(B)}}]);
//# sourceMappingURL=ProjectDashboard.js.map