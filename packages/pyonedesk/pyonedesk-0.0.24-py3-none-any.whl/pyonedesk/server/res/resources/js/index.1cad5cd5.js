(function(e){function t(t){for(var i,o,s=t[0],l=t[1],c=t[2],d=0,f=[];d<s.length;d++)o=s[d],r[o]&&f.push(r[o][0]),r[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);u&&u(t);while(f.length)f.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,s=1;s<n.length;s++){var l=n[s];0!==r[l]&&(i=!1)}i&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var i={},r={index:0},a=[];function o(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("df31")},"01bd":function(e,t,n){"use strict";var i=n("b954"),r=n.n(i);r.a},"0372":function(e,t,n){"use strict";var i=n("18e4"),r=n.n(i);r.a},"0997":function(e,t,n){},"18e4":function(e,t,n){},2162:function(e,t,n){},"27f5":function(e,t,n){"use strict";var i=n("3a2d"),r=n.n(i);r.a},2824:function(e,t,n){},"3a2d":function(e,t,n){},4230:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i="/admin/api",r={accountsList:i+"/accounts",createAccountID:i+"/account/create_id",addAccount:i+"/accounts/add",addAccountName:i+"/accounts/add",deleteAccount:i+"/accounts/delete",account:i+"/account",goCreateAppUrl:i+"/go_create_app",goGetCode:i+"/go_get_code",stylizes:i+"/stylizes",uploadFile:i+"/upload",createFolder:i+"/create_folder"}},4235:function(e,t,n){"use strict";var i=n("873f"),r=n.n(i);r.a},"486c":function(e,t,n){"use strict";var i=n("92e0"),r=n.n(i);r.a},"500d":function(e,t,n){"use strict";var i=n("e655"),r=n.n(i);r.a},"815f":function(e,t,n){},"873f":function(e,t,n){},"8d27":function(e,t,n){},"908b":function(e,t,n){"use strict";var i=n("8d27"),r=n.n(i);r.a},"92e0":function(e,t,n){},"9af5":function(e,t,n){"use strict";var i=n("2824"),r=n.n(i);r.a},"9af9":function(e,t,n){"use strict";var i=n("2162"),r=n.n(i);r.a},ae02:function(e,t,n){"use strict";var i=n("bf26"),r=n.n(i);r.a},b82e:function(e,t,n){"use strict";var i=n("d7b8"),r=n.n(i);r.a},b954:function(e,t,n){},bbbe:function(e,t,n){"use strict";var i=n("0997"),r=n.n(i);r.a},bf26:function(e,t,n){},d7b8:function(e,t,n){},dd79:function(e,t,n){"use strict";var i=n("815f"),r=n.n(i);r.a},df31:function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var i=n("a026"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"desktop full",on:{dragover:function(e){e.preventDefault()},drop:function(e){e.preventDefault()}}},[n("settings"),0===e.users.length?n("empty-user-tips"):e._e(),e._l(e.users,function(e){return n("user-icon",{key:e.id,attrs:{user:e}})}),e._l(e.windows,function(e){return n("window",{key:e.id,attrs:{id:e.id,user:e.user,file:e.file,z:e.z,uploads:e.uploads}})}),n("contextmenu",{attrs:{x:e.menu.x,y:e.menu.y,file:e.menu.file,id:e.menu.id},model:{value:e.menu.show,callback:function(t){e.$set(e.menu,"show",t)},expression:"menu.show"}})],2)},a=[],o=(n("7f7f"),n("ac6a"),n("8615"),n("96cf"),n("3b8d")),s="",l={accounts:s+"/accounts",loadFile:s+"/path"},c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"window",class:{active:e.$store.state.activeID===e.id,dragging:e.dragging,loading:e.loading},style:{"z-index":e.z},attrs:{tabindex:e.z},on:{focus:e.focus,blur:e.blur}},[n("div",{staticClass:"window--head"},[n("div",{staticClass:"name"},[e._v(" "+e._s(e.current.name))]),n("div",{staticClass:"controller",staticStyle:{"margin-right":"10px"}},[n("svg",{staticClass:"icon",class:{disabled:e.loading},attrs:{"aria-hidden":"true"},on:{click:function(t){return e.load(!0)}}},[n("use",{attrs:{"xlink:href":"#py_shuaxin"}})]),n("svg",{staticClass:"icon",class:{disabled:e.loading||e.historyIndex<=0},attrs:{"aria-hidden":"true"},on:{click:function(t){return e.go()}}},[n("use",{attrs:{"xlink:href":"#py_houtui"}})]),n("svg",{staticClass:"icon",class:{disabled:e.loading||e.historyIndex>=e.history.length-1},attrs:{"aria-hidden":"true"},on:{click:function(t){return e.go(1)}}},[n("use",{attrs:{"xlink:href":"#py_qianjin"}})])]),n("div",{staticClass:"controller"},[n("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"},on:{click:e.close}},[n("use",{attrs:{"xlink:href":"#py_guanbi"}})])])]),n("div",{staticClass:"window--path"},[n("el-breadcrumb",{staticClass:"path",attrs:{separator:"/"}},[n("el-breadcrumb-item"),e._l(e.path,function(t,i){return n("el-breadcrumb-item",{key:i},[n("a",{on:{click:function(t){e.go(-(e.path.length-i-1))}}},[e._v(e._s(t))])])})],2),!1===e.loading&&e.showFolder?n("div",{staticClass:"controller"},[n("el-dropdown",{attrs:{size:"mini",trigger:"click"},on:{command:e.create}},[n("span",{staticClass:"el-dropdown-link"},[e._v("\n                创建"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"folder"}},[e._v("文件夹")]),n("el-dropdown-item",{attrs:{divided:""}}),n("el-dropdown-item",{attrs:{command:"text"}},[e._v("文本文件")])],1)],1),n("div",{on:{click:function(t){return e.upload("file")}}},[n("svg",{staticClass:"icon",class:{disabled:e.loading},attrs:{"aria-hidden":"true"}},[n("use",{attrs:{"xlink:href":"#py_shangchuan1"}})]),e._v("\n                文件\n            ")]),n("div",{on:{click:function(t){return e.upload("folder")}}},[n("svg",{staticClass:"icon",class:{disabled:e.loading},attrs:{"aria-hidden":"true"}},[n("use",{attrs:{"xlink:href":"#py_shangchuan1"}})]),e._v("\n                文件夹\n            ")])],1):e._e()],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.dragging,expression:"!dragging"}],staticClass:"window--body",class:{loading:e.loading}},[e.loading?n("window-loading"):e._e(),e.error?n("window-error",{attrs:{error:e.error}}):e._e(),[e.showFolder?[n("window-folder",{ref:"content",attrs:{id:e.id,user:e.user,file:e.current},on:{open:e.open,loadFinish:e.loadFinish,loadError:e.loadError}})]:e.showEditor?[n("window-editor",{ref:"content",attrs:{id:e.id,user:e.user,file:e.current},on:{loadFinish:e.loadFinish,loadError:e.loadError}})]:e.showViewer?[n("window-viewer",{ref:"content",attrs:{id:e.id,user:e.user,file:e.current},on:{loadFinish:e.loadFinish,loadError:e.loadError}})]:e.showPlayer?[n("window-player",{ref:"content",attrs:{id:e.id,user:e.user,file:e.current},on:{loadFinish:e.loadFinish,loadError:e.loadError}})]:[n("window-binary-file",{ref:"content",attrs:{id:e.id,user:e.user,file:e.current},on:{loadFinish:e.loadFinish,loadError:e.loadError}})]]],2)])},u=[],d=(n("7514"),n("c5f6"),n("a481"),n("d225")),f=n("b0b4"),h=(n("ac4d"),n("8a81"),n("0d6d"),n("2ef0")),p=Object.freeze({Normal:Symbol("normal"),Image:Symbol("image"),Audio:Symbol("audio"),Video:Symbol("video"),Text:Symbol("text"),Code:Symbol("code"),Word:Symbol("word"),Excel:Symbol("excel"),PPT:Symbol("ppt"),Zip:Symbol("zip"),Folder:Symbol("folder"),PDF:Symbol("pdf")}),m=Object.freeze({Normal:Symbol("normal"),Uploading:Symbol("uploading"),Waiting:Symbol("waiting"),Deleting:Symbol("deleting"),UploadFail:Symbol("uploadFail")}),v=["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],g=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],w=["application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation"],y=["application/zip","application/x-7z-compressed","application/x-rar-compressed","application/x-tar","application/x-bzip","application/x-bzip2"];function b(e,t){console.log("fileNameToType",e);for(var n=0;n<t.length;n++)if(-1!==e.lastIndexOf(t[n]))return!0;return!1}var x=[".py",".cs",".c",".htm",".js",".xml",".php",".jsp",".rb",".pl",".asp",".ini",".cg",".java",".as",".config",".hh",".hs",".css",".scss",".sass"],_=function(){function e(t,n,i){Object(d["a"])(this,e),this.name=t,this.mimeType=i,this.path=n.replace(/\/+/g,"/"),this.thumbnail=null,this.id=null}return Object(f["a"])(e,[{key:"setType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?this.type=e:this.mimeType?-1!==this.mimeType.indexOf("image/")?this.type=p.Image:-1!==this.mimeType.indexOf("audio/")?this.type=p.Audio:-1!==this.mimeType.indexOf("video/")?this.type=p.Video:b(this.name,x)?this.type=p.Code:-1!==v.indexOf(this.mimeType)?this.type=p.Word:-1!==g.indexOf(this.mimeType)?this.type=p.Excel:-1!==w.indexOf(this.mimeType)?this.type=p.PPT:-1!==y.indexOf(this.mimeType)?this.type=p.Zip:"text/plain"===this.mimeType?this.type=p.Text:"application/pdf"===this.mimeType?this.type=p.PDF:this.type=p.Normal:this.type=p.Folder,this}},{key:"setFromData",value:function(e){var t=Object(h["get"])(e,"thumbnails[0].small.url");return t&&(this.thumbnail=t),this.id=e.id,this.mimeType=Object(h["get"])(e,"file.mimeType"),e["parentReference"]&&(this.path="/drive/root:"===e["parentReference"]["path"]?"/":e["parentReference"]["path"].replace("/drive/root:","/")),this}},{key:"setState",value:function(e){return this.state=e,this}}]),e}(),C=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(d["a"])(this,e),this.id=t,this.name=n,this.lock=i},k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"text-editor-container"},[n("div",{staticClass:"text-editor"}),n("div",{staticClass:"saving",class:{show:e.saving}},[e._v("保存中")])])},F=[],j=(n("4917"),n("6b54"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div")}),O=[],E={name:"window-base-content",data:function(){return{loading:!1}},methods:{load:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]&&n[0],!this.loading){e.next=3;break}return e.abrupt("return");case 3:if(this.loading=!0,!this.loadContent){e.next=7;break}return e.next=7,this.loadContent(t);case 7:this.loading=!1,this.$emit("loadFinish");case 9:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},mounted:function(){this.load()}},I=E,U=n("2877"),T=Object(U["a"])(I,j,O,!1,null,"05f4ddb7",null),D=T.exports,S=n("df7c"),P={extends:D,name:"window-editor",props:["id","user","file"],data:function(){return{$cm:null,saving:!1}},methods:{loadContent:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n,i,r,a,o,s,l,c,u,d=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]&&d[0],n=":"+Object(S["join"])(this.file.path,this.file.name),e.next=4,this.$store.dispatch("load",{force:t,user:this.user,path:n});case 4:return i=e.sent,r=i.data,e.next=8,this.$http.get(r["@microsoft.graph.downloadUrl"]);case 8:a=e.sent,o=a.data,this.$cm.setValue(o.toString()),s=this.file.name.match(/.+\.([^.]+)$/),console.log("editor 1",s),s&&(u=CodeMirror.findModeByExtension(s[1]),u&&(l=u.mode,c=u.mime)),console.log("editor 2",l,c),l?(this.$cm.setOption("mode",c),CodeMirror.autoLoadMode(this.$cm,l)):this.$cm.setOption("mode","text/plain");case 16:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),deleteCache:function(){this.$store.commit("deleteCache",{user:this.user,path:":"+this.file.path})},save:function(){var e=this;this.loading||this.saving||(this.saving=!0,this.$http({method:"post",url:"/admin/api/upload/"+this.user.id,params:{path:Object(S["join"])(this.file.path,this.file.name),type:"text"},data:this.$cm.getValue()}).then(function(){e.deleteCache()}).catch(function(t){e.$notify.error("".concat(e.file.name," 保存失败：").concat(t.response.data))}).finally(function(){e.saving=!1}))}},mounted:function(){CodeMirror.modeURL="https://cdn.bootcss.com/codemirror/5.48.0/mode/%N/%N.js",this.$cm=CodeMirror(this.$el.querySelector(".text-editor"),{lineNumbers:!0,extraKeys:{"Ctrl-S":this.save,"Cmd-S":this.save}})}},W=P,z=(n("0372"),Object(U["a"])(W,k,F,!1,null,null,null)),R=z.exports,L=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"image-viewer"},[e.loading?e._e():n("img",{attrs:{src:e.src,alt:"图片"}})])},N=[],M={extends:D,name:"window-viewer",props:["user","file"],data:function(){return{src:""}},methods:{loadContent:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n,i,r,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=":"+this.file.path+"/"+this.file.name,e.next=3,this.$store.dispatch("load",{user:this.user,path:n,force:t});case 3:return i=e.sent,r=i.data,this.src=r["@microsoft.graph.downloadUrl"],a=new Image,a.src=this.src,e.next=10,new Promise(function(e){a.addEventListener("load",function(){e()}),setTimeout(function(){e()},1e4)});case 10:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()}},A=M,V=(n("ae02"),Object(U["a"])(A,L,N,!1,null,"745f9efc",null)),Q=V.exports,q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"player"})},B=[],X={extends:D,name:"window-player",props:["user","file"],data:function(){return{}},methods:{loadContent:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n,i,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log("player mounted"),n=":"+Object(S["join"])(this.file.path,this.file.name),e.next=4,this.$store.dispatch("load",{user:this.user,path:n,force:t});case 4:i=e.sent,r=i.data,console.log("player",n,r),new DPlayer({container:this.$el,video:{url:r["@microsoft.graph.downloadUrl"]}});case 8:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},mounted:function(){this.load()}},Y=X,Z=(n("dd79"),Object(U["a"])(Y,q,B,!1,null,"0380c364",null)),J=Z.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"folder-container",on:{dragenter:function(t){return t.preventDefault(),e.dragEnter(t)},dragover:function(e){e.preventDefault()},drop:function(t){return t.preventDefault(),e.dropFile(t)},paste:function(t){return t.preventDefault(),e.paste(t)}}},[e.isDragEnter?n("div",{ref:"dragLeave",staticClass:"upload-icon",on:{dragleave:function(t){return t.preventDefault(),e.dragLeave(t)}}},[n("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[n("use",{attrs:{"data-v-093dcf52":"","xlink:href":"#py_shangchuan1"}})]),e._m(0)]):e._e(),n("div",{staticClass:"folder"},e._l(e.files,function(t,i){return n("file-view",{key:i,attrs:{parent:e.file,file:t,id:e.id},on:{dblclick:e.open}})}),1),e.nextPage?n("div",{staticClass:"next-page"},[n("el-button",{attrs:{type:"text",loading:e.loading},on:{click:e.loadNextPage}},[e._v("加载更多")])],1):e._e(),e.uploading.length>0?n("div",{staticClass:"top-border"},[n("div",{staticClass:"header"},[n("span",[e._v("上传中，同时上传："+e._s(e.queueConcurrency))]),n("el-button",{attrs:{type:"text"},on:{click:function(t){e.$store.state.settings=!0}}},[e._v("设置")])],1),n("div",{staticClass:"folder"},e._l(e.uploading,function(t,i){return n("file-view",{key:i,attrs:{parent:e.file,file:t.file,id:e.id}})}),1)]):e._e(),e.uploadFails.length>0?n("div",{staticClass:"top-border"},[n("div",{staticClass:"header"},[e._v("上传失败\n            "),n("el-button",{attrs:{type:"text"},on:{click:e.clearUploadFail}},[e._v("清空")])],1),n("div",{staticClass:"folder"},e._l(e.uploadFails,function(t,i){return n("file-view",{key:i,attrs:{parent:e.file,file:t.file,id:e.id}})}),1)]):e._e(),e.waiting.length>0?n("div",{staticClass:"top-border"},[n("div",{staticClass:"header"},[e._v("等候上传\n            "),n("el-button",{attrs:{type:"text"},on:{click:e.clearWaiting}},[e._v("全部取消")])],1),n("div",{staticClass:"folder"},e._l(e.waiting,function(t,i){return n("file-view",{key:i,attrs:{parent:e.file,file:t.file,id:e.id}})}),1)]):e._e(),n("input",{ref:"fileInput",staticClass:"hidden-file-input",staticStyle:{display:"none"},attrs:{type:"file",multiple:""},on:{change:e.selectUploadFiles}})])},H=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._v("\n            将文件 / 文件夹 上传到这个目录"),n("br")])}],K=n("75fc"),ee=(n("28a5"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"file",on:{dblclick:e.open,contextmenu:function(t){return t.preventDefault(),e.contextmenu(t)},click:e.click}},[n("div",{staticClass:"file-icon",class:{uploading:e.isUploading||e.isWaiting}},[e.image?n("img",{attrs:{src:e.file.thumbnail,alt:"图片"}}):n("file-icon",{attrs:{file:e.file}}),!1===e.isNormal?n("div",{staticClass:"state-icon-container"},[e.isUploading?n("div",[n("svg",{staticClass:"icon state-icon",attrs:{"aria-hidden":"true"}},[n("use",{attrs:{"xlink:href":"#py_shangchuan"}})]),n("div",[e._v("上传中")])]):e.isWaiting?n("div",[n("svg",{staticClass:"icon state-icon",attrs:{"aria-hidden":"true"}},[n("use",{attrs:{"xlink:href":"#py_yuyue-lishi-shijian"}})]),n("div",[e._v("等待上传")])]):e._e()]):e._e()],1),n("div",{staticClass:"file-name"},[n("div",{staticClass:"file-name__ellipsis"},[e._v(e._s(e.file.name))]),n("div",{staticClass:"file-name__full"},[e._v(e._s(e.file.name))])])])}),te=[],ne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{staticClass:"icon file-icon",attrs:{"aria-hidden":"true"}},[n("use",{attrs:{"xlink:href":"#"+e.icon}})])},ie=[],re={name:"file-icon",props:["file"],computed:{icon:function(){switch(this.file.type){case p.Folder:return Icons["folder"];case p.Audio:return Icons["audio"];case p.Video:return Icons["video"];case p.Image:return Icons["image"];case p.Text:return Icons["text"];case p.Zip:return Icons["zip"];case p.PDF:return Icons["pdf"];case p.Word:return Icons["word"];case p.Excel:return Icons["excel"];case p.PPT:return Icons["ppt"];case p.Code:return Icons["code"];default:return Icons["default"]}}}},ae=re,oe=Object(U["a"])(ae,ne,ie,!1,null,"3705e7de",null),se=oe.exports,le={components:{FileIcon:se},props:{id:String,parent:_,file:_},data:function(){return{image:null}},computed:{isNormal:function(){return this.file.state===m.Normal},isUploading:function(){return this.file.state===m.Uploading},isWaiting:function(){return this.file.state===m.Waiting},isUploadFail:function(){return this.file.state===m.UploadFail}},methods:{open:function(){console.log("open",this.file),this.file.state===m.Normal&&this.$emit("dblclick",this.file)},contextmenu:function(e){(this.isWaiting||this.isUploading)&&this.$store.commit("appendMenuItem",{name:"取消上传",click:this.click}),this.$store.commit("contextmenu",{e:e,id:this.id,file:this.file})},click:function(){var e=this;if(!this.isNormal&&!this.isUploading)if(console.log("file click",{isWaiting:this.isWaiting,isUploadFail:this.isUploadFail}),this.isWaiting)this.$confirm("取消上传 ".concat(this.file.name," ？")).then(function(){e.$store.commit("cancelUploadFile",e.file)}).catch(function(){});else if(this.isUploadFail){var t=this.file.reason||"";this.$confirm("上传失败原因：".concat(t),"再次尝试上传 ".concat(this.file.name," ？")).then(function(){var t=e.$store.getters.getUploadingDataByFile(e.file);t&&e.$store.commit("uploadQueuePush",t)}).catch(function(){})}},loadThumbnail:function(){var e=this;if(this.image=null,this.file.state===m.Normal&&this.file.type===p.Image&&this.file.thumbnail){var t=new Image;t.src=this.file.thumbnail,t.addEventListener("load",function(){e.image=e.file.thumbnail})}}},watch:{file:function(){this.loadThumbnail()}},mounted:function(){this.loadThumbnail()}},ce=le,ue=(n("9af9"),Object(U["a"])(ce,ee,te,!1,null,"02f52c82",null)),de=ue.exports,fe=Object.freeze({FileUploaded:Symbol("uploaded"),FileDeleted:Symbol("deleted")}),he=function(){function e(t,n,i){Object(d["a"])(this,e),this.id=Date.now().toString(32),this.user=t,this.file=n,this.z=i,this.events={}}return Object(f["a"])(e,[{key:"addEventListener",value:function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(this.events[e]){var n=this.events[e].indexOf(t);n>-1&&this.events[e].splice(n,1)}}},{key:"trigger",value:function(e,t){this.events[e]&&this.events[e].forEach(function(e){return e(t)})}},{key:"clearEventListener",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?this.events[e]=[]:this.events={}}}]),e}(),pe=n("431d"),me=n("4230"),ve=n("df7c"),ge={extends:D,name:"window-folder",components:{FileView:de},props:["id","user","file"],data:function(){return{isDragEnter:!1,files:[],nextPage:null}},watch:{file:function(){this.nextPage=null,this.files.length=0,this.load()}},computed:{uploading:function(){return this.$store.getters.getUploading(this.user,this.file.path)},waiting:function(){return this.$store.getters.getUploading(this.user,this.file.path,m.Waiting)},uploadFails:function(){return this.$store.getters.getUploading(this.user,this.file.path,m.UploadFail)},queueConcurrency:{get:function(){return this.$store.getters.getUploadQueueConcurrency},set:function(e){console.log("改变队列数量",e),this.$store.commit("setUploadQueueConcurrency",e)}}},methods:{paste:function(e){console.log("粘贴事件",e);var t=e.clipboardData||e.originalEvent.clipboardData;t.items&&console.log("粘贴板有内容",t.items.length)},dragEnter:function(){this.isDragEnter||(this.isDragEnter=!0)},dragLeave:function(e){e.target===this.$refs.dragLeave&&(this.isDragEnter=!1)},click_upload:function(e){var t=this.$refs.fileInput;"folder"===e?(t.setAttribute("webkitdirectory",""),t.setAttribute("directory","")):(t.removeAttribute("webkitdirectory"),t.removeAttribute("directory")),this.$refs.fileInput.click()},selectUploadFiles:function(e){for(var t=this,n=e.target.files,i=function(e){var i=n[e],r=ve.join(t.file.path,t.file.name,i.webkitRelativePath);console.log("input file",i);var a=new _(i.name,r,i.type);a.file=i;var o=Object(h["findIndex"])(t.files,{path:i.path,name:i.name});o>-1&&t.$confirm("".concat(i.name," 已经存在，是否覆盖？")).then(function(){t.$store.commit("uploadFile",{id:t.id,path:t.file.path,file:a})}).catch(function(){}),t.$store.commit("uploadFile",{id:t.id,path:t.file.path,file:a})},r=0;r<n.length;r++)i(r)},dropFile:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n,i=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.isDragEnter=!1,e.next=3,Object(pe["getFilesFromDataTransferItems"])(t.dataTransfer.items);case 3:n=e.sent,n.forEach(function(e){var t=e.filepath.split("/");t.pop();var n=ve.join.apply(ve,[i.file.path,i.file.name].concat(Object(K["a"])(t))),r=new _(e.name,n,e.type);r.file=e;var a=Object(h["findIndex"])(i.files,{path:r.path,name:r.name});a>-1?i.$confirm("".concat(r.name," 已经存在，是否覆盖？")).then(function(){i.$store.commit("uploadFile",{id:i.id,path:i.file.path,file:r})}).catch(function(){}):i.$store.commit("uploadFile",{id:i.id,path:i.file.path,file:r})});case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),open:function(e){console.log("window-folder open",e),this.$emit("open",e)},loadContent:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n,i,r,a=this,o=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]&&o[0],n=ve.join(this.file.path,this.file.name),n="/"===n?"":":".concat(n,":"),n+="/children?expand=thumbnails",t&&(this.nextPage=null),e.prev=5,e.next=8,this.$store.dispatch("load",{user:this.user,path:n,force:t});case 8:i=e.sent,r=i.data,this.files=r.value.map(function(e){var t=ve.join(a.file.path,a.file.name),n=new _(e.name,t).setFromData(e);return n.setFromData(e).setType().setState(m.Normal)}),r["@odata.nextLink"]?this.nextPage=r["@odata.nextLink"].split("/root")[1]:this.nextPage=null,e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](5),this.$emit("loadError",e.t0.response.data);case 17:case"end":return e.stop()}},e,this,[[5,14]])}));function t(){return e.apply(this,arguments)}return t}(),loadNextPage:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n,i,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.$store.dispatch("load",{user:this.user,path:this.nextPage,force:!0});case 3:n=e.sent,i=n.data,(t=this.files).push.apply(t,Object(K["a"])(i.value.map(function(e){var t=ve.join(r.file.path,r.file.name),n=new _(e.name,t);return n.setFromData(e).setType().setState(m.Normal)}))),i["@odata.nextLink"]?this.nextPage=i["@odata.nextLink"].split("/root")[1]:this.nextPage=null,this.loading=!1;case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),removeFile:function(e){var t=this.files.indexOf(e);t>-1&&this.files.splice(t,1)},fileUploaded:function(e){if(e.path===ve.join(this.file.path,this.file.name)){var t=Object(h["findIndex"])(this.files,{name:e.name});t>-1&&this.files.splice(t,1),this.files.push(e)}},clearWaiting:function(){var e=this;this.$confirm("确认清空等待上传的任务？").then(function(){e.$store.commit("clearUploadingFile",m.Waiting)}).catch(function(){})},clearUploadFail:function(){var e=this;this.$confirm("确认清空上传失败的任务？").then(function(){e.$store.commit("clearUploadingFile",m.UploadFail)}).catch(function(){})},create:function(e,t){var n=this;if(console.log("创建",e,t),e===p.Folder){var i="/"===ve.join(this.file.path,this.file.name)?"/root":"/items/"+this.file.id;this.$http.get(me["a"].createFolder+"/"+this.user.id+"?path="+i+"&name="+t).then(function(e){var i=e.data;n.files.push(new _(t,ve.join(n.file.path,t)).setFromData(i).setType(p.Folder).setState(m.Normal))}).catch(function(){})}else this.$alert("尚未实现")}},mounted:function(){this.$store.state.windows[this.id].addEventListener(fe.FileUploaded,this.fileUploaded),this.$store.state.windows[this.id].addEventListener(fe.FileDeleted,this.removeFile)},beforeDestroy:function(){this.$store.state.windows[this.id]&&(this.$store.state.windows[this.id].removeEventListener(fe.FileUploaded,this.fileUploaded),this.$store.state.windows[this.id].removeEventListener(fe.FileDeleted,this.removeFile))}},we=ge,ye=(n("27f5"),Object(U["a"])(we,G,H,!1,null,"d76bfb20",null)),be=ye.exports,xe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"loading"},[e._v("\n    读取中\n")])},_e=[],$e={name:"window-loading"},Ce=$e,ke=(n("01bd"),Object(U["a"])(Ce,xe,_e,!1,null,"09339c0c",null)),Fe=ke.exports,je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._v("错误："+e._s(e.error))])},Oe=[],Ee={name:"window-error",props:["error"]},Ie=Ee,Ue=Object(U["a"])(Ie,je,Oe,!1,null,"b8e6a73c",null),Te=Ue.exports,De=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"file-container"},[n("file-icon",{attrs:{file:e.file}}),n("el-form",{attrs:{"label-width":"80px"}},[n("el-form-item",{attrs:{label:"文件名"}},[e._v(e._s(e.file.name))]),n("el-form-item",{attrs:{label:"大小"}},[e._v(e._s(e.info.size))]),n("el-form-item",{attrs:{label:"创建时间"}},[e._v(e._s(e.info.createdTime))]),n("el-form-item",{attrs:{label:"修改时间"}},[e._v(e._s(e.info.modifiedTime))]),n("el-form-item",[n("a",{attrs:{href:e.info.url,target:"_blank"}},[n("el-button",{attrs:{type:"text"}},[e._v("下载")])],1)])],1)],1)},Se=[],Pe={name:"window-binary-file",components:{FileIcon:se},extends:D,props:["id","user","file"],data:function(){return{info:{size:0,createdTime:"",modifiedTime:"",url:""}}},methods:{loadContent:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n,i,r,a=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]&&a[0],n=":"+Object(S["join"])(this.file.path,this.file.name),e.next=4,this.$store.dispatch("load",{user:this.user,path:n,force:t});case 4:i=e.sent,r=i.data,console.log("文件",r),this.$emit("loadFinish"),this.info.size=r.size,this.info.url=r["@microsoft.graph.downloadUrl"],this.info.createdTime=moment(new Date(r["createdDateTime"])).format("llll"),this.info.modifiedTime=moment(new Date(r["lastModifiedDateTime"])).format("llll");case 12:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},We=Pe,ze=(n("9af5"),Object(U["a"])(We,De,Se,!1,null,"0d639a04",null)),Re=ze.exports,Le={components:{WindowBinaryFile:Re,WindowError:Te,WindowLoading:Fe,WindowFolder:be,WindowPlayer:J,WindowViewer:Q,WindowEditor:R},props:{id:String,user:C,file:_,z:Number},data:function(){return{loading:!0,dragging:!1,zIndex:0,active:!0,history:[],historyIndex:0,error:null}},methods:{upload:function(e){!1===this.loading&&this.$refs["content"].click_upload&&this.$refs["content"].click_upload(e)},close:function(){this.$store.commit("closeWindow",this.id)},focus:function(){this.$store.state.activeID!==this.id&&this.$store.commit("windowSetTop",this.id)},blur:function(){},loadFinish:function(){this.loading=!1},loadError:function(e){this.error=e,this.loading=!1},load:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n=this,i=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=i.length>0&&void 0!==i[0]&&i[0],this.loading=!0,this.error=null,this.$nextTick(function(){n.$refs["content"].load(t)});case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),open:function(e){console.log("window.vue open",this.loading,e),this.loading||(this.history.splice(this.historyIndex+1),this.append(e),this.historyIndex++,this.load())},go:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;if(!this.loading){var t=this.historyIndex+e;t>=0&&t<this.history.length&&(this.historyIndex+=e)}},append:function(e){this.history.push(e)},create:function(e){var t=this;"folder"===e?this.$prompt("输入文件夹名称","创建文件夹").then(function(e){var n=e.value;t.$refs["content"].create(p.Folder,n)}).catch(function(){}):"text"===e&&this.$prompt("输入文本文件名称","创建文本文件").then(function(e){var n=e.value;t.$refs["content"].create(p.Text,n)}).catch(function(){})}},computed:{current:function(){return this.history[this.historyIndex]},showFolder:function(){return this.current.type===p.Folder},showPlayer:function(){return-1!==[p.Video,p.Audio].indexOf(this.current.type)},showEditor:function(){return-1!==[p.Code,p.Text].indexOf(this.current.type)},showViewer:function(){return-1!==[p.Image].indexOf(this.current.type)},path:function(){var e=this;return this.history.slice(0,this.historyIndex+1).map(function(t,n){return 0===n?e.user.name:t.name})}},beforeMount:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.append(this.file),e.next=3,this.load();case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),watch:{},mounted:function(){var e=this,t=$(this.$el),n=t.find(".window--head");t.mousedown(function(){e.focus()}).draggable({handle:n,cancel:".controller",start:function(){e.focus(),e.dragging=!0},stop:function(){e.dragging=!1}}).resizable({minHeight:150,minWidth:200,start:function(){e.dragging=!0},stop:function(){e.dragging=!1}})}},Ne=Le,Me=(n("486c"),Object(U["a"])(Ne,c,u,!1,null,"2a987ee4",null)),Ae=Me.exports,Ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user",on:{dblclick:e.open}},[n("div",{staticClass:"user-icon"},[n("svg",{staticClass:"icon main-icon",attrs:{"aria-hidden":"true"}},[n("use",{attrs:{"xlink:href":"#"+e.icon}})]),e.user.lock?n("svg",{staticClass:"icon lock-icon",attrs:{"aria-hidden":"true"}},[n("use",{attrs:{"xlink:href":"#py_lock"}})]):e._e()]),n("div",{staticClass:"user-name"},[e._v(e._s(e.user.name))])])},Qe=[],qe={props:{user:C},data:function(){return{icon:Icons["user"]}},methods:{open:function(){this.$store.commit("createWindow",{user:this.user,file:new _("/","/").setType(),active:!0})}}},Be=qe,Xe=(n("4235"),Object(U["a"])(Be,Ve,Qe,!1,null,"b1b9c9a0",null)),Ye=Xe.exports,Ze=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.value?n("div",{staticClass:"contextmenu full",style:{"z-index":e.$store.state.z},on:{click:e.hide,contextmenu:function(t){return t.preventDefault(),e.hide(t)}}},[n("div",{staticClass:"contextmenu-list",style:{left:e.offsetX,top:e.offsetY}},e._l(e.list,function(t,i){return n("div",{key:i,on:{click:t.click}},[e._v(e._s(t.name))])}),0)]):e._e()},Je=[],Ge={name:"contextmenu",props:["value","x","y","id","file"],data:function(){return{list:[]}},methods:{hide:function(){this.$emit("input",!1),this.$store.state.menuExtraItems.length=0}},computed:{offsetX:function(){return this.x+2+"px"},offsetY:function(){return this.y+2+"px"}},watch:{file:function(){var e,t=this,n=this.$store.state.windows[this.id],i=n.user;this.list.length=0,this.file.state===m.Normal&&([p.Folder,p.Text,p.Code,p.Image,p.Video,p.Audio].indexOf(this.file.type)>-1&&this.list.push({name:"新窗口打开",click:function(){t.$store.commit("createWindowFromMenu",{file:t.file})}}),this.file.type!==p.Folder&&this.list.push({name:"下载文件",click:function(){window.open("/download/".concat(i.id,"?path=:").concat(Object(S["join"])(t.file.path,t.file.name)))}}),this.list.push({name:"删除文件",click:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t.$confirm("确认删除文件 ".concat(t.file.name," ?")).then(function(){t.$http({method:"delete",url:"/admin/api/".concat(i.id,"?path=").concat(Object(S["join"])(t.file.path,t.file.name))}).then(function(){t.$notify.success("成功删除 ".concat(t.file.name)),n.trigger(fe.FileDeleted,t.file)}).catch(function(e){t.$notify.error("".concat(t.file.name," 删除失败：").concat(e.response.data))})}).catch(function(){});case 1:case"end":return e.stop()}},e)}));function r(){return e.apply(this,arguments)}return r}()})),(e=this.list).push.apply(e,Object(K["a"])(this.$store.state.menuExtraItems))}}},He=Ge,Ke=(n("500d"),Object(U["a"])(He,Ze,Je,!1,null,"7f9a61f3",null)),et=Ke.exports,tt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"settings-container",class:{show:e.show},on:{click:function(t){return t.target!==t.currentTarget?null:e.save(t)}}},[e.show?e._e():n("a",{staticClass:"settings-icon",attrs:{title:"打开设置界面"},on:{click:function(t){e.show=!e.show}}},[n("i",{staticClass:"el-icon-s-tools"})]),e.show?n("el-card",[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e._v("全局设置")]),n("el-form",[n("el-form-item",{attrs:{label:"同时上传文件的数量"}},[n("el-input-number",{model:{value:e.concurrency,callback:function(t){e.concurrency=t},expression:"concurrency"}})],1)],1)],1):e._e()],1)},nt=[],it={name:"settings",data:function(){return{queueConcurrency:5}},computed:{show:{set:function(e){this.$store.state.settings=e},get:function(){return this.$store.state.settings}},concurrency:{set:function(e){e<1?e=1:e>11&&(e=10),this.queueConcurrency=e},get:function(){return this.queueConcurrency}}},methods:{save:function(){this.$store.commit("setUploadQueueConcurrency",this.queueConcurrency),this.show=!1}}},rt=it,at=(n("b82e"),Object(U["a"])(rt,tt,nt,!1,null,"6d238952",null)),ot=at.exports,st=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"empty-user"},[n("el-card",[n("div",{attrs:{slot:"header"},slot:"header"},[e._v("友情提示")]),e._v("\n        请到"),n("a",{attrs:{href:"/admin"}},[n("el-button",{attrs:{type:"text"}},[e._v("管理后台")])],1),e._v("绑定 OneDrive 账号后再使用\n    ")])],1)},lt=[],ct={name:"empty-user-tips"},ut=ct,dt=(n("bbbe"),Object(U["a"])(ut,st,lt,!1,null,"3c0fec99",null)),ft=dt.exports,ht={components:{EmptyUserTips:ft,Settings:ot,Contextmenu:et,UserIcon:Ye,Window:Ae},data:function(){return{defaultProps:{children:"children",label:"label"},users:[]}},computed:{windows:function(){return this.$store.state.windows},menu:function(){return this.$store.state.menu}},methods:{},beforeMount:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n,i,r,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.$store.commit("setVueInstance",this),e.next=3,this.$store.dispatch("api",{url:l.accounts});case 3:for(i in t=e.sent,n=t.data,this.users.length=0,Object.values(n))r=new C(i.id,i.name),this.users.push(r);window.addEventListener("beforeunload",function(e){if(a.$store.state.uploadingLength>0){var t="\\o/";return(e||window.event).returnValue=t,t}});case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},pt=ht,mt=(n("908b"),Object(U["a"])(pt,r,a,!1,null,"434e30b6",null)),vt=mt.exports,gt=n("2f62"),wt=n("17d4"),yt=n.n(wt),bt=n("bc3a");i["default"].use(gt["a"]);var xt,_t=yt()(function(e,t){var n=e.user,i=e.file;i.state=e.state=m.Uploading;var r=new FormData,a=Object(S["join"])(me["a"].uploadFile,n.id)+"?type=file&path="+Object(S["join"])(i.path,i.name);r.append("file",i.file),bt({method:"post",url:a,data:r,headers:{"Content-Type":"multipart/form-data"}}).then(function(e){var n=e.data;console.log("SUCCESS!!"),i.setFromData(n),i.setType(),xt.$notify.success({title:"上传成功",message:i.name}),t&&t(!0)}).catch(function(e){var n=e.response;console.log("FAILURE!!",n),i.reason=n.data,xt.$notify.error({title:"上传失败："+i.name,message:i.reason}),t&&t(!1)})},5),$t=new gt["a"].Store({state:{z:1,windows:{},menu:{show:!1,x:0,y:0,id:null,file:null},menuExtraItems:[],activeID:null,error:null,cache:{},uploading:[],uploadingLength:0,uploadQueueConcurrency:_t.concurrency,settings:!1},getters:{getUploading:function(e){return function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m.Uploading;return e.uploading.filter(function(e){return e.user===t&&e.path===n&&e.state===i})}},getUploadingDataByFile:function(e){return function(t){var n=Object(h["findIndex"])(e.uploading,["file",t]);return n>-1?e.uploading[n]:null}},getUploadQueueConcurrency:function(e){return e.uploadQueueConcurrency}},mutations:{setVueInstance:function(e,t){xt=t},setUploadQueueConcurrency:function(e,t){e.uploadQueueConcurrency=t,_t.concurrency=t,console.log("改变后",_t.concurrency)},setError:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"错误";e.error={title:n,content:t.data}},setCache:function(e,t){var n=t.url,i=t.res;e.cache[n]=i},createWindow:function(e,t){var n=t.user,r=t.file,a=t.active,o=void 0!==a&&a;console.log("createWindow");var s=new he(n,r,e.z);i["default"].set(e.windows,s.id,s),e.z++,o&&(e.activeID=s.id)},createWindowFromMenu:function(e,t){var n=t.file;this.commit("createWindow",{user:e.windows[e.menu.id].user,file:n,active:!0})},contextmenu:function(e,t){var n=t.e,i=t.id,r=t.file;console.log("右键",n,i,r),e.menu.show=!0,e.menu.x=n.clientX,e.menu.y=n.clientY,e.menu.file=r,e.menu.id=i},appendMenuItem:function(e,t){var n=t.name,i=t.click;e.menuExtraItems.push({name:n,click:i})},clearWindow:function(e){e.windows={}},closeWindow:function(e,t){e.windows[t].clearEventListener(),i["default"].delete(e.windows,t)},windowSetTop:function(e,t){e.activeID=t,e.windows[t].z=e.z;var n=Object(h["sortBy"])(e.windows,"z");n.forEach(function(e){var t=n.indexOf(e);e.z=t+1}),e.z=n.length+1},uploadFile:function(e,t){var n=t.id,i=t.path,r=t.file,a=e.windows[n].user,o={id:n,user:a,path:i,file:r,state:m.Waiting};this.commit("uploadQueuePush",o)},cancelUploadFile:function(e,t){var n=Object(h["findIndex"])(e.uploading,["file",t]);n>-1&&(e.uploading.splice(n,1),_t.remove(function(e){var n=e.data;return n.file===t}))},uploadQueuePush:function(e,t){var n=t.id,i=t.file,r=e.uploading.indexOf(t);r>-1&&e.uploading.splice(r,1),e.uploading.push(t),i.state=t.state=m.Waiting,_t.push(t,function(r){console.log("上传结果",i.path,r);var a=e.uploading.indexOf(t);a>-1&&e.uploading.splice(a,1),r?(i.state=m.Normal,e.windows[n].trigger(fe.FileUploaded,i)):(i.state=t.state=m.UploadFail,e.uploading.push(t))})},clearUploadingFile:function(e,t){e.uploading=e.uploading.filter(function(e){var n=e.file;return n.state!==t}),_t.kill()},deleteCache:function(e,t){var n=t.user,i=t.path,r=l.loadFile+"/"+n.id+"?path="+i;delete e.cache[r]}},actions:{api:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,bt(n);case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e["catch"](0),t.commit("setError",e.t0.response),e.abrupt("return",null);case 10:case"end":return e.stop()}},e,null,[[0,6]])}));function t(t,n){return e.apply(this,arguments)}return t}(),load:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t,n){var i,r,a,o,s,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(i=n.user,r=n.path,a=n.force,o=void 0!==a&&a,s=l.loadFile+"/"+i.id+"?path="+encodeURIComponent(r),console.log("load",s,o),!t.state.cache[s]||o){e.next=5;break}return e.abrupt("return",t.state.cache[s]);case 5:return e.next=7,bt.get(s);case 7:return c=e.sent,200===c.status&&t.commit("setCache",{url:s,res:c}),e.abrupt("return",c);case 10:case"end":return e.stop()}},e)}));function t(t,n){return e.apply(this,arguments)}return t}()}}),Ct=$t,kt=(n("e008"),n("5c96")),Ft=n.n(kt);n("0fae");i["default"].config.productionTip=!1,i["default"].use(Ft.a),i["default"].prototype.$http=n("bc3a"),new i["default"]({store:Ct,render:function(e){return e(vt)}}).$mount("#app")},e008:function(e,t,n){},e655:function(e,t,n){}});