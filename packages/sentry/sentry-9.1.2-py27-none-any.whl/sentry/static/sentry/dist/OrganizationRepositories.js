(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{1641:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return s}),n.d(t,"d",function(){return l}),n.d(t,"a",function(){return u});var a=n(45),r=n(39),o=n(2);new a.Client;function i(e,t,n){Object(r.addLoadingMessage)();var a=e.requestPromise("/organizations/".concat(t,"/repos/").concat(n,"/"),{method:"DELETE"});return a.then(function(){return Object(r.clearIndicators)()},function(){return Object(r.addErrorMessage)(Object(o.t)("Unable to delete repository."))}),a}function s(e,t,n){Object(r.addLoadingMessage)();var a=e.requestPromise("/organizations/".concat(t,"/repos/").concat(n,"/"),{method:"PUT",data:{status:"visible"}});return a.then(function(){return Object(r.clearIndicators)()},function(){return Object(r.addErrorMessage)(Object(o.t)("Unable to cancel deletion."))}),a}function c(e){return e.then(function(e){var t=Object(o.tct)("[repo] has been successfully added.",{repo:e.name});Object(r.addSuccessMessage)(t)},function(e){var t=e.responseJSON.errors?e.responseJSON.errors.__all__:Object(o.t)("Unable to add repository.");Object(r.addErrorMessage)(t)}),e}function l(e,t,n,a){var o={integrationId:a.id};return Object(r.addLoadingMessage)(),c(e.requestPromise("/organizations/".concat(t,"/repos/").concat(n,"/"),{data:o,method:"PUT"}))}function u(e,t,n,a){var o={installation:a.id,identifier:n,provider:"integrations:".concat(a.provider.key)};return Object(r.addLoadingMessage)(),c(e.requestPromise("/organizations/".concat(t,"/repos/"),{method:"POST",data:o}))}},1672:function(e,t,n){"use strict";var a=n(4),r=n.n(a),o=n(6),i=n.n(o),s=n(7),c=n.n(s),l=n(5),u=n.n(l),d=n(8),p=n.n(d),m=n(16),g=n(1),f=n.n(g),h=n(0),b=n.n(h),y=n(3),v=n(9),E=n(1641),O=n(2),j=n(95),w=n(24),L=n(110),k=n(173),R=n(15),x=function(e){function t(){var e,n;r()(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=c()(this,(e=u()(t)).call.apply(e,[this].concat(o)))).cancelDelete=function(){var e=n.props,t=e.api,a=e.orgId,r=e.repository,o=e.onRepositoryChange;Object(E.b)(t,a,r.id).then(function(e){o&&o(e)},function(){})},n.deleteRepo=function(){var e=n.props,t=e.api,a=e.orgId,r=e.repository,o=e.onRepositoryChange;Object(E.c)(t,a,r.id).then(function(e){o&&o(e)},function(){})},n}return p()(t,e),i()(t,[{key:"getStatusLabel",value:function(e){switch(e.status){case"pending_deletion":return"Deletion Queued";case"deletion_in_progress":return"Deletion in Progress";case"disabled":case"hidden":return"Disabled";default:return null}}},{key:"render",value:function(){var e=this,t=this.props,n=t.repository,a=t.showProvider,r=this.isActive;return b.a.createElement(j.a,{access:["org:admin"]},function(t){var o=t.hasAccess;return b.a.createElement(C,{status:n.status},b.a.createElement(m.Flex,{direction:"column"},b.a.createElement(A,null,b.a.createElement("strong",null,n.name),!r&&b.a.createElement("small",null," — ",e.getStatusLabel(n)),"pending_deletion"===n.status&&b.a.createElement(P,{size:"xsmall",onClick:e.cancelDelete,disabled:!o,"data-test-id":"repo-cancel"},Object(O.t)("Cancel"))),b.a.createElement(m.Box,null,a&&b.a.createElement("small",null,n.provider.name),a&&n.url&&b.a.createElement("span",null," — "),n.url&&b.a.createElement("small",null,b.a.createElement("a",{href:n.url},n.url.replace("https://",""))))),b.a.createElement(L.default,{disabled:!o||!r&&"disabled"!==n.status,onConfirm:e.deleteRepo,message:Object(O.t)("Are you sure you want to remove this repository? All associated commit data will be removed in addition to the repository.")},b.a.createElement(w.default,{size:"xsmall",icon:"icon-trash",disabled:!o})))})}},{key:"isActive",get:function(){return"active"===this.props.repository.status}}]),t}(b.a.Component);x.propTypes={repository:v.Repository,api:f.a.object.isRequired,orgId:f.a.string.isRequired,showProvider:f.a.bool,onRepositoryChange:f.a.func},x.defaultProps={showProvider:!1};var C=Object(y.default)(k.a,{target:"el4xg0t0"})("border-bottom:1px solid ",function(e){return e.theme.borderLight},";/* shorter top padding because of title lineheight */\n  padding:",Object(R.default)(1)," ",Object(R.default)(2)," ",Object(R.default)(2),";flex:1;align-items:space-between;",function(e){return"disabled"===e.status&&"\n    filter: grayscale(1);\n    opacity: 0.4;\n  "},";&:last-child{border-bottom:none;}"),P=Object(y.default)(w.default,{target:"el4xg0t1"})("margin-left:",Object(R.default)(1),";"),A=Object(y.default)(m.Box,{target:"el4xg0t2"})("margin-bottom:",Object(R.default)(1),";/* accomodate cancel button height */\n  line-height:26px;");t.a=x},2378:function(e,t,n){"use strict";n.r(t);var a=n(11),r=n.n(a),o=n(4),i=n.n(o),s=n(6),c=n.n(s),l=n(7),u=n.n(l),d=n(5),p=n.n(d),m=n(8),g=n.n(m),f=n(0),h=n.n(f),b=n(14),y=n(153),v=n(107),E=n(16),O=n(1),j=n.n(O),w=n(2),L=n(592),k=n(24),R=n(488),x=n(1672),C=n(25),P=n(99),A=n(113),I=function(e){function t(){return i()(this,t),u()(this,p()(t).apply(this,arguments))}return g()(t,e),c()(t,[{key:"render",value:function(){var e=this.props,t=e.params,n=e.itemList,a=e.api,r=e.onRepositoryChange,o=t.orgId,i=n&&n.length>0;return h.a.createElement("div",null,h.a.createElement(P.default,{title:Object(w.t)("Repositories")}),h.a.createElement(L.a,{to:"/settings/".concat(o,"/integrations/")},Object(w.t)("Want to add a repository to start tracking commits? Install or configure your version control integration here.")),!i&&h.a.createElement("div",{className:"m-b-2"},h.a.createElement(A.default,null,Object(w.t)("Connecting a repository allows Sentry to capture commit data via webhooks. This enables features like suggested assignees and resolving issues via commit message. Once you've connected a repository, you can associate commits with releases via the API.")," ",Object(w.tct)("See our [link:documentation] for more details.",{link:h.a.createElement("a",{href:"https://docs.sentry.io/learn/releases/"})}))),i?h.a.createElement(C.a,null,h.a.createElement(C.e,{disablePadding:!0},h.a.createElement(E.Flex,null,h.a.createElement(E.Box,{px:2},Object(w.t)("Added Repositories")))),h.a.createElement(C.c,null,h.a.createElement(E.Box,null,n.map(function(e){return h.a.createElement(x.a,{key:e.id,repository:e,api:a,showProvider:!0,orgId:o,onRepositoryChange:r})})))):h.a.createElement(C.a,{className:"align-center p-x-2 p-y-1"},h.a.createElement(E.Box,{mb:1},h.a.createElement(R.a,{src:"icon-commit"})),h.a.createElement("h3",null,Object(w.t)("Sentry is better with commit data")),h.a.createElement(A.default,null,Object(w.t)("Adding one or more repositories will enable enhanced releases and the ability to resolve Sentry Issues via git message.")),h.a.createElement(E.Box,{mb:1},h.a.createElement(k.default,{href:"https://docs.sentry.io/learn/releases/"},Object(w.t)("Learn more")))))}}]),t}(h.a.Component);I.propTypes={itemList:j.a.array,api:j.a.object,onRepositoryChange:j.a.func},n.d(t,"default",function(){return S});var S=function(e){function t(){var e,n;i()(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=u()(this,(e=p()(t)).call.apply(e,[this].concat(r)))).onRepositoryChange=function(e){var t=n.state.itemList;t.forEach(function(t){t.id===e.id&&(t.status=e.status)}),n.setState({itemList:t})},n.onAddRepo=function(e){var t=n.state.itemList;t.push(e),n.setState({itemList:Object(b.sortArray)(t,function(e){return e.name})})},n}return g()(t,e),c()(t,[{key:"getEndpoints",value:function(){var e=this.props.params.orgId;return[["itemList","/organizations/".concat(e,"/repos/"),{query:{status:""}}],["repoConfig","/organizations/".concat(e,"/config/repos/")]]}},{key:"getTitle",value:function(){return"Repositories"}},{key:"renderBody",value:function(){return h.a.createElement(h.a.Fragment,null,h.a.createElement(I,r()({},this.props,this.state,{api:this.api,onAddRepo:this.onAddRepo,onRepositoryChange:this.onRepositoryChange})),this.state.itemListPageLinks&&h.a.createElement(v.default,r()({pageLinks:this.state.itemListPageLinks},this.props)))}}]),t}(y.default)}}]);
//# sourceMappingURL=OrganizationRepositories.js.map